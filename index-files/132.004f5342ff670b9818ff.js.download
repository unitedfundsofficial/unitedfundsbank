(window.webpackJsonp=window.webpackJsonp||[]).push([[132,"badge-element","get-price-alerts-dispatcher","screener-alerts",216,217,238],{"+SlM":function(t,e,i){"use strict";(function(e,o,s,n){function a(t){this._bridge=t,this._container=t.$body,this._visible=!1,this._notificationCount=0,this._init_history_loaded=!1,this._unreadFlag=!1,this._model=v.makePrivateModel(),this._model.roomAdded().subscribe(this,this._onRoomAdded),this._model.roomChanged().subscribe(this,this._onRoomChanged),this._model.roomDeleted().subscribe(this,this._onRoomDeleted),this._model.roomsChanged().subscribe(this,this._onRoomsChanged),this._model.otherRoomMessagesRead().subscribe(this,this._onRoomMessagesRead),this._model.messageReceivedInOtherRoom().subscribe(this,this._onChatMessage),this._chatMaximized=new e,this.layoutWithSelect()||this._chatMaximized.subscribe(function(t){TVSettings.setValue("privatemessages.chatmaximized",t)}),this._standalone=!!t.standalone||!!(t.options||{}).standalone,this._layoutWithSelect=!!t.layoutWithSelect||!!(t.options||{}).layoutWithSelect,this._chatNotificationControl=new d.ChatNotificationControl(!0),this.layoutWithSelect()?(r.prototype.prepareLayoutWithSelect.call(this,!0,this._$notAuthMessage()),this.roomChange=new o):this.prepareLayout(),0!==this._model.getRooms().length&&this._onRoomsChanged(this._model.getRooms(),[]),this.connect(),this.resize(),t.onMessage&&t.onMessage(this.onBridgeMessage.bind(this)),t.visible.subscribe(function(e){if(this._visible=e,e){this._bridge.postMessage("private_chat_visible"),this.resize();var i=TVSettings.getValue("privatemessages.activechat","");this._visibilityToggled?this._visibilityToggled=!1:i&&this.getRoomById(i)&&this.openChat(i),this._model.getRooms().forEach(function(t){t._notifyFired&&($("#msg-item-"+t.room_id).highlight(1),this.isCurrentRoom(t.room_id)&&$("#msg-item-"+t.room_id+" .counter").text("0").removeClass("active")),t._notifyFired=!1}.bind(this)),t.notify(null,{stopHighlightTab:!0,force:!0}),this.updateNotifications()}else this._bridge.postMessage("private_chat_hidden")}.bind(this),{callWithLast:!0}),t.height&&t.height.subscribe(this.onWindowResize.bind(this)),t.width&&t.width.subscribe(this.resizeChat.bind(this)),TradingView.messagesWidget=this,setInterval(this.checkUnreadRooms.bind(this),1e3)}var r,h,d,c,l,u,p,m,g,_,f,v,y,b,w,R,C,S,M,x,T,I,k;i("pfXf"),i("/VKo"),r=i("debi"),h=i("eF4M"),d=i("OqB+"),c=i("mSWa").UsernameHintList,l=i("7KDR").Action,u=i("5VQP").ContextMenuManager,p=i("hp/T"),m=i("PQvG"),g=i("QcGJ").newPrivateChatDialog,_=i("sFgq").SidebarCustomScroll,f=i("bR4N").bindPopupMenu,v=i("Wz41"),y=i("brCa").showNoticeDialog,b=i("oNDq").createConfirmDialog,w=i("tvXG").createPromptDialog,R=i("hWl2"),C=i("VPmY"),S=i("qjxE"),M=i("vBL9"),x=i("FBuY").TVXWindowEvents,T=i("XhdI").trackChatEvent,I=i("PT1i").linking,i("pay7"),k=1e3,a.prototype._emitXWindowOnNewMessagesRead=function(t){this._xWindowNewMessagesReadBuffer?this._xWindowNewMessagesReadBuffer.push(t):(this._xWindowNewMessagesReadBuffer=[t],setTimeout(function(){
var t=this._xWindowNewMessagesReadBuffer.join(":");x.emit("messages.newmessagesread",t),delete this._xWindowNewMessagesReadBuffer}.bind(this),500))},a.prototype.onBridgeMessage=function(t,e){"private_message_read"===t&&this._emitXWindowOnNewMessagesRead(e.id)},a.prototype.updateNotifications=function(){var t=this._$data.find(".counter.active").length;0===t&&(this._notificationCount=0),this._bridge.notify(1,{notificationValue:t,clear:!t,force:!0,highlightTab:!1})},a.prototype.checkUnreadRooms=function(){this._$data.find(".counter.active").length?this._unreadFlag||(this._unreadFlag=!0,R.setTabIcon(R.TAB_ICON_URLS.UNREAD_MESSAGES)):this._unreadFlag&&(this._unreadFlag=!1,R.setTabIcon(R.TAB_ICON_URLS.DEFAULT))},a.prototype.prepareLayout=function(){var t=this;this._$widget=$('<div class="tv-messages">').appendTo(this._container),this._$addChatButton=$('<a class="button apply-common-tooltip" title="'+$.t("Select user to start new chat with")+'" data-role="button" data-name="new-chat">').append($(i("oHcy")).attr({width:17,height:17})).click(function(t){runOrSignIn(g,{source:"Private message dialog",verifiedPhoneRequired:!0})}).appendTo(this._bridge.$headerspace),this._searchFilter=new d.ChatRoomListSearchFilter(this,!0),this._searchFilter.appendButton(this._bridge.$headerspace),this._searchFilter.appendInput(this._$widget),this._$dataWrap=$('<div class="msg-data-wrap">').appendTo(this._$widget),this._$dataWrap.on("contextmenu",function(t){t.target.classList.contains("msg-data-wrap")&&t.preventDefault()}),this._$data=$('<div class="msg-data">').appendTo(this._$dataWrap),this._$data.on("click",".msg-item",function(e){t._searchFilter&&t._searchFilter.isOpen()&&t._searchFilter.setNewRoom($("#msg-item-"+$(this).data("room"))),t.openChat($(this).data("room")),e.preventDefault()}).on("contextmenu",".msg-item",function(e){e.preventDefault(),t.showRoomContextMenu(e,$(this).data("room"))}),this._searchFilter.setRoomList(this._$data),this._searchFilter.setOpenCallback(function(){t._model.loadMoreRooms(k)}),is_authenticated||this._$notAuthMessage().appendTo(this._$data),this._scroll=new _(this._$dataWrap,this._$data),this._scroll.scrolltoend.subscribe(this,function(){this._model.loadMoreRooms()})},a.prototype._onRoomAdded=function(t){if(!(t.user_id in this._model.ignoredUsers())){this.addRoom(t,!0);var e=t.room_id;this._roomToBeOpenedWhenAdded&&this._roomToBeOpenedWhenAdded===e&&(this._roomToBeOpenedWhenAdded=null,this._scroll.animateTo($("#msg-item-"+e).position().top),this.openChat(e)),this.isStandalone()&&this._bridge.notify(null,{roomsCount:this._model.getRooms().length})}},a.prototype._onRoomChanged=function(t){t.user_id in this._model.ignoredUsers()||this.setRoomTitleById(t.room_id,this.roomTitle(t))},a.prototype._onRoomDeleted=function(t){$("#msg-item-"+t.room_id).remove()},a.prototype._onRoomsChanged=function(t,e){var i,o,s;window.is_authenticated?(this._$data.empty(),t.length?(this.isStandalone()&&this._bridge.notify(null,{roomsCount:t.length}),i=0===e.length&&0!==t.length,o=0,t.forEach(function(t){o+=this.addRoom(t,!1,i)
},this),o?(s=this.layoutWithSelect()&&this._bridge.activeRoom?this._bridge.activeRoom:TVSettings.getValue("privatemessages.activechat",""),i&&this._visible&&s&&this.getRoomById(s)&&this.openChat(s),i||!s||this.getRoomById(s)||this.closeChat()):this.appendPlaceholder("hidden")):this.isStandalone()?this._bridge.notify(null,{roomsCount:0}):this.appendPlaceholder("empty")):this.isStandalone()&&this._bridge.notify(null,{roomsCount:0})},a.prototype._onChatMessage=function(t,e,i){var o,s,n,a,r,h,d=this;t.user_id in this._model.ignoredUsers()||((o=$("#msg-item-"+e)).prependTo(this._$data),!t.type&&this._model.isRoomHidden(e)&&o.hasClass("js-hidden")&&this._showRoom(e,o),(s=o.find(".desc")).find(".last-message").text(t.username+": "+M.removeBBCodes(t.text)),(n=s.find("time")).length?S.jQueryCompatibleDestroy(n):(n=$("<time>")).insertAfter(o.find(".js-last-message")),S.jQueryCompatibleAgoDateFormatter(n,new Date(t.time)),a=t.user_id!==window.user.id,r=this._model.getRoomById(e),(h=new C).ready.then(function(){var s,n,c,l,u,g,_=h.data.notification_popup;!a||d.isCurrentRoom(e)&&d._visible||(!a||i||t.type||d.isStandalone()||d.layoutWithSelect()||!_||!document.hidden||(r.members_info.length>2?(n=d.roomTitle(r),s=t.username+": "+M.removeBBCodes(t.text)):(n=t.username,s=M.removeBBCodes(t.text)),m.show(n,s,t.user_pic)),c=d._$data.find('a[data-room="'+e+'"] .counter'),l=parseInt(c.text(),10),c.addClass("active").text(l+1),d._notificationCount++,o.highlight(1),d.updateNotifications(),u=TVSettings.getJSON("privatemessages.sound",null),g=t.text&&M.removeBBCodes(t.text).indexOf("@"+window.user.username)>-1,a&&!i&&(!u||u.onMessage||g&&u.onMessageForUser)&&p.play("chat/popup")),r._notifyFired||d._visible||(d.updateNotifications(),r._notifyFired=!0)}))},a.prototype.connect=function(){this._onXWindowChatOpen=this.onXWindowChatOpen.bind(this),this._onXWindowChatStatus=this.onXWindowChatStatus.bind(this),this._onXWindowChatVisibility=this.onXWindowChatVisibility.bind(this),this._onXWindowNewMessagesRead=this.onXWindowNewMessagesRead.bind(this),x.on("messages.newmessagesread",this._onXWindowNewMessagesRead),this.isStandalone()||(x.on("messages.openchat",this._onXWindowChatOpen),x.on("messages.chatstatus",this._onXWindowChatStatus),x.on("messages.chatvisibility",this._onXWindowChatVisibility))},a.prototype.onXWindowNewMessagesRead=function(t){this._bridge.postMessage("private_chat_msgs_read",{idString:t})},a.prototype.onXWindowChatOpen=function(t){var e,i,o;this._model.getRooms().length&&(e=t.indexOf(":"),i=t.indexOf("@"),o=t.substr(e+1,i-e-1),this.openChat(o,!0))},a.prototype.onXWindowChatStatus=function(t){if(this._model.getRooms().length){var e=t.split(":")[1];$("#msg-item-"+e+" .counter").text("0").removeClass("active"),this.updateNotifications()}},a.prototype.onXWindowChatVisibility=function(t){var e,i;this._model.getRooms().length&&(e=t.split(":")[0],i=t.split(":")[1],this.getRoomById(e)&&"hide"===i&&this._hideRoom(e,!0))},a.prototype.destroy=function(){this._chatWidget&&(this._chatWidget.destroy(),this._chatWidget=null),
this._model.roomAdded().unsubscribe(this,this._onRoomAdded),this._model.roomChanged().unsubscribe(this,this._onRoomChanged),this._model.roomDeleted().unsubscribe(this,this._onRoomDeleted),this._model.roomsChanged().unsubscribe(this,this._onRoomsChanged),this._model.otherRoomMessagesRead().unsubscribe(this,this._onRoomMessagesRead),this._model.messageReceivedInOtherRoom().unsubscribe(this,this._onChatMessage),this._model.destroy(),this._model=null,x.off("messages.openchat",this._onXWindowChatOpen),x.off("messages.chatstatus",this._onXWindowChatStatus),x.off("messages.chatvisibility",this._onXWindowChatVisibility),x.off("messages.newmessagesread",this._onXWindowNewMessagesRead)},a.prototype.removePlaceholder=function(t){t&&t.find(".js-placeholder-message").remove(),this.isStandalone()?(this._bridge.$header.show(),this._bridge.$body.find(".js-placeholder-message").remove()):this._$data.find(".js-placeholder-message").remove()},a.prototype.appendPlaceholder=function(t,e){var i,o;e?o=e:this.isStandalone()?(this._bridge.$header.hide(),o=this._bridge.$body):o=this._$data,"empty"===t?i=$.t("You have no private messages yet"):"hidden"===t&&(o.is(".chat-body")&&$(document.body).addClass("no-chats"),i=$.t("You have no new messages!")),o.append('<div class="msg-empty tv-widget-empty-message js-placeholder-message">'+i+"</div>")},a.prototype.getRoomById=function(t){return this._model.getRoomById(t)},a.prototype.roomTitle=function(t,e){var i,o,s,n;return t?t.title?e?"<strong>"+t.title+"</strong>":t.title:(i=[],o=4,t.members_info.forEach(function(t){t.username!==window.user.username&&i.push(t.username)}),n=i.slice(0,o),e&&(n=n.map(function(t){return"<strong>"+t+"</strong>"})),s=n.join(", "),i.length>o&&(s+=", +"+(i.length-o)),s):""},a.prototype.getRoomTitleById=function(t,e){return this.roomTitle(this.getRoomById(t),e)},a.prototype.setRoomTitleById=function(t,e){e=TradingView.clean(e),this._bridge.setTitle(e),$("#msg-item-"+t+" .title").text(e)},a.prototype.addRoom=function(t,e,i){var o,n,a,r,h,d,c,l,u,p=this._model.isRoomHidden(t.room_id);for(p&&t.new_msgs&&(this._model.removeHiddenRoom(t.room_id),p=!1),o='<a href="#" data-room="{{roomId}}"{{#isHidden}} data-hidden-conversation="true"{{/isHidden}} id="msg-item-{{roomId}}" class="msg-item{{#isHidden}} js-hidden{{/isHidden}}"><div class="title">{{title}}</div><div class="desc"><span class="last-message js-last-message">{{lastMessage}}</span></div><div class="counter">0</div></a>',n=t.last_message?M.removeBBCodes(TradingView.clean(t.last_message)):"",a={roomId:t.room_id,isHidden:p,title:TradingView.clean(this.roomTitle(t)),lastMessage:n},r=$(s.render(o,a)),n.length&&((h=$("<time>")).insertAfter(r.find(".js-last-message")),S.jQueryCompatibleAgoDateFormatter(h,new Date(1e3*t.updated||Date.now()))),this.isCurrentRoom(t.room_id)&&r.addClass("active"),d=$('<div class="userpics"></div>').prependTo(r),c=0,u=0;u<t.members_info.length;u++)(l=t.members_info[u]).username!==window.user.username&&c<4&&(c++,
$('<i class="userpic userpic-'+c+(l.online?" online":"")+'"><img src="'+l.user_pic+'"/></i>').appendTo(d));return d.addClass("layout-"+c),e?r.prependTo(this._$data).highlight(1):r.appendTo(this._$data),t.new_msgs&&!this.isCurrentRoom(t.room_id)&&(r.find(".counter").addClass("active").text(t.new_msgs),this._notificationCount+=t.new_msgs,i&&(t._notifyFired=!0),this.updateNotifications()),this._$data.find(".js-placeholder-message").remove(),p?0:1},a.prototype._onRoomMessagesRead=function(t){this.markChatAsRead(t.room_id),this.updateNotifications()},a.prototype.markChatAsRead=function(t){var e=$("#msg-item-"+t+" .counter"),i=parseInt(e.text(),10);return e.text("0").removeClass("active"),i&&(this._notificationCount=Math.max(0,this._notificationCount-i)),i},a.prototype.openChat=function(t,e){this._$data.find("a").removeClass("active"),$("#msg-item-"+t).addClass("active"),this.markChatAsRead(t),(this._visible||e)&&this.updateNotifications(),this.isCurrentRoom(t)||(this.layoutWithSelect()||this.flipWidgets(),this.isStandalone()&&x.emit("messages.chatstatus",+new Date+":"+t),this._bridge.setTitle(this.getRoomTitleById(t)),this.layoutWithSelect()&&this._$select&&this._$select.html(this.getRoomTitleById(t,!0)),this.removePlaceholder(this._$chat),this.closeChat(),this._createChatWidget(t,e),this._chatWidget.resize(),this.resize(),this.isStandalone()||TVSettings.setValue("privatemessages.activechat",t),this.layoutWithSelect()||this.toggleMaximize(TVSettings.getBool("privatemessages.chatmaximized")),this.layoutWithSelect()&&this.roomChange.fire(t))},a.prototype.membersFilter=function(t){return t.username!==window.user.username},a.prototype._membersCount=function(t){var e=this._model.getRoomById(t);return e?e.members_info.length>2?e.members_info.filter(this.membersFilter).length:"":0},a.prototype._createChatWidget=function(t,e){var i,o,s=this.layoutWithSelect()&&this._bridge.$body?this._bridge.$body:this._$chat;this._$chatWidgetContainer=$('<div class="msg-window" id="msg-window-'+t+'" data-room="'+t+'"></div>').appendTo(s),this._$chatBody=$('<div class="msg-window-body chat-page"></div>').appendTo(this._$chatWidgetContainer),this.layoutWithSelect()&&this._$chatBody.css("height","100%"),this._createUsernameHint(t),this.symbolLinking=I.symbol.spawn(),this.intervalLinking=I.interval.spawn(),i=this._model.getRoomById(t),(o=$.extend(!0,{},this._bridge.options)).hideMaximize=o.hideMaximize||this.layoutWithSelect(),this._chatBridge={$body:this._$chatBody,_room:t,properties:{value:function(){return{room:t}}},options:o,visible:this._bridge.visible,$headerspace:this._bridge.$headerspace,$header:this._bridge.$header,private_chat:!0,privateMenuItems:function(){return this.getPrivateRoomActions(i)}.bind(this),getChartWidget:this._bridge.getChartWidget,postMessage:this._bridge.postMessage,onMessage:this._bridge.onMessage,chatNotificationControl:this._chatNotificationControl,getChartWidgetCollection:this._bridge.getChartWidgetCollection,addPeople:this.addPeople.bind(this),membersCount:this._membersCount.bind(this,t),
hideDetach:this._standalone||n.enabled("browser_extension"),standalone:this._standalone||this.layoutWithSelect(),toggleMaximize:this.toggleMaximize.bind(this),maximized:this._chatMaximized.readonly(),symbol:this.symbolLinking,interval:this.intervalLinking,isAuthor:i.is_author},this.isStandalone()||e||(this._chatBridge.xWindowDataSync=function(e){x.emit("messages.openchat",+new Date+":"+t+"@"+JSON.stringify(e))}),this._chatWidget=new h(this._chatBridge),Modernizr.mobiletouch||this.layoutWithSelect()||this._$chat.find(".message-input").focus()},a.prototype.toggleMaximize=function(t){if("boolean"!=typeof t)t=!this._chatMaximized.value();else if(t===this._chatMaximized.value())return;this._$chat.toggleClass("msg-chat-maximized",t),this._chatMaximized.setValue(t),this._chatWidget.resize()},a.prototype._isCurrentUserAuthor=function(t){var e=this.getRoomById(t||this._currentRoom()),i=window.is_authenticated&&e&&e.is_author;return i},a.prototype._createUsernameHint=function(t){var e,i=this._isCurrentUserAuthor(t)||window.user.is_moderator||window.user.is_staff;this._$chatMembers=$(s.render('<div class="msg-members">{{#canEditMembers}}<div class="msg-input-wrap js-hidden"><div class="msg-input"><textarea placeholder="{{ placeholderText }}"></textarea></div></div>{{/canEditMembers}}<div class="msg-chat-members{{#canEditMembers}} msg-chat-members--height_decreased{{/canEditMembers}}"></div><div class="msg-username-hint-actions{{^canEditMembers}} msg-username-hint-actions--one-button{{/canEditMembers}}">{{#canEditMembers}}<a class="_tv-button cancel">'+$.t("Cancel")+'</a><a class="_tv-button ok">'+$.t("OK")+'</a>{{/canEditMembers}}{{^canEditMembers}}<a class="_tv-button cancel">'+$.t("Close",{context:"input"})+"</a>{{/canEditMembers}}</div></div>",{canEditMembers:i,placeholderText:$.t("Add people to this chat...")})),this._$chatMembers.appendTo(this._$chatBody),this._$inputWrap=this._$chatMembers.find(".msg-input-wrap"),this._$input=this._$chatMembers.find(".msg-input"),this._$inputText=this._$chatMembers.find("textarea"),this._$chatMembersContent=this._$chatMembers.find(".msg-chat-members"),this._$membersActions=this._$chatMembers.find(".msg-username-hint-actions"),this._$chatHeadingHeaderspace=this._bridge.$headerspace,i&&(this._usernameHintList=new c({$container:this._$chatMembers,simpleMode:!0,fullBorder:!0,$input:this._$inputText,style:{top:35,"z-index":11},onShow:function(t){t.css({"max-height":this._$chatMembers.height()-60,width:this._$chatMembers.width()})}.bind(this),onMouseDownOutside:function(){this._$inputText.val("")}.bind(this),onItemSelected:function(t){this.addNewRecipient(t)}.bind(this)})),i&&(e=this,this._$chatMembersContent.on("click",".remove",function(t){return t.stopPropagation(),t.preventDefault(),e.removeNewRecipient($(this).parent().data("id")),e.syncDeleteButtonVisibility(),!1})),this._$membersActions.on("click",".ok",function(){var t=this._$membersActions.find(".ok");t.hasClass("i-disabled")||(t.addClass("i-disabled"),this.saveRecipients(this.getCurrentRecipients()).then(function(){
t.removeClass("i-disabled")}))}.bind(this)),this._$membersActions.on("click",".cancel",function(){this._$chatHeadingHeaderspace.find("#add-people").removeClass("active"),this._$inputWrap.addClass("js-hidden"),this._$chatMembers.hide()}.bind(this))},a.prototype.addPeople=function(){var t=this._$chatHeadingHeaderspace.find("#add-people");t.hasClass("active")?(t.removeClass("active"),this._$inputWrap.addClass("js-hidden"),this._$chatMembers.hide()):(t.addClass("active"),this._$inputWrap.removeClass("js-hidden"),this._$chatMembers.show(),this._$inputText.val("").focus(),this._showMembersList())},a.prototype._showMembersList=function(){var t=this;this._$chatMembersContent.empty().css("height",""),this._model.updateRoomInfo(this._currentRoom(),function(){var e=this._model.getRoomById(this._currentRoom()),i=e.members_info.sort(function(t,e){return t.online?-1:1}).filter(this.membersFilter),o=i.map(function(t){return{username:t.username,online:t.online,userpic:t.user_pic,id:t.user_id}}),s=t.renderRecipients(o);this._$chatMembersContent.append(s),t.syncDeleteButtonVisibility()}.bind(this))},a.prototype.syncDeleteButtonVisibility=function(){var t=this._$chatMembersContent.find(".recipient").length,e=this._$chatMembersContent.find(".remove");t>1?e.show():e.hide()},a.prototype.addNewRecipient=function(t){var e;this._$inputText.val("").focus(),-1===this.getCurrentRecipients().indexOf(t.id)?(e=$.extend({},t),this.renderRecipients([e]).prependTo(this._$chatMembersContent),this.syncDeleteButtonVisibility()):y({title:$.t("Notice"),content:$.t("{0} is already in this chat.").format(t.username)})},a.prototype.renderRecipients=function(t){var e=this._isCurrentUserAuthor(),i=$(s.render('{{#recipients}}<a href="/u/{{ username }}/" target="_blank" class="recipient{{#online}} online{{/online}}" data-id="{{ id }}"><img src="{{ userpic }}"/><span class="recipient-username">{{ username }}</span>{{#showDeleteButton}}<i class="remove"></i>{{/showDeleteButton}}</a>{{/recipients}}',{recipients:t,showDeleteButton:e||window.user.is_moderator}));return i},a.prototype.removeNewRecipient=function(t){$('.recipient[data-id="'+t+'"]').remove(),this._$inputText.focus()},a.prototype.saveRecipients=function(t){return new Promise(function(e,i){t.length?this._model.updateRoomUsers(this._currentRoom(),t,function(t){if(t.error)return y({title:$.t("Error"),content:t.error}),void e();this._$inputWrap.addClass("js-hidden"),this._$chatHeadingHeaderspace.find("#add-people").removeClass("active"),this._$chatMembers.hide();var i=t.room;if(i.existing)return this.openChat(i.room_id),void e();this.isCurrentRoom(i.room_id)||this.isStandalone()||(this._roomToBeOpenedWhenAdded=i.room_id),e()}.bind(this)):e()}.bind(this))},a.prototype.flipWidgets=function(){var t,e,o,s,n;this._flipped||(t=this._container.height(),e=parseFloat(TVSettings.getValue("privatemessages.paneratio","0.5")),o=Math.round(e*t),this._bridge.visible.value()||this._bridge.visible.subscribe(function(i){t=this._container.height(),o=Math.round(e*t),this._$chat.height(o),this._$widget.height(t-o),this.resize()
}.bind(this),{once:!0}),this._$headerWrap=$('<div class="tv-messages-header">').prependTo(this._$widget),this._$headerWrap.on("contextmenu",function(t){t.preventDefault()}),s=$('<div class="widgetbar-widgetheader"><div class="widgetbar-widgettitle">'+$.t("Recent Chats")+"</div></div>").appendTo(this._$headerWrap),n=$('<div class="widgetbar-headerspace">').append(this._$addChatButton).append(this._searchFilter.getButton()).prependTo(s),this._$settingsButton=$('<a class="button apply-common-tooltip" title="'+$.t("Settings")+'" data-role="button" data-name="settings">').append($(i("RsxI")).attr({width:17,height:17})).appendTo(n),this._$settingsButton.on("click",function(t){this._chatWidget&&this._chatWidget._showSettingsDialog(t,this._model.getRooms())}.bind(this)),f(this._$settingsButton,null,{event:"show-popup",addClass:"ch-popup ch-settings-popup",careBottomBorder:!0,careRightBorder:!0,viewportSpacing:2,reverse:!0}),this._$chat=$('<div class="msg-chat-wrap">').insertBefore(this._$widget),this._$chat.height(o),this._$widget.height(t-o),this._$chat.data("heightRatio",e),this._$resizeHandle=$('<div class="msg-window-handle"></div>').on("mousedown touchstart",this.onWidgetResizeHandleMousedown.bind(this)).appendTo(this._$widget),this._flipped=!0)},a.prototype.onWidgetResizeHandleMousedown=function(t){var e,i,o,s,n,a,r,h,d;t.isDefaultPrevented()||(t.preventDefault(),e=this,i=this._$chat,o=this._$widget,s=t.originalEvent.touches?t.originalEvent.touches[0].clientY:t.pageY,n=i.height(),a=this._container.height(),h=function(t){var h,d;h=(t.originalEvent.touches?t.originalEvent.touches[0].clientY:t.pageY)-s,d=Math.max(0,Math.min(n+h,a-e._$headerWrap.outerHeight())),r!==d&&(r=d,i.data("heightRatio",(d/a).toFixed(2)),i.height(d),o.height(a-d),e.resize())},d=function(t){$(document.documentElement).off("mousemove touchmove",h).off("mouseup touchend",d),r!==n&&TVSettings.setValue("privatemessages.paneratio",i.data("heightRatio"))},$(document.documentElement).on("mousemove touchmove",h).one("mouseup touchend",d))},a.prototype.resize=function(){if(!this.layoutWithSelect()){var t=this._$widget.height();t-=this._searchFilter.getInputHeight(),this._$headerWrap&&(t-=this._$headerWrap.outerHeight()),this._$dataWrap.height(t),this._scroll.resize()}this.resizeChat()},a.prototype.resizeChat=function(){this._chatWidget&&this._chatWidget.resize()},a.prototype.onWindowResize=function(){var t,e;this._chatWidget&&(this.layoutWithSelect()?this._chatWidget.resize():(t=this._$chat.data("heightRatio"),e=this._container.height(),this._$chat.height(e*t),this._$widget.height(e*(1-t)),this.resize()))},a.prototype.closeChat=function(t){this._chatWidget&&(this._chatWidget.destroy(),this._chatWidget=null),this._$chatWidgetContainer&&(this._$chatWidgetContainer.remove(),this._$chatWidgetContainer=null),this._$chatHeadingHeaderspace&&this._$chatHeadingHeaderspace.empty(),t&&(this._bridge.setTitle($.t("Select Conversation...")),this.appendPlaceholder("hidden",this._$chat)),this.isStandalone()||TVSettings.setValue("privatemessages.activechat","")},
a.prototype.sendMessageToUser=function(t,e){var i,o;e!==window.user.id&&(i=this.getFaceToFaceChat(e),o=function(e){this._model.getRoomInfo(e,function(i){T(i,t),this._model.sendMessageToRoom(e,t,{},null,function(t){t.error&&y({title:t.title||$.t("Error"),content:t.error}),this.openChat(e),window.widgetbar&&window.widgetbar.setPage("pm_chats"),this._scroll&&this._scroll.scrollToStart()}.bind(this),function(){y({title:$.t("Error"),content:$.t("Unexpected error")})})}.bind(this))}.bind(this),this._visibilityToggled=!0,i?o(i.room_id):this._model.createRoom("","",[e],function(t){t.error?y({title:t.errorTitle||$.t("Error"),content:t.error}):o(t.room.room_id)}))},a.prototype._currentRoom=function(){return this._chatWidget&&this._chatWidget.currentRoom()||""},a.prototype.isCurrentRoom=function(t){return this._currentRoom()===t},a.prototype.isStandalone=function(){return this._standalone},a.prototype.layoutWithSelect=function(){return this._layoutWithSelect},a.prototype._$notAuthMessage=function(){var t=$('<div class="ch-item-empty">'+$.t("If you want to use private messages - please __signInLink__!",{signInLink:'<a href="#signin">'+$.t("sign in or register")+"</a>"})+"</div>");return t.on("click",function(){return runOrSignIn(function(){},{source:"Private messages widget placeholder",sourceMeta:"Chart"}),!1}),t},a.prototype.setRoomTitle=function(t){var e=this;w({title:$.t("Set Chat Title"),content:s.render('<input class="tv-control-input" name="value" value="{{ oldTitle }}">',{oldTitle:this.getRoomTitleById(t)})}).actionLoader("submit").on("submit",function(i,o){o&&(i.actionLoader("submit","start"),e._model.editRoom(t,o,"",function(t){i.actionLoader("submit","stop"),t.error?i.error(t.error):i.close()}))}).open()},a.prototype._showRoom=function(t,e){e.removeClass("js-hidden"),e.data("hidden-conversation",!1),this.removePlaceholder(),this._model.removeHiddenRoom(t)},a.prototype._hideRoom=function(t,e){var i,o,s;this._model.isRoomHidden(t)||(i=this._$data.find("#msg-item-"+t),o=this.isCurrentRoom(t),s=this._$data.find(".msg-item").not(".js-hidden"),i.addClass("js-hidden"),i.removeClass("active"),i.data("hidden-conversation",!0),1===s.length&&this.appendPlaceholder("hidden"),o&&(this.closeChat(!0),this._scroll.scrollToStart()),this._model.addHiddenRoom(t),e||x.emit("messages.chatvisibility",t+":hide"))},a.prototype.showRoomContextMenu=function(t,e){var i=this.getRoomById(e),o=this.getPrivateRoomActions(i),s=[o.hideConversation];(s=s.concat(o.multiUserActions)).push(h.getLaunchInSeparateWindowAction(e,function(){return!0})),u.createMenu(s.map(function(t){return new l({label:t.title,onExecute:t.action})})).then(function(e){e.show(t)})},a.prototype.getPrivateRoomActions=function(t){var e={},i=t.room_id;return e.hideConversation={title:$.t("Hide Conversation"),action:function(){this._hideRoom(i)}.bind(this)},e.multiUserActions=[],t.members_info.length>2&&e.multiUserActions.push({title:$.t("Set Chat Title..."),action:function(){this.setRoomTitle(i)}.bind(this)},{title:$.t("Leave This Chat"),action:function(){b({
content:$.t("Are you sure you want to leave this chat?")}).then(function(t){t.actionLoader("yes").on("action:yes",function(t){t.actionLoader("yes","start"),this._model.leaveFromRoom(i,function(e){t.actionLoader("yes","stop"),e.error?t.error(e.error):(this.isCurrentRoom(i)&&this.closeChat(!0),this.resize(),t.close())}.bind(this))}.bind(this)).open()}.bind(this))}.bind(this)}),e},a.prototype.getFaceToFaceChat=function(t){var e,i,o=this._model.getRooms();for(e in o)if(2===(i=o[e].members_info).length&&(i[0].user_id===t||i[1].user_id===t))return o[e];return null},a.prototype.getCurrentRecipients=function(){var t=this._$chatMembersContent.find(".recipient").toArray().map(function(t){return Number(t.getAttribute("data-id"))});return t.push(window.user.id),t},t.exports={Widget:a}}).call(this,i("hY0g"),i("aIyQ"),i("nbsC"),i("Kxc7"))},"+WOZ":function(t,e,i){},"+slJ":function(t,e,i){"use strict";function o(t){return n().then(function(e){return e.hasUserAccessToDataSource(t)})}function s(t){return n().then(function(e){return e.filterAccessibleDataSources(t)})}i.d(e,"b",function(){return o}),i.d(e,"a",function(){return s});var n=function(){return Promise.all([i.e(123),i.e(19),i.e(23),i.e(28),i.e(30),i.e(62),i.e(63),i.e(60),i.e(55),i.e(67),i.e(79),i.e(76),i.e(80),i.e(83),i.e(88),i.e(100),i.e(116),i.e(133),i.e("alert-utils-has-user-access-to-data-source")]).then(i.bind(null,"SlIP"))}},"/VKo":function(t,e,i){},"0XzO":function(t,e,i){"use strict";i("pfXf");var o={smiliesMap:{":agree:":[0,0],":disagree:":[1,0],":okay:":[2,0],":peace:":[3,0],":wait:":[4,0],":wave:":[5,0],":buy:":[0,1],":sell:":[1,1],":profit:":[2,1],":loss:":[3,1],":uptrend:":[4,1],":downtrend:":[5,1],":\\)":[0,2],":D":[1,2],";\\)":[2,2],":\\(":[3,2],o_O:[4,2],":\\|":[5,2],":P":[0,3],":cry:":[1,3],":panic:":[2,3],":halo:":[3,3],":sarcasm:":[4,3],":shades:":[5,3],":sleepy:":[0,4],":love:":[1,4],":rage:":[2,4],"\\]:-\\)":[3,4],":bear:":[4,4],":bull:":[5,4],":tip:":[0,5],":dollar:":[1,5],":euro:":[2,5],":pound:":[3,5],":yen:":[4,5],":bitcoin:":[5,5],":idea:":[0,6],":rip:":[1,6],":popcorn:":[2,6],":coffee:":[3,6],":poop:":[4,6],":hot:":[5,6],":bullseye:":[0,7],":stop:":[1,7],":sun:":[2,7],":moon:":[3,7],":heart:":[4,7],":heartbroken:":[5,7],":spades:":[0,8],":clubs:":[1,8],":hearts:":[2,8],":diamonds:":[3,8],":star:":[4,8],":!:":[5,8],":ok:":[0,9],":no:":[1,9],":sos:":[2,9],":top:":[3,9],":cool:":[4,9],":free:":[5,9]},getSmileByCoords:function(t,e){t=Math.floor(t/25),e=Math.floor(e/25);var i="";return $.each(o.smiliesMap,function(o,s){if(s[0]===t&&s[1]===e)return i=o.replace(/\\/g,""),!1}),i},highlightNewMessages:function(t,e,i){var o=0,s=t.find(".ch-item").reverse().slice(0,e);if(!(!s.length||e<1||i<1)){for(;e>0;)e-=s.eq(o).find(".ch-item-text").length,o++;s.slice(0,o).highlight(i)}},getChatHistoryMessageURL:function(t,e){var i=new Date(t),o=i.getMonth()+1,s=i.getDate(),n=i.getHours(),a=i.getMinutes(),r=i.getFullYear()+"-"+(o<10?"0":"")+o+"-"+(s<10?"0":"")+s,h=(n<10?"0":"")+n+"%3A"+(a<10?"0":"")+a
;return"/chat/history/?room="+e+"&date="+r+"&timefrom="+h+"&timeto=00%3A00&usernames=&order=asc&tzoffset="+i.getTimezoneOffset()}};t.exports=o},"0gOL":function(t,e,i){"use strict";var o,s;i.r(e),i.d(e,"template",function(){return s}),o=i("yr01"),s='<div data-id="{{chartId}}" class="tv-widget-chart-like-button apply-common-tooltip {{typeClass}}" title="{{titleTooltip}}"><span class="tv-widget-chart-like-button__icon-place">'+o+'</span><span class="js-likes-counter"></span></div>'},"0tDG":function(t,e,i){"use strict";function o(t,e,o){return Promise.all([i.e(97),i.e(136),i.e("badge-element")]).then(i.bind(null,"QIeT")).then(function(i){var n=Object(s.__assign)(Object(s.__assign)({},i.convertToBadgeProps(e)),o);return i.renderBadgeElementImpl(t,n)})}i.r(e),i.d(e,"renderBadgeElement",function(){return o});var s=i("mrSG")},"14Xm":function(t,e,i){t.exports=i("cSMa")},"1UCy":function(t,e,i){"use strict";var o;i.r(e),i.d(e,"AlertEditorAbortReason",function(){return o}),function(t){t[t.AlertIsInvalid=0]="AlertIsInvalid",t[t.AlertsDispatcherNotFound=1]="AlertsDispatcherNotFound",t[t.AlertsMaintenance=2]="AlertsMaintenance",t[t.ChartModelNotFound=3]="ChartModelNotFound",t[t.MainSeriesIsATR=4]="MainSeriesIsATR",t[t.MainSeriesIsOffline=5]="MainSeriesIsOffline",t[t.MainSeriesIsInReplay=6]="MainSeriesIsInReplay",t[t.SourceIsDangerous=7]="SourceIsDangerous",t[t.SymbolIsInvalid=8]="SymbolIsInvalid",t[t.SymbolInfoTimeout=9]="SymbolInfoTimeout",t[t.UnsupportedResolution=10]="UnsupportedResolution",t[t.IsAlreadyPresent=11]="IsAlreadyPresent"}(o||(o={}))},"1gG9":function(t,e,i){},"1viN":function(t,e,i){"use strict";function o(){return new Promise(function(t){Promise.all([i.e(70),i.e(91),i.e(61),i.e(86),i.e("ban-user-dialog")]).then(function(e){t(i("1b6U"))}.bind(null,i)).catch(void 0)})}function s(t,e,i,s){o().then(function(o){new o.BanUserDialog(t,e,i,s).show()})}function n(t,e,i){o().then(function(o){new o.UnbanUserDialog(t,e,i).show()})}i.r(e),i.d(e,"showBanUserDialog",function(){return s}),i.d(e,"showUnbanUserDialog",function(){return n})},"2O5g":function(t,e,i){"use strict";function o(t){var e=Object(n.getAlertDialogType)(t),o=t.dataSourceHub?t.dataSourceHub.mainSeries():null,d=t.onAborted||function(){},l=Object(n.shouldAbortAlertEditor)(o,e);if(null!==l)return c.logError("Aborted: "+r.AlertEditorAbortReason[l]),Object(n.showAbortExplainingDialog)(l,e),void d(l);Promise.all([Promise.all([i.e(36),i.e(19),i.e(55),i.e(114),i.e(144),i.e("alert-editor-impl")]).then(i.t.bind(null,"Hlqb",7)),Object(a.getPriceAlertsDispatcher)(),function(t){return(t.series?Object(h.b)(t.series):Promise.resolve(!0)).then(function(e){var i=Object(s.__assign)({},t);return e||(delete i.series,delete i.value),i})}(t)]).then(function(t){var e=t[0],i=t[1],o=t[2];new e.AlertEditor(i,o)})}var s,n,a,r,h,d,c;i.r(e),i.d(e,"invokeAlertEditor",function(){return o}),s=i("mrSG"),n=i("PlME"),a=i("JUY+"),r=i("1UCy"),h=i("+slJ"),d=i("uOxu"),c=Object(d.getLogger)("Alerts.Price.InvokeAlertEditor")},"2Ud0":function(t,e,i){"use strict";function o(t){var e=function(i){
var o=$(i.currentTarget);i.preventDefault(),i.stopPropagation(),s(function(){void 0!==t.$elem&&(t.$elem.off({click:e}),t.$elem.fancybox(t)),o.click()})};"function"!=typeof $.fancybox?void 0!==t.$elem?t.$elem.one({click:e}):s(function(){$.fancybox(t)}):void 0!==t.$elem?t.$elem.fancybox(t):$.fancybox(t)}function s(t){i.e(255).then(function(e){i("rQie"),t()}.bind(null,i)).catch(i.oe)}var n;i.r(e),i.d(e,"lazyFancybox",function(){return o}),n=i("P5fv")},"4Tc7":function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" width="12" height="12"><path d="M5 .7C3 .7 2 3 2 5c0 4 0 4-2 5h12c-2-1-2-1-2-5C10 3 9 .7 7 .7c0-.9-2-.9-2 0zM4 11c0 1 1 1 2 1s2 0 2-1z"/></svg>'},"5Ucj":function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 586.70002 595.19999" width="586.7" height="595.2" enable-background="new 0 0 595.3 841.9"><path d="M293.4 0C131.8 0 0 131.8 0 297.6s131.8 297.6 293.4 297.6 293.3-131.8 293.3-297.6S454.9 0 293.4 0zm68 182.8h85v93.5h-85v-93.5zm-212.6 0h85v93.5h-85v-93.5zm148.8 306.1c-136 0-187.1-106.3-187.1-106.3h378.4s-55.2 106.3-191.3 106.3z"/></svg>'},"5VQP":function(t,e,i){"use strict";var o,s,n;i.r(e),i.d(e,"ContextMenuManager",function(){return n}),o=i("mrSG"),s=i("tWVy"),function(t){function e(){Object(s.b)()}var n=[];t.createMenu=function(t,s,a){return void 0===s&&(s={}),Object(o.__awaiter)(this,void 0,void 0,function(){var r,h;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return[4,Promise.all([i.e(12),i.e(14),i.e(73),i.e(201),i.e(8),i.e(11),i.e("context-menu-renderer")]).then(i.bind(null,"cbq4"))];case 1:return r=o.sent(),h=new r.ContextMenuRenderer(t,s,function(){var t=n.indexOf(h);-1!==t&&n.splice(t,1),void 0!==a&&a()},e),n.push(h),[2,h]}})})},t.hideAll=e,t.getShown=function(){for(var t=0;t<n.length;t++)if(n[t].isShown())return n[t];return null}}(n||(n={}))},"5u5W":function(t,e,i){},"6et/":function(t,e,i){"use strict";function o(t){for(var e=0;e<u.length;e++)if(u[e].name===t)return e;return-1}function s(t){if(!p)for(var e=u.length-1;e>=0&&!0!==u[e].func(t);e--);}function n(t){t.addEventListener("keypress",s,!1)}function a(t,e){var i={name:t,func:e},s=o(i.name);s>-1?u[s]=i:u.push(i)}function r(t){u.forEach(function(e,i){e.name===t&&u.splice(i,1)})}function h(t,e){var i={name:t,func:e},s=o(i.name);s>-1&&u.splice(s,1),u.unshift(i)}function d(){return p?null:p=Object(l.randomHashN)(4)}function c(t){if(t!==p)throw Error("Lock id is outdated");p=null}var l,u,p;i.r(e),i.d(e,"listen",function(){return n}),i.d(e,"registerListener",function(){return a}),i.d(e,"removeListener",function(){return r}),i.d(e,"pushBackListener",function(){return h}),i.d(e,"disable",function(){return d}),i.d(e,"enable",function(){return c}),l=i("0waE"),u=[],p=null,n(window)},"78iq":function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 24" width="32px" height="24px"><path d="M32 24V0L20 12v12zm-20 0V0L0 12v12z"/></svg>'},"7KDR":function(t,e,i){"use strict";var o,s,n,a,r,h,d,c,l;i.r(e),i.d(e,"Action",function(){return d}),
i.d(e,"ActionAsync",function(){return c}),i.d(e,"Separator",function(){return l}),o=i("mrSG"),s=i("zRdu"),n=i("aIyQ"),a=i.n(n),r=i("/3z9"),h=i("0waE"),c=function(t){function e(e,i){var o=t.call(this,{},i)||this;return o.type=s.a.ActionAsync,o._loader=e,o._loaded=!1,o}return Object(o.__extends)(e,t),e.prototype.loadOptions=function(){var t=this;return this._loadingPromise?this._loadingPromise:(this._loadingPromise=this._loader().then(function(e){t.update(e),t._loaded=!0}),this._loadingPromise)},e.prototype.isLoaded=function(){return this._loaded},e}(d=function(){function t(t,e){void 0===e&&(e=h.guid()),this.type=s.a.Action,this._destroyed=!1,this._binding=null,this.id=e,this._onUpdate=new a.a,this._options=t,this.update(t)}return t.prototype.execute=function(){this._options.checkable&&this.update({checked:!this._options.checked}),this._options.onExecute&&this._options.onExecute(this)},t.prototype.getLabel=function(){return this._options.label||""},t.prototype.getSubItems=function(){return this._options.subItems||[]},t.prototype.isDisabled=function(){return!0===this._options.disabled},t.prototype.isActive=function(){return!0===this._options.active},t.prototype.isCheckable=function(){return!0===this._options.checkable},t.prototype.isChecked=function(){return!0===this._options.checked},t.prototype.getPayload=function(){return this._options.payload},t.prototype.update=function(t){this._destroyed||(this._unbindShortcut(),t.hotkeyHash&&(this._options.shortcutHint=Object(r.humanReadableHash)(t.hotkeyHash)),this._options=Object.assign(this._options,t),this._bindShortcut(),this._onUpdate.fire(this))},t.prototype.onUpdate=function(){return this._onUpdate},t.prototype.getState=function(){return{label:this.getLabel(),disabled:this.isDisabled(),active:this.isActive(),subItems:this.getSubItems(),checkable:this.isCheckable(),checked:this.isChecked(),doNotCloseOnClick:this._options.doNotCloseOnClick||!1,shortcutHint:this._options.shortcutHint,hint:this._options.hint,icon:this._options.icon,iconChecked:this._options.iconChecked,toolbox:this._options.toolbox,showToolboxOnHover:this._options.showToolboxOnHover||!1,statName:this._options.statName,name:this._options.name}},t.prototype.getBinding=function(){return this._binding},t.prototype.setBinding=function(t){this._binding=t},t.prototype.destroy=function(){this._destroyed=!0,this._onUpdate.destroy(),null!==this._binding&&this._binding.destroy(),this._unbindShortcut()},t.prototype._bindShortcut=function(){var t,e=this;this._options.hotkeyGroup&&this._options.hotkeyHash&&(t="string"==typeof this._options.label?this._options.label:this._options.name,this._hotkeyAction=this._options.hotkeyGroup.add({hotkey:this._options.hotkeyHash,desc:t,handler:function(){return e.execute()},isDisabled:function(){return e.isDisabled()}}))},t.prototype._unbindShortcut=function(){this._hotkeyAction&&(this._hotkeyAction.destroy(),delete this._hotkeyAction)},t}()),l=function(){function t(t,e){void 0===e&&(e=h.guid()),this.type=s.a.Separator,this.id=e,this._hint=t}return t.prototype.getHint=function(){
return this._hint},t}()},GDPI:function(t,e,i){"use strict";function o(){if(null===s){var t=window.location.protocol+"//"+window.location.host+"/house-rules/";s=[{name:window.t("Multiple accounts"),text:window.t("Use only one account - registering with multiple accounts is not allowed."),id:"multi_acc"},{name:window.t("Suspicious links"),text:window.t("No posting links or reference to content / sites that contain viruses or malware."),id:"links"},{name:window.t("Hate speech"),text:window.t("No defamatory, threatening or discriminatory remarks, hate speech or personal attacks."),id:"hate_speech"},{name:window.t("English only"),text:window.t("English only for main public chatrooms and public ideas - so that everyone can understand. Any language can be spoken in the custom chat rooms. Later we may introduce main public chatrooms for other languages."),id:"language"},{name:window.t("Personal information"),text:window.t("Do not post offline personal contact information."),id:"personal_info"},{name:window.t("Illicit content"),text:window.t("No links / posts with illegal content, pornography, or nudity."),id:"illicit_content"},{name:window.t("Rights infringement"),text:window.t("Do not publish content that is not your original work, or infringes the copyright of any third party."),id:"copyright"},{name:window.t("Unsolicited advertising"),text:window.t("No advertising, direct marketing, or solicitation! To engage our audience, drop us a line at __email__",{email:"founders@tradingview.com"}),id:"ads"},{name:window.t("Violation of chat & comment etiquette"),text:window.t("Violation of chat etiquette. For more information on this etiquette please go to __link__",{link:t}),id:"recidive"},{name:window.t("Violation of script publishing"),text:window.t("Violation of script publishing. For more information on this please go to {link}",{link:t}),id:"script_publishing"}]}return s}var s;i.r(e),i.d(e,"getViolations",function(){return o}),i("YFKU"),s=null},GjsM:function(t,e,i){},HHbT:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" width="14" height="14"><path d="M10.893 9.512l.458 3.624c.014.105-.006.16-.02.176-.028.03-.109.005-.182-.03L7.812 11.73a1.973 1.973 0 0 0-.811-.16c-.302 0-.59.057-.81.16l-3.338 1.552c-.118.056-.164.051-.182.03-.014-.016-.034-.07-.02-.178L3.11 9.51c.06-.503-.162-1.18-.505-1.54L.087 5.302c-.085-.091-.09-.148-.086-.158.003-.01.04-.053.16-.077l3.621-.689c.491-.09 1.069-.506 1.315-.948L7.004 0l1.902 3.43c.246.442.824.859 1.312.947l3.617.69c.123.024.162.068.164.077.003.01-.003.066-.089.157L11.4 7.97c-.348.367-.57 1.045-.506 1.543z"/></svg>'},IRk6:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="50" height="50"><path d="M20 17.995c0-1.102.753-1.51 1.69-.91l10.62 6.83c.934.6.937 1.57 0 2.17l-10.62 6.83c-.934.6-1.69.192-1.69-.91v-14.01z"/></svg>'},Inbj:function(t,e,i){"use strict";function o(){var t,e,i=!1;for(t=a.length;t--;)e=a[t].onclose,a[t].wnd.closed?(e&&e.call(a[t].wnd),a.splice(t,1)):e&&(i=!0);!i&&s&&(clearInterval(s),s=void 0)}
var s,n=1e3,a=[];t.exports={open:function(t){var e,i,r;return"string"==typeof t?t={url:t}:null==t&&(t={}),null!=t.url&&""!==t.url||(t.url="about:blank"),null==t.name&&(t.name=void 0),e=window.open(t.url,t.name,function(t){var e,i,o;if(null==t)return"";if("object"==typeof t){for(i in e="",t){if("boolean"==typeof(o=t[i]))o=o?"yes":"no";else if(null==o)continue;e+=(e?",":"")+i+"="+o}return e}return t+""}(t.parameters)),i=void 0!==t.data,r={wnd:e,data:t.data},"function"==typeof t.onclose&&(r.onclose=t.onclose,i=!0),"function"==typeof t.onbound&&(r.onbound=t.onbound,i=!0),i&&(a.push(r),!s&&r.onclose&&(s=setInterval(o,n))),e},getData:function(t){for(var e=a.length;e--;)if(a[e].wnd===t)return a[e].onbound&&(a[e].onbound.call(t),a[e].onbound=null),a[e].data}}},JTGx:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14.888672 15.336914" width="14.889" height="15.337" enable-background="new 0 0 32 32"><path d="M14.062 7.54q0 1.085-.32 2.1-.313 1.017-.9 1.853H9.406l-.21-.907q-.58.47-1.11.72-.53.25-1.22.25-1.31 0-2.1-.993-.782-.992-.782-2.773 0-1.774.96-2.83.962-1.053 2.298-1.053.572 0 1.01.133.437.125.944.382v-.375h1.243v6.578h1.89q.33-.585.49-1.46.17-.883.17-1.58 0-1.28-.36-2.327-.35-1.047-1.04-1.797-.686-.75-1.7-1.14-1.014-.41-2.3-.41-1.25 0-2.29.457-1.03.454-1.775 1.22-.75.765-1.18 1.836-.42 1.06-.42 2.265 0 1.29.402 2.36.404 1.063 1.146 1.82.775.79 1.814 1.188 1.04.41 2.267.41.67 0 1.383-.085.72-.086 1.376-.274v1.11q-.76.163-1.416.217-.656.06-1.35.06-1.454 0-2.697-.5-1.242-.49-2.132-1.38-.9-.898-1.4-2.156-.5-1.26-.5-2.78 0-1.448.526-2.69.525-1.25 1.43-2.164.908-.914 2.15-1.438 1.244-.53 2.66-.53 1.53 0 2.733.484 1.2.484 2.03 1.36.83.874 1.26 2.11.445 1.225.445 2.733zM9.18 9.532V5.485q-.493-.227-.884-.32-.39-.102-.836-.102-1.008 0-1.578.703-.57.703-.57 2 0 1.274.453 1.93.453.648 1.414.648.52 0 1.04-.242t.95-.57z" font-family="Arial-BoldMT" font-size="16"/></svg>'},"JUY+":function(t,e,i){"use strict";function o(){return new Promise(function(t){null===r?Promise.all([i.e("vendors_embed"),i.e(19),i.e(58),i.e(63),i.e(55),i.e(80),i.e(88),i.e(116),i.e(114),i.e(144),i.e(152),i.e(169),i.e("price-alerts-dispatcher")]).then(i.t.bind(null,"3Tqy",7)).then(function(e){null===r&&(r=new e.AlertsDispatcher,window.initData.offlineAlertEventsOnInit&&r.showOfflineEvents()),t(r)}):t(r)})}function s(){return r}function n(t){return null===r&&(r=t,!0)}var a,r;i.r(e),i.d(e,"getPriceAlertsDispatcher",function(){return o}),i.d(e,"getPriceAlertsDispatcherIfExists",function(){return s}),i.d(e,"setPriceAlertsDispatcherIfNotExists",function(){return n}),a=i("iKPL"),r=null},JpHp:function(t,e){
t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42 42" width="42px" height="42px"><path d="M38.626 17.554h-2.81c-.354-1.755-1.055-3.157-1.756-4.566l1.756-1.755c1.4-1.4 1.4-3.51 0-4.912s-3.51-1.4-4.912 0l-1.756 1.76c-1.4-.7-2.81-1.4-4.565-1.752V3.51c0-2.11-1.402-3.51-3.51-3.51s-3.52 1.41-3.52 3.51v2.81c-1.754.355-3.156 1.056-4.565 1.756L11.233 6.32c-1.4-1.4-3.51-1.4-4.912 0s-1.4 3.512 0 4.913l1.76 1.755c-.7 1.402-1.4 2.81-1.753 4.566H3.51c-2.1 0-3.51 1.41-3.51 3.51s1.4 3.512 3.51 3.512h2.81c.355 1.755 1.056 3.156 1.756 4.565L6.32 30.9c-1.4 1.402-1.4 3.51 0 4.913s3.512 1.4 4.913 0l1.755-1.756c1.402.7 2.81 1.402 4.566 1.756v2.815c0 2.11 1.4 3.51 3.51 3.51s3.51-1.4 3.51-3.51v-2.81c1.757-.354 3.158-1.055 4.567-1.756l1.76 1.754c1.4 1.4 3.51 1.4 4.915 0s1.4-3.51 0-4.912l-1.756-1.756c.7-1.4 1.4-2.81 1.755-4.565h2.81c2.107 0 3.51-1.4 3.51-3.51.006-2.11-1.403-3.52-3.505-3.52zm-17.56 14.05c-5.968 0-10.534-4.565-10.534-10.532s4.566-10.54 10.533-10.54 10.532 4.566 10.532 10.533-4.558 10.54-10.532 10.54zm0-14.05c-2.11 0-3.512 1.4-3.512 3.51s1.4 3.512 3.51 3.512 3.51-1.402 3.51-3.51-1.4-3.512-3.51-3.512z"/></svg>'},Ky3Q:function(t,e,i){},Lmvx:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 17" width="17px" height="17px"><circle cx="10" cy="6" r="3"/><path d="M10 10c-4.575 0-6 3.333-6 3.333V15h12v-1.667S14.575 10 10 10zM2 5v6h2V5zm4 2v2H0V7z"/></svg>'},"OqB+":function(t,e,i){"use strict";function o(t,e,i,o,s){this._$bar=t,this._value=0,this._state="off",this._halt=i,this._tick=o,this._step=this._halt*this._tick/e,this._animations=s}function s(t,e,o){var s=i("debi");this._bridge=t,this._handler=e,this._rooms=o,this.favoritesSettings=s.prototype.getLocalizedJsonSetting("publiccharts.favorites",{}),this._handler(this.getMenu())}function n(t){this._title=$.t("Onsite Notifications"),this._settingsKey="messages.show_onsite_notifications",this._eventKey="messages.toggleonsitenotifications",t?(this._emailKey="privatemessages.send_email_notifications",this._emailTitle=$.t("Email Notifications")):(this._emailKey="publicchats.send_email_notifications",this._emailTitle=$.t("Email Notifications When I'm Mentioned")),this._isOn=TVSettings.getBool(this._settingsKey,!0),this._isOnEmail=TVSettings.getBool(this._emailKey,!0),v.on(this._eventKey,this._toggle.bind(this))}function a(t){this._settingsKey=t,this.state=this._getState(),this._updateSettingsListener=this._setFromAnother.bind(this),v.on("chat-sound-control-changed",this._updateSettingsListener),loginStateChange.subscribe(null,this._updateSettingsListener)}function r(t,e){this.parentWidget=t,this.isParentDependent=e,this.isOn=!1}function h(){loginStateChange.subscribe(this,function(){is_authenticated||(this._list=null)}.bind(this)),this._list=TVSettings.getJSON("chat.suggest_list")||[],this._cache={}}function d(t){this.voteSender=t,this.ideas=[]}var c,l,u=i("brCa"),p=u.showNoticeDialog,m=u.createNoticeDialog,g=i("Z9Tc").whenVerified,_=i("Wz41"),f=i("dTSQ").regExpEscape,v=i("FBuY").TVXWindowEvents;o.prototype.start=function(t){
"running"===this._state&&this.stop(),this._transaction=t,this._$bar.css("opacity","1"),this._$bar.css("background-color","#18BE8A"),this._state="running",this._intervalID=setInterval(this.update.bind(this),this._tick)},o.prototype.stop=function(){clearInterval(this._intervalID),this._value=0},o.prototype.update=function(){this._value>=this._halt?this.stop():"running"===this._state&&(this._value+=this._step,this._$bar.width(this._value+"%"))},o.prototype.finish=function(t,e){"off"!==this._state&&this._transaction===t&&(this.stop(),this.transaction=-1,e&&this._$bar.css("background-color","red"),this._state="off",this._$bar.animate({width:"100%"},this._animations[0]),this._$bar.animate({opacity:"0"},e?this._animations[2]:this._animations[1],function(){this._$bar.width(0)}.bind(this)))},o.prototype.finishOnError=function(t){this.finish(t,!0)},s.prototype.soundSettings=[{title:$.t("Sound on Every Message"),state:{onMessage:!0,onMessageForUser:!0}},{title:$.t("Sound on Addressed to Me Messages"),state:{onMessage:!1,onMessageForUser:!0}},{title:$.t("No Sound Notifications"),state:{onMessage:!1,onMessageForUser:!1}}],s.prototype.getMenu=function(){var t,e,o,s,n=[],r=this,h=i("eF4M"),d=i("debi");if(this._bridge.private_chat&&!this._bridge.standalone&&(n=n.concat(this._bridge.privateMenuItems().multiUserActions)).length&&n.push({separator:!0}),(n=n.concat(this.soundMenuItems(this.soundSettings,TVSettings.getJSON(this._bridge.private_chat?"privatemessages.sound":"chat.sound",a.prototype._default_state)))).push({separator:!0}),this._bridge.standalone||this._bridge.options&&this._bridge.options.layoutWithSelect||(this._bridge.private_chat||n.push(this._bridge.chatNotificationControl.onsiteMenuItem()),n.push(this._bridge.chatNotificationControl.emailMenuItem()),n.push({separator:!0})),n.push({title:$.t("Show Chart Snapshot Preview"),icon:{image:"url('/static/images/dialogs/checkbox.png')",offset:TVSettings.getBool("chat.show_snapshot_preview")?"0 -16px":void 0},action:function(t){this._bridge.postMessage("toggle_snaphot_preview")}.bind(this)}),this._bridge.private_chat||this._bridge.standalone||n.push({title:$.t("Show Only Favorite Rooms"),icon:{image:"url('/static/images/dialogs/checkbox.png')",offset:TVSettings.getBool("chat.show_only_favorites")?"0 -16px":void 0},action:function(t){this._bridge.postMessage("toggle_show_only_favorites")}.bind(this)}),n.push({separator:!0}),this._bridge.private_chat&&!this._bridge.standalone&&n.push(this._bridge.privateMenuItems().hideConversation),n.push({title:$.t("Ignored Users..."),action:function(t){this.showIgnoreList()}.bind(this)}),!this._bridge.standalone){t=!this._bridge.private_chat&&this._bridge._room in this.favoritesSettings;for(o=0;o<this._rooms.length;o++)if(this._rooms[o].room_id===this._bridge._room){e=this._rooms[o];break}e&&(n.push({separator:!0}),s=h.getLaunchInSeparateWindowAction(r._bridge._room,function(){return!!r._bridge.private_chat}),this._bridge.private_chat?n.push(s):(e.pinned||n.push({title:t?$.t("Remove This Room from Favorites"):$.t("Add This Room to Favorites"),
action:function(t){this._bridge.postMessage("toggle_favorite_room",t)}.bind(this,this._bridge._room)}),(n=n.concat(d.publicMenuItems(this._bridge._room,this._bridge,this))).push(s),e.pinned||((e.user_id===user.id||window.user.permissions.can_moderate_public_chats)&&n.push({title:$.t("Edit Room..."),action:function(t){this._bridge.postMessage("chat_edit_room",this._bridge._room)}.bind(this)}),window.user.permissions.can_moderate_public_chats&&n.push({title:$.t("Delete Room"),action:function(t){this._bridge.postMessage("chat_delete_room",this._bridge._room)}.bind(this)}))))}return n},s.prototype.update=function(){this._handler(this.getMenu(),!0)},s.prototype._radioIcon="data:image/gif;base64,R0lGODlhBgAGAMIGAIuMjo+QkpOUlrS1tra2uLe4uf///////yH5BAEKAAcALAAAAAAGAAYAAAMQeCVSRyACEiQIVYZhx2NOAgA7",s.prototype.soundMenuItems=function(t,e){return"boolean"==typeof e&&(e=$.extend(a.prototype._default_state,{onMessage:e})),t.map(function(t){var i,o=!0;for(i in e)if((i in t.state||!e[i])&&t.state[i]!==e[i]){o=!1;break}return t.icon={image:"url("+this._radioIcon+")"},t.icon.offset=o?{x:5,y:5}:{x:-30,y:-30},t.action=function(e){this._bridge.postMessage("chat_set_sound_state",{isPrivate:!!this._bridge.private_chat,state:t.state})}.bind(this),t}.bind(this))},s.prototype.showIgnoreList=function(){var t,e="",i=400,o=$('<span class="tv-text__font--italic i-align_center"></span>').html($.t("You have no ignored users")+".").css("display","block");for(t in user.ignore_list)e+='<div class="ch-ignore-list-item"><span>'+user.ignore_list[t]+'</span><a href="#" class="delete" data-id="'+t+'">'+$.t("Delete")+"</a></div>";e||(e=o,i=""),m({title:$.t("Ignored Users List"),content:e,actionsWrapTemplate:"",actions:"",height:i}).then(function(t){t.open();var e=t.$content;e.on("click",".delete",function(t){var i=$(this).data("id");return delete user.ignore_list[i],window.crossTabSyncUserAttr("ignore_list"),$.post("/conversation-ignore/",{user_id:i,action:"remove"}),$(this).parent().remove(),Object.keys(user.ignore_list).length||e.html(o),!1})})},n.prototype.destroy=function(){v.off(this._eventKey,this._toggle.bind(this))},n.prototype._toggle=function(t){this._isOn="true"===t},n.prototype.onsiteMenuItem=function(){var t=TVSettings.getBool(this._settingsKey);return t=void 0!==t?t:this._isOn,{title:this._title,icon:{image:TradingView.wrapUrl("url('/static/images/dialogs/checkbox.png')"),offset:t?"0 -16px":void 0},action:function(e){this._isOn=!t,TradingView.profile&&TradingView.profile.$settings.find('input[name="notification_mention_in_chat_onsite"]').prop("checked",this._isOn),TVSettings.setValue(this._settingsKey,this._isOn,{forceFlush:!0})}.bind(this)}},n.prototype.emailMenuItem=function(){var t=TVSettings.getBool(this._emailKey);return t=void 0!==t?t:this._isOnEmail,{title:this._emailTitle,icon:{image:TradingView.wrapUrl("url('/static/images/dialogs/checkbox.png')"),offset:t?"0 -16px":void 0},action:function(e){this._isOnEmail=!t,
TradingView.profile&&"privatemessages.send_email_notifications"!==this._emailKey&&TradingView.profile.$settings.find('input[name="notification_mention_in_chat_email"]').prop("checked",this._isOnEmail),TVSettings.setValue(this._emailKey,this._isOnEmail,{forceFlush:!0})}.bind(this)}},a.prototype._default_state={onMessage:!1,onMessageForUser:!0},a.prototype._getState=function(t){var e=$.extend({},this._default_state),i=TVSettings.getJSON(this._settingsKey,null,t);return null!==i&&("boolean"==typeof i?$.extend(e,{onMessage:i}):$.extend(e,i)),e},a.prototype.set=function(t){this._set(t),TVSettings.setJSON(this._settingsKey,this.state),v.emit("chat-sound-control-changed")},a.prototype._setFromAnother=function(){this._set(this._getState(!0))},a.prototype._set=function(t){this.state=$.extend({},this._default_state,t)},a.prototype.destroy=function(){this._updateSettingsListener&&(v.off("chat-sound-control-changed",this._updateSettingsListener),loginStateChange.unsubscribe(null,this._updateSettingsListener))},r.prototype.appendInput=function(t){this._$searchInputWrap=$('<div class="msg-input-wrap js-hidden">').appendTo(t),this._$searchInput=$('<div class="msg-input">').appendTo(this._$searchInputWrap),this._$searchInputText=$('<input type="text" placeholder="'+$.t("Find existing chat")+'"></textarea>').appendTo(this._$searchInput),this._$searchInputReset=$('<a class="input-reset js-hidden">').appendTo(this._$searchInput);var e=this;this._$searchInputText.on("keydown",function(t){if(13===t.which||38===t.which||40===t.which)return!1}).on("keyup",function(t){var i=e._$searchInputText.val(),o=new RegExp(i.split("").map(f).join(".*"),"i");if(27===t.which)""===e._$searchInputText.val()&&(e.isOn=!1,e._$searchInputWrap.addClass("js-hidden"),e.parentWidget.resize(),e._$searchButton.removeClass("active"),e.newRoom?(e.parentWidget._scroll.animateTo(e.newRoom.position().top),delete e.newRoom):e.parentWidget._scroll.restore()),e._$searchInputText.val(""),e.showRooms(),e._$searchInputReset.addClass("js-hidden");else{if(e.hideRooms(),0===e._$searchInputText.val().length)return e._$searchInputReset.addClass("js-hidden"),void e.showRooms();e._$searchInputReset.removeClass("js-hidden"),e.parentWidget._scroll.scrollToStart(),e._$data.find(".title").each(function(){o.test($(this).text())&&e.canShowRoom($(this).parent())&&$(this).parent().removeClass("js-hidden")})}}),this._$searchInputReset.on("click",function(t){e._$searchInputText.val(""),e._$searchInputReset.addClass("js-hidden"),e.showRooms(),e._$searchInputText.focus()})},r.prototype.appendButton=function(t){var e=this;this._$searchButton=$('<a class="button apply-common-tooltip" title="'+$.t("Find existing chat")+'" data-role="button" data-name="search">').append($(i("gCS/")).attr({width:17,height:17})).appendTo(t),this._$searchButton.on("click",function(t){e.isOn?(e.isOn=!1,e._$searchButton.removeClass("active"),e._$searchInputWrap.addClass("js-hidden"),e._$searchInputText.val(""),e._$searchInputReset.addClass("js-hidden"),e.showRooms(),e.parentWidget.resize(),
e.newRoom?(e.parentWidget._scroll.animateTo(e.newRoom.position().top),e.newRoom=""):e.parentWidget._scroll.restore()):(e.isOn=!0,e._$searchButton.addClass("active"),e.parentWidget._scroll.save(),e._$searchInputWrap.removeClass("js-hidden"),e.parentWidget.resize(),e._$searchInputText.focus(),e._onOpenCallback&&e._onOpenCallback())})},r.prototype.setRoomList=function(t){this._$data=t},r.prototype.setOpenCallback=function(t){this._onOpenCallback=t},r.prototype.hideRooms=function(){this._$data.children().addClass("js-hidden")},r.prototype.showRooms=function(){var t=this;this._$data.children().each(function(){t.canShowRoom($(this))&&$(this).removeClass("js-hidden")})},r.prototype.canShowRoom=function(t){return!t.data("hidden-conversation")},r.prototype.getButton=function(){return this._$searchButton},r.prototype.hideInput=function(){this._$searchButton.removeClass("active"),this._$searchInputWrap.addClass("js-hidden"),this._$searchInputText.val(""),this._$searchInputReset.removeClass("js-hidden"),this.showRooms(),this.parentWidget.resize()},r.prototype.getInputHeight=function(){return this._$searchInputWrap.hasClass("js-hidden")?0:this._$searchInputWrap.outerHeight()},r.prototype.isOpen=function(){return this.isOn},r.prototype.setNewRoom=function(t){this.newRoom=t},c=20,l=12e4,h.prototype._mapCacheToIds=function(t){return t.map(function(t){return this._cache[t]}.bind(this))},h.prototype._getFromCache=function(t,e){var i,o=this,s=!t.every(function(t){return t in o._cache});s?(i=o._list.map(function(t){return t.id}),$.get("/username_hint/",{ids:i},function(i){i.forEach(function(t){o._cache[t.id]=t}),setTimeout(function(){o._cache={}},l),e(o._mapCacheToIds(t))})):e(o._mapCacheToIds(t))},h.prototype.getList=function(t,e){var i,o="function"==typeof t?this._list.filter(t):this._list;o.length?(i=o.map(function(t){return t.id}),this._getFromCache(i,e)):e([])},h.prototype._addUser=function(t,e,i){this._list.length>=c&&(this._list.shift(),delete this._cache[t]),this._list.unshift({id:t,username:e}),i&&(this._cache[t]=i)},h.prototype.onUserSelect=function(t,e,i){if(window.user.id!==t&&window.user.username!==e){var o=this._list.map(function(t){return t.id}).indexOf(t);o>=0?(this._list.splice(o,1),this._list.unshift({id:t,username:e})):this._addUser(t,e,i),TVSettings.setJSON("chat.suggest_list",this._list)}},d._likesMonitoringModel=null,d._createLikesMonitoringModelIfNeeded=function(){null===d._likesMonitoringModel&&(d._likesMonitoringModel=_.makePublicModel())},d.getChartsHandler=function(){d._createLikesMonitoringModelIfNeeded();var t=d._likesMonitoringModel;return new d(t.voteForChart.bind(t))},d.getMessagesSnapshotsHandler=function(){d._createLikesMonitoringModelIfNeeded();var t=d._likesMonitoringModel;return new d(t.voteForMessageWithSnapshot.bind(t))},d.prototype.getIdeaByID=function(t,e){for(var i=0;i<this.ideas.length;i++)if(this.ideas[i].id===t)return e?i:this.ideas[i];return!1},d.prototype.addIdea=function(t,e,i,o,s){var n=this.getIdeaByID(e);n?n.elements.push(t):(n=new d.Idea(e,i,o,t,s),this.ideas.push(n)),
$(t).on("click",this.onClickUpdateVote.bind(this,n)),n.updateView()},d.prototype.onClickUpdateVote=function(t){if(window.user.id){var e=this;g({showDialog:!0,source:"Widgetbar vote"}).done(function(){if(!(t.blocked||t.voteStatus<0)){t.blocked=!0;var i=1-t.voteStatus;e.voteSender(t,i,function(i){i.error&&(p({title:i.errorTitle||$.t("Error"),content:i.error}),t.blocked=!1),e.onData(i)})}})}else runOrSignIn(function(){this.voteSender(t,1)}.bind(this),{source:"Widgetbar vote",verifiedPhoneRequired:!0})},d.prototype.onData=function(t){var e,i=this.getIdeaByID(t.id);i&&(i.likes=t.score,e=window.user.id===t.user_id,i.voteStatus>=0&&e&&(i.voteStatus=t.vote,i.blocked=!1),i.updateView(!e))},d.prototype.destroy=function(){},d.Idea=function(t,e,i,o){this.id=t,this.likes=e,this.voteStatus=i,this.elements=[o]},d.Idea.prototype.updateView=function(t){var e=$(this.elements);e.toggleClass("js-has-likes",!!this.likes),setTimeout(function(){e.find(".js-likes-counter").text(this.likes?this.likes:"")}.bind(this),75),e.toggleClass("active",!!this.voteStatus),t&&(e.removeClass("js-like-highlight"),setTimeout(function(){e.addClass("js-like-highlight")},10))},e.UserChatSuggestListHandler=h,e.ChatProgressBar=o,e.ChatSettingsDialog=s,e.ChatNotificationControl=n,e.ChatSoundControl=a,e.ChatRoomListSearchFilter=r,e.ChatLikesHandler=d},PlME:function(t,e,i){"use strict";function o(t){return t.alert?t.type||"edit_alert":"create_alert"}function s(t,e){return Object(c.isFeatureEnabled)("alerts-maintenance")?h.AlertEditorAbortReason.AlertsMaintenance:null!==t&&function(t){return t.status()===d.STATUS_OFFLINE}(t)?h.AlertEditorAbortReason.MainSeriesIsOffline:null!==t&&function(t){return t.status()===d.STATUS_INVALID_SYMBOL}(t)?h.AlertEditorAbortReason.SymbolIsInvalid:"create_alert"===e&&null!==t&&function(t){var e;return"ATR"===(null===(e=t.stateForAlert().styleInputs)||void 0===e?void 0:e.style)}(t)?h.AlertEditorAbortReason.MainSeriesIsATR:"create_alert"===e&&null!==t&&function(t){return t.isInReplay()}(t)?h.AlertEditorAbortReason.MainSeriesIsInReplay:null}function n(t,e){if(!l.has(t)){l.add(t);var i=function(t,e){var i=a.t("Oops!"),o=a.t("Alert editor could not be initialized");return new Map([[h.AlertEditorAbortReason.AlertsMaintenance,{title:a.t("Alerts maintenance"),content:a.t("We are doing some brief daily maintenance. Alerts will be back really soon, thanks for your patience!")}],[h.AlertEditorAbortReason.MainSeriesIsOffline,{title:i,content:("create_alert"===e?a.t("Cannot create an alert while offline"):a.t("Cannot edit an alert while offline"))+". "+a.t("Please check your internet connection")+"."}],[h.AlertEditorAbortReason.SymbolIsInvalid,{title:i,content:"create_alert"===e?a.t("Can't create alert on invalid symbol"):a.t("Can't edit alert on invalid symbol")}],[h.AlertEditorAbortReason.MainSeriesIsATR,{title:a.t("Alert cannot be set on an ATR-based chart"),
content:a.t("Your alert won't trigger the way you expect it to! Inputs for ATR-based charts are recalculated each time you open a chart and are generally dependent on time. Please use the traditional chart type to set an alert with a static box size.")}],[h.AlertEditorAbortReason.MainSeriesIsInReplay,{title:i,content:a.t("Alert creating is not available in replay mode.")}]]).get(t)||{title:i,content:o}}(t,e);Object(r.createNoticeDialog)(i).then(function(e){e.on("beforeClose",function(){return l.delete(t)}),e.open()})}}var a,r,h,d,c,l;i.r(e),i.d(e,"getAlertDialogType",function(){return o}),i.d(e,"shouldAbortAlertEditor",function(){return s}),i.d(e,"showAbortExplainingDialog",function(){return n}),a=i("YFKU"),r=i("brCa"),h=i("1UCy"),d=i("dfhE"),c=i("+GxX"),l=new Set},"Q+5U":function(t,e,i){},QcGJ:function(t,e,i){"use strict";function o(){return Promise.all([i.e("dialogs-core"),i.e(0),i.e(3),i.e(46),i.e(125),i.e("send-message-dialog-impl")]).then(i.t.bind(null,"WpOi",7))}Object.defineProperty(e,"__esModule",{value:!0}),e.noteForAuthor=function(t,e,i){o().then(function(o){return o.noteForAuthor(t,e,i)})},e.openPMDialog=function(t,e,i){o().then(function(o){return o.openPMDialog(t,e,i)})},e.newPrivateChatDialog=function(){o().then(function(t){return t.newPrivateChatDialog()})}},RsxI:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 16"><path d="M15.09 6.857s-.571 0-.724-.533c-.114-.457-.305-.876-.533-1.295-.229-.495.152-.876.152-.876l.571-.571c.229-.229.229-.61 0-.876l-.762-.762c-.229-.229-.61-.229-.876 0l-.571.571s-.381.381-.876.152c-.419-.229-.838-.419-1.295-.533-.533-.152-.533-.724-.533-.724v-.8a.602.602 0 0 0-.61-.61H7.966a.602.602 0 0 0-.61.61v.8s0 .571-.533.724c-.457.114-.876.305-1.295.533-.495.229-.876-.152-.876-.152l-.571-.571c-.229-.229-.61-.229-.876 0l-.762.762c-.229.229-.229.61 0 .876l.571.571s.381.381.152.876c-.229.419-.419.838-.533 1.295-.152.495-.724.533-.724.533h-.8a.602.602 0 0 0-.61.61v1.067c0 .343.267.61.61.61h.8s.571 0 .724.533c.114.457.305.876.533 1.295.229.495-.152.876-.152.876l-.571.571c-.229.229-.229.61 0 .876l.762.762c.229.229.61.229.876 0l.571-.571s.381-.381.876-.152c.419.229.838.419 1.295.533.495.152.533.724.533.724v.8c0 .343.267.61.61.61h1.067c.343 0 .61-.267.61-.61v-.8s0-.571.533-.724c.457-.114.876-.305 1.295-.533.495-.229.876.152.876.152l.571.571c.229.229.61.229.876 0l.762-.762c.229-.229.229-.61 0-.876l-.571-.571s-.381-.381-.152-.876c.229-.419.419-.838.533-1.295.152-.495.724-.533.724-.533h.8c.343 0 .61-.267.61-.61V7.467a.602.602 0 0 0-.61-.61h-.8zM8.5 11.555a3.541 3.541 0 0 1-3.556-3.556A3.541 3.541 0 0 1 8.5 4.443a3.541 3.541 0 0 1 3.556 3.556A3.561 3.561 0 0 1 8.5 11.555z"/></svg>'},SmzL:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 5" width="9" height="5"><path fill="currentColor" d="M0 0h9L4.5 5z"/></svg>'},UxRG:function(t,e,i){},VPmY:function(t,e,i){"use strict";var o,s,n,a,r;Object.defineProperty(e,"__esModule",{value:!0}),o=i("BHQF"),s=!1,n={data:{},ready:null},a=function(){return(0,
o.fetch)("/notifications-data/?widget_type=user",{credentials:"same-origin"}).then(function(t){t.json().then(function(t){n.data=t.settings})})},r=function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),window.is_authenticated?!1===s&&(s=!0,n.ready=a()):(s=!1,n.ready=Promise.resolve()),n},e.default=r,t.exports=e.default},Wz41:function(t,e,i){"use strict";function o(t){return"en"!==window.language&&(t=t+"."+window.locale),t}function s(t){if(void 0===t&&(t=!0),function(t){void 0===t&&(t=!0),et||(et=new N(t))}(t),!et)throw new Error("Unable to create private chat model");return new M(et)}function n(t){if(void 0===t&&(t=!0),it||(it=new Y(tt)),!it)throw new Error("Unable to create public chat model");return new A(it,t)}function a(t){it?Z.logError("Trying set initial rooms after creating"):tt=t}function r(t){var e=new Y(t);return new E(e)}var h,d,c,l,u,p,m,g,_,f,v,y,b,w,$,R,C,S,M,x,T,I,k,A,E,D,B,L,O,P,W,H,z,U,j,F,N,V,q,G,Q,K,J,X,Y,Z,tt,et,it;i.r(e),h=i("mrSG"),d=i("aIyQ"),c=i.n(d),l=i("TxTq"),u=i.n(l),p=i("P5fv"),m=i.n(p),g=i("nmNo"),_="/conversation-status/",f="/conversation-delete/",v="/conversation-post/",y="/conversation-ignore/",b="/ban-status/",w=function(){function t(t){this._statInterval="",this._statSymbol="",this._historyRequest=null,this._room="",this._isActive=!0,this._messageReceivedDelegate=new c.a,this._messageDeletedDelegate=new c.a,this._messageReceivedInOtherRoomDelegate=new c.a,this._messageDeletedInOtherRoomDelegate=new c.a,this._unknownEventDelegate=new c.a,this._pendingMessages={},this._newRoomInfoRequests={},this._onRoomDataHandler=this._pushStreamRoomDataHandler.bind(this),this._chatRooms=t,this._getChatRooms().startListenPushstream(),this._getChatRooms().roomsChanged().subscribe(this,this._flushPendingMessages),this._getChatRooms().otherEventReceived().subscribe(this,this._onOtherRoomEventReceived)}return t.prototype.destroy=function(){this.setRoom(""),this._getChatRooms().roomsChanged().unsubscribe(this,this._flushPendingMessages),this._getChatRooms().otherEventReceived().unsubscribe(this,this._onOtherRoomEventReceived),this._getChatRooms().stopListenPushstream(),this._historyRequest&&this._historyRequest.abort()},t.prototype.roomAdded=function(){return this._getChatRooms().roomAdded()},t.prototype.roomChanged=function(){return this._getChatRooms().roomChanged()},t.prototype.roomDeleted=function(){return this._getChatRooms().roomDeleted()},t.prototype.roomsChanged=function(){return this._getChatRooms().roomsChanged()},t.prototype.messageReceived=function(){return this._messageReceivedDelegate},t.prototype.messageDeleted=function(){return this._messageDeletedDelegate},t.prototype.messageReceivedInOtherRoom=function(){return this._messageReceivedInOtherRoomDelegate},t.prototype.messageDeletedInOtherRoom=function(){return this._messageDeletedInOtherRoomDelegate},t.prototype.otherEventReceived=function(){return this._unknownEventDelegate},t.prototype.createRoom=function(t,e,i,o){this._getChatRooms().createRoom(t,e,i,o)},
t.prototype.editRoom=function(t,e,i,o){return this._getChatRooms().editRoom(t,e,i,o)},t.prototype.getRooms=function(){return this._getChatRooms().rooms()},t.prototype.getRoomById=function(t){return this._getChatRooms().getRoomById(t)},t.prototype.getRoomInfo=function(t,e,i,o){return this._getChatRooms().getRoomInfo(t,e,i,o)},t.prototype.setActive=function(t){this._isActive=t},t.prototype.isActive=function(){return this._isActive},t.prototype.room=function(){return this._room},t.prototype.isHistoryLoading=function(){return null!==this._historyRequest},t.prototype.setStatSymbol=function(t){this._statSymbol=t},t.prototype.setStatInterval=function(t){this._statInterval=t},t.prototype.loadHistory=function(t,e){this._loadHistoryInternal(t,e)},t.prototype.setRoom=function(t,e){var i=this;this._room!==t&&(this._historyRequest&&(this._historyRequest.abort(),this._historyRequest=null),this._room&&u.a.off(this._getChannel(),this._onRoomDataHandler),this._room=t,this._room&&(this._historyRequest=this._loadHistoryInternal(0,function(t,o,s){e&&e(t,o,s),u.a.on(i._getChannel(),i._onRoomDataHandler)}),this._historyRequest.always(function(){i._historyRequest=null})))},t.prototype.getBanStatus=function(t,e){window.user.is_moderator&&window.user.id!==t.user_id&&!t.is_moderator?m.a.get(b,{user_id:t.user_id},function(t){e(!0,!t.error)}):e(!1)},t.prototype.ignoredUsers=function(){return window.user.ignore_list},t.prototype.ignoreUser=function(t,e,i,o){var s={action:e?"add":"remove",user_id:t.user_id,username:t.username};m.a.post(y,s,function(o){o.error||(e?window.user.ignore_list[t.user_id]=t.username:delete window.user.ignore_list[t.user_id],window.crossTabSyncUserAttr&&window.crossTabSyncUserAttr("ignore_list")),i&&i(o)}).fail(o)},t.prototype.sendMessageToRoom=function(t,e,i,o,s,n){var a,r;return(i=i||{}).interval=this._statInterval,!(!(e=e.trim())&&!i.text)&&(a=window.TradingView.onChartPage?this._statSymbol:"",r={meta:JSON.stringify(i),room_id:t,symbol:a,text:e},o&&o.messageType&&(r.type=o.messageType,o.warningType&&(i.warning_type=o.warningType)),this._extendCommonRequestData(r),m.a.post(v,r).done(s).fail(n),!0)},t.prototype.sendMessage=function(t,e,i,o,s){return""!==this._room&&this.sendMessageToRoom(this._room,t,e,i,o,s)},t.prototype.reportMessage=function(t){new g.ReportSendingAgent({entityText:t.text,entityType:"message",entityURL:t.id.replace(/-/g,""),username:t.username},this._reportMessageOptions()).send()},t.prototype.deleteMessage=function(t,e,i){m.a.post(f,{ids:t}).done(e).fail(i)},t.prototype._getChatRooms=function(){return this._chatRooms},t.prototype._reportMessageOptions=function(){return{}},t.prototype._pushStreamRoomDataHandler=function(t,e,i,o){switch(t.action){case"message":this._messageReceivedDelegate.fire(t.data,t.data.room_id,o);break;case"message-delete":this._messageDeletedDelegate.fire(t.data,t.data.room_id,o);break;default:throw new Error("AbstractChatModel._pushStreamRoomDataHandler: unknown action "+t.action)}},t.prototype._onOtherRoomEventReceived=function(t,e,i,o){var s=this,n=t.data.room_id
;n!==this.room()&&("message"===t.action||"message-delete"===t.action?this.getRoomById(n)?"message"===t.action?this._messageReceivedInOtherRoomDelegate.fire(t.data,n,o):this._messageDeletedInOtherRoomDelegate.fire(t.data,n,o):(this._pendingMessages[n]=this._pendingMessages[n]||[],this._pendingMessages[n].push({external:o,message:t}),this._newRoomInfoRequests[n]||(this._newRoomInfoRequests[n]=!0,this._getChatRooms().getRoomInfo(n,function(){delete s._newRoomInfoRequests[n],s._flushPendingMessages()},function(){delete s._newRoomInfoRequests[n],s._getChatRooms().updateRooms()}))):this._unknownEventDelegate.fire(t,e,i,o))},t.prototype._flushPendingMessages=function(){var t=this;Object.keys(this._pendingMessages).forEach(function(e){var i;t._pendingMessages[e]&&t.getRoomById(e)&&(i=e===t.room()?{message:t._messageReceivedDelegate,"message-delete":t._messageDeletedDelegate}:{message:t._messageReceivedInOtherRoomDelegate,"message-delete":t._messageDeletedInOtherRoomDelegate},t._pendingMessages[e].forEach(function(t){i[t.message.action].fire(t.message.data,e,t.external)}),delete t._pendingMessages[e])})},t.prototype._loadHistoryInternal=function(t,e){var i={_rand:Math.random(),offset:t,room_id:this._room,stat_interval:this._statInterval,stat_symbol:this._statSymbol};return this._extendCommonRequestData(i),m.a.get(_,i,function(t){e&&e(t,0===t.messages.length,!1)})},t}(),$=i("uOxu"),R=Object($.getLogger)("Chat.PrivateChatModel"),C="/chats/status/",S="/username_hint/",M=function(t){function e(e){var i=t.call(this,e)||this;return i._roomMessagesReadDelegate=new c.a,i._otherRoomMessagesReadDelegate=new c.a,i}return Object(h.__extends)(e,t),e.prototype.roomMessagesRead=function(){return this._roomMessagesReadDelegate},e.prototype.otherRoomMessagesRead=function(){return this._otherRoomMessagesReadDelegate},e.prototype.setMessagesRead=function(){this._updateRoomLastVisitedTime()},e.prototype.loadHistory=function(e,i){var o=this;t.prototype.loadHistory.call(this,e,function(t,e,s){o.setMessagesRead(),i&&i(t,e,s)})},e.prototype.loadMoreRooms=function(t){return this._getChatRooms().loadMoreRooms(t)},e.prototype.leaveFromRoom=function(t,e){return this._getChatRooms().leaveFromRoom(t,e)},e.prototype.updateRoomUsers=function(t,e,i){return this._getChatRooms().updateRoomUsers(t,e,i)},e.prototype.updateRoomInfo=function(t,e){this._getChatRooms().getRoomInfo(t,e,void 0,!0)},e.prototype.hiddenRooms=function(){return this._getChatRooms().hiddenRooms()},e.prototype.addHiddenRoom=function(t){this._getChatRooms().addHiddenRoom(t),this._updateRoomLastVisitedTime(t)},e.prototype.removeHiddenRoom=function(t){this._getChatRooms().removeHiddenRoom(t)},e.prototype.isRoomHidden=function(t){return this._getChatRooms().isRoomHidden(t)},e.prototype.searchUsers=function(t,e){p.get(S,{s:t},e)},e.prototype._extendCommonRequestData=function(t){t.is_private="1"},e.prototype._getChannel=function(){return this.room()},e.prototype._pushStreamRoomDataHandler=function(e,i,o,s){switch(e.action){case"message":this.setMessagesRead();break;case"messages-read":
var n=this.getRoomById(e.data.room_id);return void(n?this._roomMessagesReadDelegate.fire(n):R.logError("Received messages-read event for unknown room "+e.data.room_id))}t.prototype._pushStreamRoomDataHandler.call(this,e,i,o,s)},e.prototype._onOtherRoomEventReceived=function(e,i,o,s){var n,a=e.data.room_id;a!==this.room()&&("messages-read"!==e.action?t.prototype._onOtherRoomEventReceived.call(this,e,i,o,s):(n=this.getRoomById(a))&&this._otherRoomMessagesReadDelegate.fire(n))},e.prototype._updateRoomLastVisitedTime=function(t){(t&&t!==this.room()||this.isActive())&&(t=t||this.room(),p.post(C,{room_id:t}))},e}(w),i("YFKU"),x=i("BHQF"),T="/vote-for-chart/",I="/conversation-vote/",A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.__extends)(e,t),e.prototype.setActive=function(e){t.prototype.setActive.call(this,e),e?u.a.addChannel("chat"):this._activeReconnect&&u.a.removeChannel("chat")},e}(k=function(t){function e(e,i){void 0===i&&(i=!0);var o=t.call(this,e)||this;return o._activeReconnect=!0,o._activeReconnect=i,o}return Object(h.__extends)(e,t),e.prototype.deleteRoom=function(t,e){return this._getChatRooms().deleteRoom(t,e)},e.prototype.voteForChart=function(t,e,i){return Object(h.__awaiter)(this,void 0,void 0,function(){return Object(h.__generator)(this,function(o){return Object(x.fetch)(T,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({image_url:t.id,vote:e?1:0})}).then(function(t){return t.json()}).then(i),[2]})})},e.prototype.voteForMessageWithSnapshot=function(t,e,i){p.post(I,{id:t.id,vote:e?1:0},i)},e.prototype.favoriteRooms=function(){return this._getChatRooms().favoriteRooms()},e.prototype.isRoomFavorite=function(t){return this._getChatRooms().isRoomFavorite(t)},e.prototype.addFavoriteRoom=function(t){this._getChatRooms().addFavoriteRoom(t)},e.prototype.removeFavoriteRoom=function(t){this._getChatRooms().removeFavoriteRoom(t)},e.prototype.isShownOnlyFavorites=function(){return this._getChatRooms().isShownOnlyFavorites()},e.prototype.toggleShownOnlyFavorites=function(){this._getChatRooms().toggleShownOnlyFavorites()},e.prototype._reportMessageOptions=function(){var t=this.getRoomById(this.room());return t?{additionalText:p.t("Posted in {0}").format(t.title)}:{}},e.prototype._extendCommonRequestData=function(t){t.is_private=""},e.prototype._getChannel=function(){return"chat_"+this.room()},e}(w)),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.__extends)(e,t),e.prototype.setActive=function(e){t.prototype.setActive.call(this,e);var i=this.getRooms()[0].room_id;e?u.a.addChannel(i):this._activeReconnect&&u.a.removeChannel(i)},e}(k),D=function(){function t(t){var e=this;this._roomAddedDelegate=new c.a,this._roomChangedDelegate=new c.a,this._roomDeletedDelegate=new c.a,this._roomsChangedDelegate=new c.a,this._otherEventReceivedDelegate=new c.a,this._subscribersCount=0,this._rooms=t||[],setTimeout(function(){0===e._rooms.length&&e.updateRooms()},0)}
return t.prototype.getRoomInfo=function(t,e,i,o){var s=this.getRoomById(t);e&&s&&e(s)},t.prototype.startListenPushstream=function(){++this._subscribersCount,1===this._subscribersCount&&(this._multiplexerCallback=this._pushStreamBroadcastHandler.bind(this),u.a.on(this._multiplexerEvent(),this._multiplexerCallback))},t.prototype.stopListenPushstream=function(){--this._subscribersCount,0===this._subscribersCount&&u.a.off(this._multiplexerEvent(),this._multiplexerCallback)},t.prototype.rooms=function(){return this._rooms},t.prototype.getRoomById=function(t){var e=this._getRoomIndex(t);return-1===e?null:this._rooms[e]},t.prototype.roomAdded=function(){return this._roomAddedDelegate},t.prototype.roomChanged=function(){return this._roomChangedDelegate},t.prototype.roomDeleted=function(){return this._roomDeletedDelegate},t.prototype.roomsChanged=function(){return this._roomsChangedDelegate},t.prototype.otherEventReceived=function(){return this._otherEventReceivedDelegate},t.prototype._onRoomAdded=function(t){t&&(this._rooms.push(t),this._roomAddedDelegate.fire(t))},t.prototype._onRoomChanged=function(t){if(t){var e=this._getRoomIndex(t.room_id);-1!==e&&(this._rooms[e]=t,this._roomChangedDelegate.fire(t))}},t.prototype._onRoomDeleted=function(t){if(t){var e=this._getRoomIndex(t.room_id);-1!==e&&(this._rooms.splice(e,1),this._roomDeletedDelegate.fire(t))}},t.prototype._onRoomsChanged=function(t){var e=this._rooms;this._rooms=t,this._roomsChangedDelegate.fire(t,e)},t.prototype._pushStreamBroadcastHandler=function(t,e,i,o){this._otherEventReceivedDelegate.fire(t,e,i,o)},t.prototype._getRoomIndex=function(t){for(var e=this._rooms.length-1;e>=0;--e)if(this._rooms[e].room_id===t)return e;return-1},t}(),B=i("Vdly"),L=Object($.getLogger)("Chat.PrivateChatRooms"),O="privatemessages.hiddenrooms",P="/chats/get/",W="/chats/create/",H="/chats/title/",z="/chats/update/",U="/chats/leave/",j="/chats/info/",F=30,N=function(t){function e(e){void 0===e&&(e=!0);var i=t.call(this,null)||this;return i._updateRoomRequest=null,i._withPagination=!0,i._withPagination=e,window.loginStateChange.subscribe(i,i._onLoginStateChanged),i._onLoginStateChanged(),i}return Object(h.__extends)(e,t),e.prototype.updateRooms=function(t){var e,i=this;void 0===t&&(t=F),this._updateRoomRequest||(this._withPagination||(t=0),(e=window).user&&e.is_authenticated?(this._updateRoomRequest=p.get(P,{limit:t},this._onRoomsChanged.bind(this)),this._updateRoomRequest.always(function(){i._updateRoomRequest=null})):this._onRoomsChanged([]))},e.prototype.loadMoreRooms=function(t){void 0===t&&(t=F),this.updateRooms(this.rooms().length+t)},e.prototype.createRoom=function(t,e,i,o){var s=this;p.post(W,{members:i},function(t){t.error||t.room.existing||s._onRoomAdded(t.room),o&&o(t)})},e.prototype.editRoom=function(t,e,i,o){var s,n=this,a=this.getRoomById(t);return!!a&&(s={room_id:t,room_title:e},p.post(H,s,function(t){t.error||(a.title=e,n._onRoomChanged(a)),o&&o(t)}),!0)},e.prototype.getRoomInfo=function(t,e,i,o){var s=this,n=this.getRoomById(t);!n||o?p.get(j,{room_id:t},function(n){
if(n.error)i&&i();else{var a=s.getRoomById(t);o&&a?s._onRoomChanged(n.room):a||s._onRoomAdded(n.room),e&&e(n.room)}}).fail(i):e&&e(n)},e.prototype.leaveFromRoom=function(t,e){var i=this;return!!this.getRoomById(t)&&(p.post(U,{room_id:t},function(o){if(!o.error){var s=i.getRoomById(t);s?i._onRoomDeleted(s):L.logError("We are already left the room "+t)}e&&e(o)}),!0)},e.prototype.updateRoomUsers=function(t,e,i){var o=this;return!!this.getRoomById(t)&&(p.post(z,{members:e,room_id:t},function(e){var s=o.getRoomById(t);s&&(e.room&&e.room.members_info&&e.room.room_id===s.room_id&&(s.members_info=e.room.members_info),o._onRoomChanged(s)),i&&i(e)}),!0)},e.prototype.hiddenRooms=function(){return this._hiddenRooms},e.prototype.addHiddenRoom=function(t){this.isRoomHidden(t)||(this._hiddenRooms.push(t),this._flushHiddenRooms())},e.prototype.removeHiddenRoom=function(t){if(this.isRoomHidden(t)){var e=this._hiddenRooms.indexOf(t);this._hiddenRooms.splice(e,1),this._flushHiddenRooms()}},e.prototype.isRoomHidden=function(t){return-1!==this._hiddenRooms.indexOf(t)},e.prototype._multiplexerEvent=function(){return"pm_*"},e.prototype._pushStreamBroadcastHandler=function(e,i,o,s){var n=e.data.type;if("join"===n||"leave"===n){if("leave"===n&&window.user.id===e.data.user_id)return;this.getRoomInfo(e.data.room_id,void 0,void 0,!0)}t.prototype._pushStreamBroadcastHandler.call(this,e,i,o,s)},e.prototype._flushHiddenRooms=function(){Object(B.setJSON)(O,this._hiddenRooms,{forceFlush:!0})},e.prototype._onLoginStateChanged=function(){this._hiddenRooms=Object(B.getJSON)(O,[]),this.updateRooms()},e}(D),V="publiccharts.favorites",q="chat.show_only_favorites",G="/chats/public/get/",Q="/chats/public/create/",K="/chats/public/createpingback/",J="/chats/public/edit/",X="/chats/public/delete/",Y=function(t){function e(e){var i=t.call(this,e)||this;return i._favoriteRooms=Object(B.getJSON)(o(V),{}),i._showOnlyFavorites=!!Object(B.getBool)(q),i}return Object(h.__extends)(e,t),e.prototype.updateRooms=function(){p.get(G,this._onRoomsChanged.bind(this))},e.prototype.createRoom=function(t,e,i,o){var s={desc:e,title:t};p.post(Q,s,function(t){t.error||p.post(K,{room_id:t.room.room_id}),o&&o(t)})},e.prototype.editRoom=function(t,e,i,o){if(!this.getRoomById(t))return!1;var s={desc:i,room_id:t,title:e};return p.post(J,s,o),!0},e.prototype.deleteRoom=function(t,e){return!!this.getRoomById(t)&&(p.post(X,{room_id:t},e),!0)},e.prototype.favoriteRooms=function(){return Object.keys(this._favoriteRooms)},e.prototype.isRoomFavorite=function(t){return t in this._favoriteRooms},e.prototype.addFavoriteRoom=function(t){this._favoriteRooms[t]=!0,this._saveFavorires()},e.prototype.removeFavoriteRoom=function(t){delete this._favoriteRooms[t],this._saveFavorires()},e.prototype.isShownOnlyFavorites=function(){return this._showOnlyFavorites},e.prototype.toggleShownOnlyFavorites=function(){this._showOnlyFavorites=!this._showOnlyFavorites,Object(B.setValue)(q,this._showOnlyFavorites)},e.prototype._multiplexerEvent=function(){return"chat_*"},
e.prototype._pushStreamBroadcastHandler=function(e,i,o,s){if("create_room"!==e.data.type||e.data.meta.lang!==window.locale){var n=this.getRoomById(e.data.room_id);if(n)switch(n.last_message_time=Date.now(),e.data.type){case"edit_room":return n.title=e.data.meta.room_title,n.description=e.data.meta.room_desc,void this._onRoomChanged(n);case"delete_room":return void this._onRoomDeleted(n)}t.prototype._pushStreamBroadcastHandler.call(this,e,i,o,s)}else this._onRoomAdded(e.data.meta.room)},e.prototype._saveFavorires=function(){Object(B.setJSON)(o(V),this._favoriteRooms)},e}(D),i.d(e,"makePrivateModel",function(){return s}),i.d(e,"makePublicModel",function(){return n}),i.d(e,"setPublicInitialRooms",function(){return a}),i.d(e,"makeLiveSeparateModel",function(){return r}),Z=Object($.getLogger)("Chat.ChatModelsFactory"),tt=null,et=null,it=null},XhdI:function(t,e,i){"use strict";function o(t,e,i){var o=l.test(t.room_id),u=o?"pm":"public chat",p=function(t){var e=[];return n.emoji.each(function(i){t.search(i.re)>=0&&e.push(i.code)}),e}(e),m=p.length>0,g=function(t){var e={snapshot:0,chart:0,internal:0,external:0},i=t.match(a);return null!==i&&i.forEach(function(t){r.test(t)?c.test(t)||d.test(t)?e.snapshot++:h.test(t)?e.chart++:e.internal++:e.external++}),e}(e);e&&o?Object(s.trackEvent)("Chat","Send message to "+u):e&&!o&&Object(s.trackEvent)("Chat","Send message to "+u,String(t.title)),(i&&"snapshot"===i.type||g.snapshot>0)&&Object(s.trackEvent)("Chat","Send chart snapshot",u),g.chart>0&&Object(s.trackEvent)("Chat","Send chart link",u),g.internal>0&&Object(s.trackEvent)("Chat","Send internal link",u),g.external>0&&Object(s.trackEvent)("Chat","Send external link",u),m&&p.forEach(function(t){Object(s.trackEvent)("Chat","Send emoji",t)})}var s,n,a,r,h,d,c,l;i.r(e),i.d(e,"trackChatEvent",function(){return o}),s=i("PC8g"),n=i("PHun"),a=/((https?:\/\/)|(www\.))(-\.)?([^\s\/?\.#]+\.)+([^\s<>]*)?/g,r=/^(https?:\/\/).*tradingview.com/,h=/tradingview.com\/(chart|script)\//,d=/(image|i)\/([0-9a-zA-Z]{8})\/$/,c=/x\/([0-9a-zA-Z]{8})\/(.+?)?\/?$/,l=/^pm_.{16}/},YDhE:function(t,e,i){"use strict";function o(t){var e=t.type||"popup";return delete t.type,"modal"===e?new s.TVModal(t):new n.TVPopup(t)}var s,n;i.r(e),i.d(e,"createDialog",function(){return o}),s=i("6aJD"),n=i("tKRU")},ZI66:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" width="12px" height="12px"><path d="M10.37.6c-.43.053-.97.13-1.55.13C7.918.73 7.1.52 6.273.35 5.433.175 4.566 0 3.648 0 1.816 0 1.195.38 1.133.42L1 .51V12h.625V6.626c.234-.094.85-.26 2.027-.26.852.002 1.65.313 2.496.49.86.175 1.75.36 2.715.36.574 0 1.082-.076 1.512-.125.234-.023.44-.05.625-.08V.506c-.184.035-.395.065-.63.095z"/></svg>'},ZLE0:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 18" width="8" height="18"><path d="M3 8V4H-.5L4-.5 8.5 4H5v4zM3 10h2v4h3.5L4 18.5-.5 14H3z"/></svg>'},bxEH:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.showDialog=function(e,i,s,n){var a=(0,o.createDialog)({
type:"modal",width:500,title:e?$.t("Edit chat room"):$.t("Create New Public Chat"),content:t.render('\n\n\t\t\t\t<div class="tv-control-fieldset js-room-title-wrap">\n\t\t\t\t\t<label class="tv-control-fieldset__label tv-control-fieldset__label--color_dark tv-control-fieldset__label--width_small">\n\t\t\t\t\t\t'+$.t("Room title")+'*:\n\t\t\t\t\t</label>\n\t\t\t\t\t<span class="tv-control-fieldset__value tv-control-fieldset__value--width_big">\n\t\t\t\t\t\t<input name="room-title" type="text" value="'+(e?TradingView.clean(e.title):"")+'" class="tv-control-fieldset__value-control tv-control-input" required>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="tv-control-fieldset js-room-purpose-wrap">\n\t\t\t\t\t<label class="tv-control-fieldset__label tv-control-fieldset__label--color_dark tv-control-fieldset__label--width_small">\n\t\t\t\t\t\t'+$.t("Room purpose")+'*:\n\t\t\t\t\t</label>\n\t\t\t\t\t<span class="tv-control-fieldset__value tv-control-fieldset__value--width_big">\n\t\t\t\t\t\t<textarea name="room-desc" type="text" class="tv-control-fieldset__value-control tv-control-textarea" required>'+(e?TradingView.clean(e.description):"")+'</textarea>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="tv-control-fieldset tv-control-fieldset__hint" style="text-align: justify;">\n\t\t\t\t\t<p class="tv-control-fieldset__text">\n\t\t\t\t\t\t'+$.t("IMPORTANT: You are about to create a chat that will be visible to all users. Before you continue, please note these 5 requirements to avoid your chat getting deleted and -in severe cases- you getting banned:")+'\n\t\t\t\t\t</p>\n\t\t\t\t\t<ol class="tv-list tv-list--font-popup tv-list--numeric">\n\t\t\t\t\t\t<li>'+$.t("Provide a clear Search the existing chats and make sure you are not creating a duplicate")+"</li>\n\t\t\t\t\t\t<li>"+$.t("Title and Purpose that makes sense and is related to trading")+"</li>\n\t\t\t\t\t\t<li>"+$.t("Avoid contentious or offensive language when describing your chat")+"</li>\n\t\t\t\t\t\t<li>"+$.t("Use the correct language for the chat, it should align with the language version of TradingView")+"</li>\n\t\t\t\t\t\t<li>"+$.t("Chats should attract at least 5 users and 1 daily message continuously")+'</li>\n\t\t\t\t\t</ol>\n\t\t\t\t\t<p class="tv-control-fieldset__text">\n\t\t\t\t\t\t'+$.t("These are the minimal requirements for viable chats. For tips on how to create truly awesome ones, please read {link_start}this article{link_end} carefully.").format({link_start:'<a href="http://blog.tradingview.com/?p=2113" target="_blank">',link_end:"</a> "})+"\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t"),destroyOnClose:!0,actions:[{name:"ok",type:"success",text:$.t("Ok"),key:13},{name:"cancel",type:"default",text:$.t("Cancel"),method:"close"}]}).on("action:ok",function(t){var o=function(e){e.error?t.$content.find('[name="'+e.input_name+'"]').tvControlError("add",{id:e.id,message:e.error}).tvControlError("render"):(t.close(),n(e))},a=r.val(),d=h.val(),c=!1;a.length||(r.tvControlError("add",{id:"room-title",message:$.t("Room title is required")
}).tvControlError("render"),c=!0),d.length||(h.tvControlError("add",{id:"room-desc",message:$.t("Room purpose is required")}).tvControlError("render"),c=!0),c||(e?s(e.room_id,a,d,o):i(a,d,null,o))}).open(),r=a.$content.find('[name="room-title"]'),h=a.$content.find('[name="room-desc"]');r.tvControlError(),h.tvControlError(),r.on("input",function(){return r.tvControlError("remove",{id:"room-title"}).tvControlError("render")}),h.on("input",function(){return h.tvControlError("remove",{id:"room-desc"}).tvControlError("render")})};var o=i("YDhE");i("Uupk"),i("UxRG"),i("Q+5U"),i("+WOZ")}).call(this,i("nbsC"))},c2JX:function(t,e,i){"use strict";function o(t){return void 0===t&&(t=""),'\n\t\t<div class="tv-spinner" role="progressbar">\n\t\t\t<div class="tv-spinner__spinner-layer">\n\t\t\t\t<div class="tv-spinner__background tv-spinner__width_element"></div>\n\t\t\t\t<div class="tv-spinner__circle-clipper tv-spinner__width_element tv-spinner__circle-clipper--left"></div>\x3c!--\n\t\t\t\t--\x3e<div class="tv-spinner__circle-clipper tv-spinner__width_element tv-spinner__circle-clipper--right"></div>\n\t\t\t</div>\n\t\t</div>\n\t'}var s,n,a,r,h;i.r(e),i.d(e,"renderSpinnerTemplate",function(){return o}),i.d(e,"Spinner",function(){return h}),s=i("SzKR"),n=i("TzTt"),a=i("Owlf"),r=Object(n.parseHtmlElement)(o()),h=function(){function t(t){this._shown=!1,this._el=r.cloneNode(!0),this.setSize(t||a.a)}return t.prototype.spin=function(t){return this._el.classList.add("tv-spinner--shown"),void 0===this._container&&(this._container=t,t.appendChild(this._el)),this._shown=!0,this},t.prototype.stop=function(t){return t&&void 0!==this._container&&this._container.removeChild(this._el),this._el.classList.remove("tv-spinner--shown"),this._shown=!1,this},t.prototype.setStyle=function(t){var e=this;return Object.keys(t).forEach(function(i){var o=t[i];void 0!==o&&e._el.style.setProperty(i,o)}),this},t.prototype.setSize=function(t){var e=void 0!==t?"tv-spinner--size_"+t:"";return this._el.className="tv-spinner "+e+" "+(this._shown?"tv-spinner--shown":""),this},t.prototype.getEl=function(){return this._el},t.prototype.destroy=function(){this.stop(),delete this._el,delete this._container},t}()},cSMa:function(t,e,i){var o=function(){return this}()||Function("return this")(),s=o.regeneratorRuntime&&Object.getOwnPropertyNames(o).indexOf("regeneratorRuntime")>=0,n=s&&o.regeneratorRuntime;if(o.regeneratorRuntime=void 0,t.exports=i("u4eC"),s)o.regeneratorRuntime=n;else try{delete o.regeneratorRuntime}catch(t){o.regeneratorRuntime=void 0}},debi:function(t,e,i){"use strict";function o(t){this._bridge=t,this._container=t.$body,this._rooms_obj={},this._visible=!1,this._notificationCount=0,this.SORT_ROOMS_INTERVAL=5e3,this._model=u.makePublicModel(),this._model.roomAdded().subscribe(this,this._onRoomAdded),this._model.roomChanged().subscribe(this,this._onRoomChanged),this._model.roomDeleted().subscribe(this,this._onRoomDeleted),this._model.roomsChanged().subscribe(this,this._onRoomsChanged),
this._model.messageReceivedInOtherRoom().subscribe(this,this._onEventInOtherRooms),this._standalone=!!t.standalone,this._layoutWithSelect=!!t.layoutWithSelect||!!(t.options||{}).layoutWithSelect,this._bridge.chatNotificationControl=this._chatNotificationControl=new n.ChatNotificationControl(!1),t.visible&&(this._visible=t.visible.value(),t.visible.subscribe(this.onVisibilityChange.bind(this))),t.height&&t.height.subscribe(this.resize.bind(this)),t.width&&t.width.subscribe(this.resize.bind(this)),this._bridge.onMessage(function(t,e){switch(t){case"toggle_favorite_room":this.toggleFavoriteForRoom(e);break;case"toggle_room_notifications":this.toggleNotificationsForRoom(e)}}.bind(this)),this.layoutWithSelect()?this.prepareLayoutWithSelect():this.prepareLayout(),this.layoutWithSelect()&&this._createChatWidget(),this.setSortRoomsInterval(),loginStateChange.subscribe(this,function(){this._sortRoomsIntervalID&&clearInterval(this._sortRoomsIntervalID)}.bind(this)),0!==this._model.getRooms().length&&this._onRoomsChanged(this._model.getRooms(),[]),this.connect(),this.resize()}var s,n,a,r,h,d,c,l,u,p,m,g,_,f,v,y;i("pfXf"),s=i("eF4M"),n=i("OqB+"),a=i("7KDR").Action,r=i("5VQP").ContextMenuManager,h=i("hp/T"),d=i("PQvG"),c=i("sFgq").SidebarCustomScroll,l=i("bR4N").bindPopupMenu,u=i("Wz41"),p=i("bxEH").showDialog,m=i("VPmY"),g=i("qjxE"),_=i("vBL9"),f=i("NP3r").enabled,v=i("bKsZ").ProductFeatures,y=i("s4+V"),i("lNJX"),o.prototype._onRoomAddedBySelf=function(t){return!!this._model.getRoomById(t)&&(this.scrollToRoom(t),this.openChat(t),!0)},o.prototype._onRoomAdded=function(t){this.sortRooms(),t.user_id===window.user.id&&this._needScrollToAddedRoom&&(this._onRoomAddedBySelf(t.room_id),this._needScrollToAddedRoom=!1)},o.prototype._onRoomChanged=function(t){this.updateRoomCounter(t.room_id);var e=$("#pc-item-"+t.room_id);e.find(".title-text").text(t.title),e.find(".desc span").text(t.description)},o.prototype._onRoomDeleted=function(t){var e=$("#pc-item-"+t.room_id);g.jQueryCompatibleDestroy(e),e.remove(),this.resize(),this._bridge._room===t.room_id&&this.openChat(this.getDefaultRoom())},o.prototype._onRoomsChanged=function(t,e){var i,o=0===e.length&&0!==t.length;this._notificationCount=0,o&&(this._$data.empty(),this._rooms_obj={}),this.initNotificationsSettings(),i=this.layoutWithSelect()&&this._bridge.activeRoom?this._bridge.activeRoom:this.getActiveRoom(),this.sortRooms(o,i),this.toggleFavoritesVisibility(),o&&i&&(this.layoutWithSelect()&&this._rooms_obj[i]&&this._$select.html("<strong>"+TradingView.clean(this._rooms_obj[i].title)+"</strong>"+(this._rooms_obj[i].description?": "+TradingView.clean(this._rooms_obj[i].description):"")),!this.isStandAlone()&&this._model.getRoomById(i)&&setTimeout(function(){this.openChat(i)}.bind(this),0))},o.prototype._onEventInOtherRooms=function(t,e,i){var o,s,a,r,c,l=this,u=this._rooms_obj[t.room_id];u&&(o=$("#pc-item-"+u.room_id),this.updateRoomCounter(t.room_id),t.type||this.updateRoomDescMsg(u.room_id,t.username,t.text),
t.user_id!==window.user.id&&this.roomNotificationsOn(u)&&(s=TVSettings.getJSON("chat.sound",n.ChatSoundControl.prototype._default_state,!0),t.text&&(r=_.removeBBCodes(t.text),a=r.indexOf("@"+user.username)>-1),!i&&(!0===s||s.onMessage||a&&s.onMessageForUser)&&h.play("chat/message"),(c=new m).ready.then(function(){var e,s,n=c.data.notification_popup;a&&!i&&!l._standalone&&!l.layoutWithSelect()&&n&&document.hidden&&d.show(u.title,t.username+": "+r,t.user_pic),l.isCurrentRoom(u.room_id)&&l._visible||(e=l._$data.find('a[data-room="'+u.room_id+'"] .counter'),s=parseInt(e.text(),10),e.addClass("active").text(s+1),l._notificationCount++,o.highlight(1)),l.updateNotifications()})))},o.prototype.settingsKey=function(t){return"en"!==window.language&&(t+="."+window.locale),t},o.prototype.getLocalizedSetting=function(t,e){return TVSettings.getValue(this.settingsKey(t),e)},o.prototype.getLocalizedJsonSetting=function(t,e){return TVSettings.getJSON(this.settingsKey(t),e)},o.prototype.setTVSettings=function(t,e){return"en"!==window.language&&(t+="."+window.locale),TVSettings.setValue(t,e)},o.prototype.setJsonSetting=function(t,e){return TVSettings.setJSON(this.settingsKey(t),e)},o.prototype.onVisibilityChange=function(t){this._visible=t,t&&this._bridge._room&&$("#pc-item-"+this._bridge._room+" .counter").text("0").removeClass("active"),this.updateNotifications()},o.prototype.initNotificationsSettings=function(){this.notificationsSettings=this.getLocalizedJsonSetting("publiccharts.notifications"),this.notificationsSettings||(this.notificationsSettings=this._model.getRooms().reduce(function(t,e){return e.pinned&&(t[e.room_id]=1),t},{}))},o.prototype.setupDataEvents=function(){var t=this;this._$data.on("click touchend",".pc-item, .msg-item",function(e){t._touch_scroll||(t._searchFilter&&t._searchFilter.isOpen()&&t._searchFilter.setNewRoom($("#pc-item-"+$(this).data("room"))),t.openChat($(this).data("room")),e.preventDefault())}).on("touchstart",function(){t._touch_scroll=!1}).on("touchmove",function(e){t._touch_scroll=!0}).on("contextmenu",".pc-item",function(e){e.preventDefault(),t.showRoomContextMenu(e,$(this).data("room"))}),this.isStandAlone&&!this.isStandAlone()&&this._$data.on("click touchend",".pc-item .fav",function(e){t.toggleFavoriteForRoom($(this).data("room")),e.stopPropagation(),e.preventDefault()}).on("click touchend",".pc-item .notifications-toggle",function(e){t.toggleNotificationsForRoom($(this).data("room")),e.stopPropagation(),e.preventDefault()})},o.prototype.showRoomContextMenu=function(t,e){var i=o.publicMenuItems(e,this._bridge,this);i.push(s.getLaunchInSeparateWindowAction(e,function(){return!1})),r.createMenu(i.map(function(t){return new a({label:t.title,onExecute:t.action})})).then(function(e){e.show(t)})},o.prototype.prepareLayout=function(){var t=this;this._$widget=$('<div class="tv-publicchats">').appendTo(this._container),t._touch_scroll=!1,this._searchFilter=new n.ChatRoomListSearchFilter(this,!1),this._searchFilter.appendInput(this._$widget),
this._$dataWrap=$('<div class="pc-data-wrap">').appendTo(this._$widget),this._$dataWrap.on("contextmenu",function(t){t.target.classList.contains("pc-data-wrap")&&t.preventDefault()}),this._$data=$('<div class="pc-data">').appendTo(this._$dataWrap),this._$noFavoritesMessage=$("<div>"),this._$noFavoritesMessage.addClass("tv-widget-empty-message js-hidden"),this._$noFavoritesMessage.text($.t("You haven't added a chat room to favorites.")),this._$noFavoritesMessage.appendTo(this._$dataWrap),this._searchFilter.setRoomList(this._$data),this.setupDataEvents(),this._$addButton=$('<a class="button apply-common-tooltip" title="'+$.t("Create new public chat")+'" data-role="button" data-name="create">').append($(i("drLC")).attr({width:17,height:17})).appendTo(this._bridge.$headerspace),this._$addButton.on("click",function(e){e.preventDefault(),t.showEditRoomDialog()}),this._searchFilter.appendButton(this._bridge.$headerspace),this._$settingsButton=$('<a class="button apply-common-tooltip" title="'+$.t("Settings")+'" data-role="button" data-name="settings">').append($(i("RsxI")).attr({width:17,height:17})).appendTo(this._bridge.$headerspace),this._$settingsButton.on("click",s.prototype._showSettingsDialog.bind(this)),l(this._$settingsButton,null,{event:"show-popup",hideEvent:"hide-popup",addClass:"ch-popup ch-settings-popup",careBottomBorder:!0,careRightBorder:!0,viewportSpacing:2,reverse:!0}),this._scroll=new c(this._$dataWrap,this._$data)},o.prototype.prepareLayoutWithSelect=function(t,e){function n(t){var e=$(t.target).parents().andSelf();e.is(a._$select)||e.is(a._$data)||a._toggleList()}var a=this,r=!1;if(t&&!is_authenticated)return this._bridge.$header.hide(),void(this._$data=this._bridge.$body.append(e instanceof $?e:'<div>Please <a href="#signin" onclick="runOrSignIn(function(){}, { source: "Public chat widget" }); return false;">'+$.t("sign in or register")+"</a></div>"));this._bridge.$header.show(),this._bridge.$body.empty(),this._bridge.$header.addClass("chat-select-container"),this._$select=$('<div class="standalone-chat-select">').appendTo(this._bridge.$header),this._toggleList=function(){if(r)a._$data.stop().height("auto").removeClass("sliding open");else{a._$data.height("auto").addClass("sliding");var t=Math.min($(window).height()-a._$data.offset().top-5,a._$data.height());a._$data.height(0).animate({height:t},{duration:200,height:t,complete:function(){a._$data.addClass("open").removeClass("sliding")}})}a._$select[r?"removeClass":"addClass"]("active"),$(document)[r?"off":"on"]("mousedown touchstart",n),r=!r},this._$select.click(function(t){t.preventDefault(),t.stopPropagation(),a._toggleList()}),this._$settingsButton=$('<a class="button apply-common-tooltip" title="'+$.t("Settings")+'"></a>').append($(i("uafl")).attr({width:17,height:17})).appendTo(this._bridge.$header).click(function(t){a instanceof i("+SlM").Widget&&a._chatWidget?a._chatWidget._showSettingsDialog(t):a instanceof o&&s.prototype._showSettingsDialog.call(a,t)}),l(this._$settingsButton,null,{event:"show-popup",addClass:"ch-popup ch-settings-popup",
careBottomBorder:!0,careRightBorder:!0,viewportSpacing:2,reverse:!0}),this._$data=$('<div class="standalone-chat-list msg-data pc-data">').appendTo(this._bridge.$header).on("click touchend",function(t){a._touch_scroll||a._toggleList()}),o.prototype.setupDataEvents.call(this)},o.prototype.connect=function(){this._bridge.onMessage(function(t,e){"toggle_show_only_favorites"===t&&(this._model.toggleShownOnlyFavorites(),this.toggleFavoritesVisibility(),this.resize())}.bind(this))},o.prototype.destroy=function(){clearInterval(this._roomUpdateInterval),clearInterval(this._roomStatusInterval),this._model.roomAdded().unsubscribe(this,this._onRoomAdded),this._model.roomChanged().unsubscribe(this,this._onRoomChanged),this._model.roomDeleted().unsubscribe(this,this._onRoomDeleted),this._model.roomsChanged().unsubscribe(this,this._onRoomsChanged),this._model.messageReceivedInOtherRoom().unsubscribe(this,this._onEventInOtherRooms),this._model.destroy(),this._model=null},o.prototype.getDefaultRoom=function(){var t,e,i=this._model.getRooms();for(e=i.length-1;e>=0;e--)i[e].is_default&&(t=i[e].room_id);return t=t||("en"!==window.language?"general_"+window.locale:"general")},o.prototype.getActiveRoom=function(){var t=this.getLocalizedSetting("publicchats.activechat");return t||(t=this.getDefaultRoom()),t},o.prototype.updateRoomCounter=function(t,e){var i,o,s=this._rooms_obj[t],n=(new Date).getDate();s&&(!0!==e?(s.msgs_total++,s.msgs_date!==n?(s.msgs_date=n,s.msgs_days++,s.msgs_today=1,s.msgs_average=Math.round((s.msgs_total-1)/s.msgs_days)):s.msgs_today++):s.msgs_date=n,i=function(t){if(t<1e3)return String(t);var e=Math.floor(Math.log(t)/Math.log(1e3));return Math.round(t/Math.pow(1e3,e)*Math.pow(10,1))/Math.pow(10,1)+"KMGTPE".charAt(e-1)}(~~s.msgs_total),(o=this._$data.find("#pc-item-"+t)).find(".title-total").text(i),this.layoutWithSelect()||o.find(".title-text, .title-total").addClass("apply-common-tooltip common-tooltip-html").attr("title",TradingView.clean(s.description)+"<br><small>"+window.t("{messagesCount} all time messages").format({messagesCount:s.msgs_total})+"<br>"+window.t("{messagesCount} messages today").format({messagesCount:s.msgs_today})+"<br>"+(0===s.msgs_average?window.t("< 1 message average per day"):window.t("{messagesCount} average per day").format({messagesCount:s.msgs_average}))+"</small>"))},o.prototype.addRoom=function(t,e){
var o,s=$('<a href="#" data-room="'+t.room_id+'" id="pc-item-'+t.room_id+'" class="pc-item'+(e?" active":"")+(t.pinned?" pinned":"")+(this._model.isRoomFavorite(t.room_id)?" favorite":"")+'"><div class="title"><span class="title-text">'+TradingView.clean(t.title)+'</span> <span class="title-total">0</span></div><div class="desc"><span>'+TradingView.clean(t.description)+'</span></div><div class="counter">0</div>'+(this.isStandAlone()?"":'<div class="notifications-toggle'+(this.roomNotificationsOn(t)?" active":"")+'" data-room="'+t.room_id+'" title="'+$.t("Toggle notifications for this room")+'">'+i("4Tc7")+'</div><i class="fav'+(this._model.isRoomFavorite(t.room_id)?" active":"")+'" data-room="'+t.room_id+'" title="'+$.t("Toggle favorite")+'">'+i("HHbT")+"</i>")+"</div></a>");s.appendTo(this._$data),this.updateRoomCounter(t.room_id,!0),t.msgs_last_ts&&(t.last_message_time=1e3*+t.msgs_last_ts),t.msgs_last_text&&(o=t.msgs_last_text.split(": "),this.updateRoomDescMsg(t.room_id,o[0],o[1]))},o.prototype.updateRoom=function(t){$("#pc-item-"+t.room_id).appendTo(this._$data)},o.prototype.updateRoomDescMsg=function(t,e,i){var o,s,n=this._rooms_obj[t];n&&(o=$("#pc-item-"+t).find(".desc"),g.jQueryCompatibleDestroy(o),(s=o.find("time")).length||(s=$("<time>").appendTo(o)),o.find("span").text(e+": "+_.removeBBCodes(i)),g.jQueryCompatibleAgoDateFormatter(s,new Date(n.last_message_time||Date.now())))},o.prototype.updateNotifications=function(){var t=this._$data.find(".counter.active").length;this._bridge.notify(1,{notificationValue:t,clear:!t,force:!0,room:this._model.getRoomById(this._bridge._room)})},o.prototype.openChat=function(t,e){var i,o,s;this._bridge._room&&t===this._bridge._room||(this._$data.find("a").removeClass("active"),$("#pc-item-"+t).addClass("active"),i=$("#pc-item-"+t+" .counter"),o=parseInt(i.text(),10),i.text("0").removeClass("active"),this._bridge.postMessage("chat_select_channel",{room_id:t,new_msgs:o}),o&&(this._notificationCount=Math.max(0,this._notificationCount-o)),this._bridge._room=t,this.isStandAlone()||this.setTVSettings("publicchats.activechat",t),this.layoutWithSelect()&&(s=this._model.getRoomById(t),this._$select.html("<strong>"+TradingView.clean(s.title)+"</strong>"+(s.description?": "+TradingView.clean(s.description):""))),this.updateNotifications())},o.prototype.resize=function(){this.layoutWithSelect()?this.chatWidget.resize():this._scroll.resize()},o.prototype.isCurrentRoom=function(t){return this._bridge._room===t},o.prototype.scrollToRoom=function(t){this._scroll.animateTo($("#pc-item-"+t).position().top-10)},o.prototype.toggleFavoritesVisibility=function(){if(!this.isStandAlone()){this._$data.toggleClass("js-only-favorites",this._model.isShownOnlyFavorites());var t=this._model.isShownOnlyFavorites()&&0===this._$data.find(".favorite").length;this.layoutWithSelect()||this._$noFavoritesMessage.toggleClass("js-hidden",!t)}},o.prototype.toggleFavoriteForRoom=function(t){var e,i=!1;this._model.isRoomFavorite(t)?(this._model.removeFavoriteRoom(t),i=!1):(this._model.addFavoriteRoom(t),i=!0),
(e=$("#pc-item-"+t)).toggleClass("favorite",i),e.find(".fav").toggleClass("active",i),this.toggleFavoritesVisibility()},o.prototype.setSortRoomsInterval=function(){if(!this._sortRoomsIntervalID){var t=this;(this._$dataWrap||this._$data).on("mouseenter",function(){t._pointerInsideData=!0}).on("mouseleave",function(){t._pointerInsideData=!1}),this._sortRoomsIntervalID=setInterval(function(){t._pointerInsideData||t._bridge&&t._bridge.visible&&!t._bridge.visible.value()||t.sortRooms()},this.SORT_ROOMS_INTERVAL)}},o.prototype.sortRooms=function(t,e){e||(e=this.getActiveRoom()),this._model.getRooms().sort(this.sortRoomsFilter.bind(this)).forEach(function(i){!t&&i.room_id in this._rooms_obj?this.updateRoom(i):(this._rooms_obj[i.room_id]=i,this.addRoom(i,e===i.room_id))},this)},o.prototype.sortRoomsFilter=function(t,e){return t.pinned&&!e.pinned?-1:!t.pinned&&e.pinned?1:t.pinned&&e.pinned?t.title.toLowerCase()>e.title.toLowerCase()?1:-1:this._model.isRoomFavorite(t.room_id)&&!this._model.isRoomFavorite(e.room_id)?-1:!this._model.isRoomFavorite(t.room_id)&&this._model.isRoomFavorite(e.room_id)?1:"number"==typeof t.last_message_time&&"number"!=typeof e.last_message_time?-1:"number"!=typeof t.last_message_time&&"number"==typeof e.last_message_time?1:"number"==typeof t.last_message_time&&"number"==typeof e.last_message_time&&t.last_message_time>e.last_message_time?-1:"number"==typeof t.last_message_time&&"number"==typeof e.last_message_time&&t.last_message_time<e.last_message_time?1:t.title.toLowerCase()>e.title.toLowerCase()?1:-1},o.prototype.toggleNotificationsForRoom=function(t){t in this.notificationsSettings?delete this.notificationsSettings[t]:this.notificationsSettings[t]=1,this.setJsonSetting("publiccharts.notifications",this.notificationsSettings),$("#pc-item-"+t+" .notifications-toggle").toggleClass("active",t in this.notificationsSettings)},o.prototype.roomNotificationsOn=function(t){return t.room_id in this.notificationsSettings},o.prototype.showEditRoomDialog=function(t){var e=this;runOrSignIn(function(){window.user.permissions.can_moderate_public_chats||f(v.CAN_EDIT_PUBLIC_CHATS)?p(t,e._model.createRoom.bind(e._model),e._model.editRoom.bind(e._model),function(i){t||e._onRoomAddedBySelf(i.room.room_id)||(e._needScrollToAddedRoom=!0)}):y.createGoProDialog({feature:"editCreatePublicChat",isTrialAvailable:!0,upgradeMessage:$.t("Upgrade now")}).then(function(t){t.open()})},{source:"Public chat widget",verifiedPhoneRequired:!0})},o.prototype.isStandAlone=function(){return this._standalone},o.prototype.layoutWithSelect=function(){return this._layoutWithSelect},o.prototype._createChatWidget=function(){var t=$.extend(!0,{},this._bridge,{$header:null,publicMenuItems:this.publicMenuItems,hideMaximize:(this._bridge.options||{}).hideMaximize||this._layoutWithSelect,standalone:this.isStandAlone()||this.layoutWithSelect()});this.chatWidget=new s(t)},o.publicMenuItems=function(t,e,i){var o=[];return o.push({title:$.t("Toggle Notifications for This Room"),action:function(){e.postMessage("toggle_room_notifications",t)}}),o.push({
title:$.t("Link to This Room..."),action:function(){e.postMessage("chat_show_link",t)}}),o.push({title:$.t("Room Archives..."),action:function(){var e=new Date,i=e.getMonth()+1,o=e.getDate(),s=e.getFullYear()+"-"+(i<10?"0":"")+i+"-"+(o<10?"0":"")+o;window.open("/chat/history/?room="+t+"&date="+s+"&tzoffset="+e.getTimezoneOffset())}}),o},t.exports=o},drLC:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 17"><path d="M7 2h3v13H7M2 7h13v3H2z"/></svg>'},eF4M:function(t,e,i){"use strict";(function(e,o){function s(t){var e,i,o,s=function(){window.user._chatInputs||(window.user._chatInputs={}),window.user.chatSuggestHandler||(window.user.chatSuggestHandler=new l.UserChatSuggestListHandler)};s(),loginStateChange.subscribe(this,s),this._bridge=t,e=t.$body,this._model=null,i=this._bridge.visible.value(),this.isPrivate()?this._model=W.makePrivateModel():this._bridge.live&&this._bridge.rooms?this._model=W.makeLiveSeparateModel(this._bridge.rooms):(this._model=W.makePublicModel("en"===window.language),"en"!==window.language&&(i=!0)),this._model.messageReceived().subscribe(this,this._onMessageWrapper),this._model.messageDeleted().subscribe(this,this._onMessageDeleted),this._model.roomChanged().subscribe(this,this._onRoomChanged),this._model.setActive(i),this._isHistoryEnded=!1,this._markNewMessagesAsUnread=!1,this._invisibleMessagesNumber=0,this._inputDisabled=!1,this.MESSAGES_CONCATENATION_TIMEOUT=12e4,this.MAX_MESSAGES=100,this.MAX_HIGHLIGHTED_MESSAGES=10,this.DEFAULT_AVATAR="/static/images/avatar.png",this.USERLINK_POPUP_TIMEOUT=1e3,this.META_VERSION="0.2",this._init_history_loading=!0,this._init_history_loaded=!1,this._onBridgeVisibleChange=null,this._onSymbolChanged=null,this._onIntervalChanged=null,this._onResize=null,this._onMaximized=null,this._standalone=!t||!!t.standalone,this._embedded=!t||!!t.embedded,this._noAutoFocus=!!t.noAutoFocus,this.utm=G(!1),this.isPrivate()||(this._updateMessageBatches(),this.updateLikesHandlers(),this.canHandleLikes=!0),this.prepareLayout(e),this.toggleSnaphotPreview(TVSettings.getBool("chat.show_snapshot_preview",!0)),o=null,this._standalone&&t.activeRoom?o=t.activeRoom:t&&t.properties&&(o=(t.properties.value()||{}).room||o),this.likeButtonTemplate=Q,this.messageContext=this.getMessageContext(),(this.isPrivate()||this._standalone&&this._model.getRoomById(o)||this._bridge.live)&&this.selectChannel(o),t&&(t.symbol&&(this._onSymbolChanged=this.update.bind(this),t.symbol.subscribe(this._onSymbolChanged,{callWithLast:!0})),t.interval&&(this._onIntervalChanged=this.update.bind(this),t.interval.subscribe(this._onIntervalChanged,{callWithLast:!0})),this._onResize=this.resize.bind(this),t.height&&t.height.subscribe(this._onResize),t.width&&t.width.subscribe(this._onResize),t.onMessage&&!t.live&&t.onMessage(this.onBridgeMessage.bind(this)))}function n(t){var e={messages:{},count:0,visibilityCallbacksFired:!1,fireAlt:!1};return t===it&&(e.clearAfterTriggering=!0),e}function a(t){return"create_room"===t.type||"edit_room"===t.type}function r(t){return JSON.parse(t).id}
function h(t,e){return t.lastIndexOf("@",e)}function d(t){var e,i;return!!window.getSelection().toString()||(!!(e=$(t)).is("img, a, path")||((i=e.closest("div")).hasClass("js-snapshot-like")||i.hasClass("js-chart-like")))}var c,l,u,p,m,g,_,f,v,y,b,w,R,C,S,M,x,T,I,k,A,E,D,B,L,O,P,W,H,z,U,j,F,N,V,q,G,Q,K,J,X,Y,Z,tt,et,it,ot,st,nt;i("pfXf"),i("Ky3Q"),c=i("9tJu").getUserProfilePath,l=i("OqB+"),u=i("mSWa").UsernameHintList,p=i("0XzO"),m=i("poeh").pushChartPage,g=i("7KDR"),_=g.Action,f=g.Separator,v=i("5VQP").ContextMenuManager,y=i("4QoS").takeChartSnapshot,b=i("hp/T"),w=i("Inbj"),R=i("UPgO"),C=i("1viN"),S=C.showBanUserDialog,M=C.showUnbanUserDialog,x=i("GDPI").getViolations,T=i("QcGJ").openPMDialog,I=i("h6Z7").showReportModal,k=i("sFgq").SidebarCustomScroll,A=i("bR4N").bindPopupMenu,E=i("PHun").emoji,D=i("ju+4"),B=i("brCa"),L=B.showNoticeDialog,O=B.createNoticeDialog,P=i("oNDq").createConfirmDialog,W=i("Wz41"),H=i("XJ8t"),z=i("c2JX").Spinner,U=i("PC8g").trackEvent,j=i("XhdI").trackChatEvent,F=i("qjxE"),N=i("Vxzh"),V=i("vBL9"),q=i("Y4QI").parseBBCode,G=i("JgDS").buildUtmQueryStringFromUrlParams,Q=i("0gOL").template,K=i("2Ud0").lazyFancybox,i("xict"),J=i("Ialn").detectAutoDirection,X=i("GAqT").TVOldDialogs,Y=i("Wj6+").Size,Z=i("0tDG").renderBadgeElement,tt=i("+GxX").isFeatureEnabled,et=0,it=1,ot=window.t("Like",{context:"like_button"}),s.prototype._onMessageWrapper=function(t,e,i){this.onMessage(t,i)},s.prototype.currentRoom=function(){return this._model.room()},s.prototype.enablePosting=function(){this._postingDisabled&&(this._hiddenElements&&this._hiddenElements.forEach(function(t){t.css("display","")}),this._$inputNoPostingMessage&&this._$inputNoPostingMessage.remove(),this.resizeHeader(),this._postingDisabled=!1)},s.prototype.onBridgeMessage=function(t,e){"chat_set_sound_state"===t?e.isPrivate===this.isPrivate()&&this.sound.set(e.state):"toggle_snaphot_preview"===t&&this.toggleSnaphotPreview(),this.isPrivate()?"private_chat_hidden"===t?this._markMessagesAsUnread(!0):"private_chat_visible"===t?(this._scroll.checkContentVisibility(),this._markMessagesAsUnread(!1)):"private_chat_msgs_read"===t&&this._markAsRead(e.idString):"chat_select_channel"===t?(this._newMessagesToHighlight=e.new_msgs,this.selectChannel(e.room_id)):"chat_edit_room"===t?this.editRoom(this._model.getRoomById(e)):"chat_delete_room"===t?this.deleteRoom(this._model.getRoomById(e)):"chat_show_link"===t&&this.showLinkToChat(this._model.getRoomById(e))},s.prototype.playSound=function(t){this.sound.state[t]&&(this.isPrivate()?b.play("chat/popup"):b.play("chat/message"))},s.prototype._clearExcessiveMessages=function(){var t=this._$data.find(".ch-item");return t.length>this.MAX_MESSAGES&&((t=t.slice(0,t.length-this.MAX_MESSAGES)).add(".ch-item-empty"),F.jQueryCompatibleDestroy(t),t.remove()),this._history_hide_timeout&&(clearTimeout(this._history_hide_timeout),this._history_hide_timeout=null),!!t.length},s.prototype._markAsRead=function(t){var e=t.split(":");this._scroll.triggerVisibilityCallbacks(function(t){var i=e.indexOf(t.id);return i>=0&&(e.splice(i,1),!0)
})},s.prototype._markMessagesAsUnread=function(t){t&&this._markNewMessagesAsUnread!==t&&(this._prepareUnreadMarker=!0),this._markNewMessagesAsUnread=t},s.prototype._shouldPlaceUnreadMarkerNow=function(){var t=this._prepareUnreadMarker;return this._prepareUnreadMarker=!1,this._markNewMessagesAsUnread&&t},s.prototype.onMessage=function(t,e){var i,o,s,n,r,h;t.user_id in this._model.ignoredUsers()||t.id&&this._lastMessageId===t.id||(this._lastMessageId=t.id,(o=(i=t.user_id!==window.user.id)&&this._shouldPlaceUnreadMarkerNow())&&this._$data.append(this._getNewUnreadMarker()),this.isPrivate()&&this._bridge.visible.value()&&this._bridge.postMessage("private_message_read",{id:"marker"}),(this._isMessageFromIgnoredUser(t)||a(t))&&this._invisibleMessagesNumber++,s=this.createMessage(t,{markAsUnread:this._markNewMessagesAsUnread,forceFullMessage:o,batch:it}),n=s[0].querySelector(".js-badge-wrapper"),r=new Promise(function(e){if(null!==n)return Z(n,t,{size:Y.Small}).then(e(s));e(s)}),h=this,Promise.resolve(r).then(function(o){if(o.data("short")){var s=h.getLastMessages(1);o.insertAfter(s.find(".ch-item-text:last"))}else h._$data.removeClass("no-messages"),o.appendTo(h._$data);h._scroll.atEnd(2*o.height())&&h._clearExcessiveMessages.apply(h),i&&h._bridge&&(t.meta.service_msg||(!h.isStandalone()&&!h.isPrivate()||e||h.playSound(o.data("is_reply")?"onMessageForUser":"onMessage"),h.highlightMessage(o,t.id))),h._scroll.atEnd(2*o.height())&&h._scroll.scrollToEnd()}))},s.prototype.highlightMessage=function(t,e){var i=this;this._bridge.visible.value()?this.isPrivate()&&this._bridge.postMessage("private_message_read",{id:e}):this.isPrivate()||(this._messagesToHighlight?this._messagesToHighlight=this._messagesToHighlight.concat(t.attr("id")).slice(-this.MAX_HIGHLIGHTED_MESSAGES):(this._messagesToHighlight=[t.attr("id")],this._bridge.visible.when(function(){var t=i._messagesToHighlight;delete i._messagesToHighlight,i._$data.find("#"+t.join(", #")).highlight(5)}),t=null))},s.prototype._onMessageDeletedBySelf=function(t){this._slidingUp||(this._slidingUp=[]),this._slidingUp.length||this._scroll.fixBottom(),this._slidingUp.push(t),t.slideUp({queue:!1,complete:function(){this._slidingUp.splice(this._slidingUp.indexOf(t),1),this._slidingUp.length||(delete this._slidingUp,this._scroll.releaseBottom()),this.removeMessage(t)}.bind(this)})},s.prototype._onMessageDeleted=function(t){var e=$("#ch-item-"+t.id);if(e.hasClass("ch-item-text")&&(e=e.closest(".ch-item")),e.length>0&&this._messagesIdsToBeDeletedBySelf&&this.getMessagesData(e)[0]===this._messagesIdsToBeDeletedBySelf[0])return this._messagesIdsToBeDeletedBySelf=null,this._onMessageDeletedBySelf(e);e.length>0&&(window.is_authenticated&&window.user.id===t.user_id?this.highlightAsModerated(e):this.removeMessage(e),this._scroll.resize())},s.prototype._onRoomChanged=function(){this.isPrivate()&&this._$addButton.find(".msg-window-members-count").text(this._bridge.membersCount())},s.prototype.removeMessage=function(t){F.jQueryCompatibleDestroy(t),t.remove()},
s.prototype.highlightAsModerated=function(t){t.prepend('<div class="ch-message-moderated-layout"><div class="ch-overlap">'+window.t("MODERATED")+"</div></div>").addClass("ch-message-moderated")},s.prototype.getLastMessages=function(t,e){var i=e instanceof DocumentFragment?$(e.childNodes).filter(".ch-item"):(e||this._$data).find(".ch-item");return i.slice(i.length-t)},s.prototype.getFirstMessages=function(t,e){return(e instanceof DocumentFragment?$(e.childNodes).filter(".ch-item"):(e||this._$data).find(".ch-item")).slice(0,t)},s.prototype.update=function(){this._bridge&&this._bridge.symbol&&this._model.setStatSymbol(this._bridge.symbol.value()||void 0),this._bridge&&this._bridge.interval&&this._model.setStatInterval(this._bridge.interval.value()||void 0)},s.prototype._clearMessageBatch=function(t){this._messageBatches[t].count>0&&(this._messageBatches[t]=n(t))},s.prototype._putMessageInBatch=function(t,e){this._messageBatches[t].clearAfterTriggering&&this._messageBatches[t].visibilityCallbacksFired&&this._clearMessageBatch(t),this._messageBatches[t].messages[e]=!0,this._messageBatches[t].count++},s.prototype._checkMessageBatchQuantity=function(t){return this._messageBatches[t].visibilityCallbacksFired?this._messageBatches[t].fireAlt:(this._onMessagesVisibility(t),this._messageBatches[t].fireAlt)},st=5,s.prototype._onMessagesVisibility=function(t){this._messageBatches[t].visibilityCallbacksFired=!0,this._messageBatches[t].count<=st&&(this._messageBatches[t].fireAlt=!0)},s.prototype._updateMessageBatches=function(){this._messageBatches&&delete this._messageBatches,this._messageBatches=[n(et),n(it)]},s.prototype._canLoadHistoryMessages=function(){return this._scroll.isContentShort()&&!this._isHistoryEnded&&this._bridge.visible.value()},s.prototype._loadChatHistory=function(){this._history_loading=!0,this._$data.addClass("loading");var t=this;this._model.loadHistory(this._$data.find(".ch-item-text").length+this._invisibleMessagesNumber,function(e,i){t._scroll.save(),t.prependMessages(e.messages,function(){t._scroll.restore(),t._history_loading=!1,t._isHistoryEnded=i,t._$data.removeClass("loading"),t._history_hide_timeout&&clearTimeout(t._history_hide_timeout),t._history_hide_timeout=setTimeout(function(){t._clearExcessiveMessages.apply(t)&&(t._scroll.scrollToEnd(),t._isHistoryEnded=!1)},24e5),t._canLoadHistoryMessages()&&t._loadChatHistory()})})},s.prototype.updateRoom=function(t){this._invisibleMessagesNumber=0,this._isHistoryEnded=!1,this._$data.addClass("loading"),this._spinner||(this._spinner=new z("mini").spin(this._$scrollContainer.get(0))),this._init_history_loading=!0,this.isPrivate()&&(this.updateLikesHandlers(),this._updateMessageBatches()),this._$inputDisabledMessage.hide();this._model.setRoom(t,function(t,e,i){this.isPrivate()&&this._bridge.xWindowDataSync&&"function"==typeof this._bridge.xWindowDataSync&&this._bridge.xWindowDataSync(t),F.jQueryCompatibleDestroy(this._$data),this._$data.empty(),this.resizeHeader(),this.isPrivate()&&!i&&(this._lastVisited=1e3*t.last_visited),this._isHistoryEnded=e,
t.messages.length&&(this._lastMessageId=t.messages[0].id);var o=this;this.prependMessages(t.messages,function(){if(o.updateTitle(),o._$data.removeClass("loading"),o._spinner&&(o._spinner.stop(),delete o._spinner),o._scroll.scrollToEnd(),o._newMessagesToHighlight&&t.messages.length>0){var e=Math.min(o._newMessagesToHighlight,o.MAX_HIGHLIGHTED_MESSAGES);p.highlightNewMessages(o._$data,e,5),o._newMessagesToHighlight=0}o._init_history_loading=!1,o.isPrivate()&&o.restoreInputText(),o._init_history_loaded&&o.inputEditFocus(),o._init_history_loaded=!0,o._canLoadHistoryMessages()&&o._loadChatHistory()})}.bind(this))},s.prototype.getRoomTitle=function(t){var e=this._model.getRoomById(t);return e?e.title:""},s.prototype.isStandalone=function(){return!!this._standalone},s.prototype.isEmbedded=function(){return!!this._embedded},s.prototype.isPrivate=function(){return this._bridge&&!!this._bridge.private_chat},s.prototype.getMessageContext=function(){var t=this;return{join:function(t){return{text:"<i>"+window.t("__username__ has entered the chat",{username:t.username})+"</i>",isService:!0}},leave:function(t){return{text:"<i>"+window.t("__username__ has left the chat",{username:t.username})+"</i>",isService:!0}},delete_room:function(t){return{text:"<i>"+window.t("Room __title__ was deleted",{title:t.meta.room_title})+"</i>",isService:!0}},warning:function(t){return $.extend(this.normal(t),{isService:!0,isWarning:!0})},normal:function(i){var o,s=i.meta&&"snapshot"===i.meta.type,n=t.META_VERSION===i.meta.version,a=i.meta.temp;return o=n?t.renderText(i).replace(/\n/g,"<br/>"):R.urlizeAndParseQuotesAndClean(i.text||"",R.smilies).replace(/\n/g,"<br/>"),s&&(o&&(o+="<br/>"),o+=e.render('<div class="ch-item-preview-wrap"><div class="ch-item-snapshot-link"><i class="icon icon-snapshot-small" title="{{title}}"></i> <a href="{{url}}" target="_blank">{{metaText}}</a></div><div class="ch-item-snapshot-preview"><a href="{{url}}" target="_blank"><img src="{{previewURL}}" class = "snapshot-preview" alt="" /></a></div>{{#chartId}}{{> ideaLikesButton }}{{/chartId}}</div>',{title:window.t("Chart Snapshot"),url:TradingView.clean(i.meta.url),metaText:window.t("Chart Snapshot"),previewURL:TradingView.clean(i.meta.preview_url?i.meta.preview_url:i.meta.url),chartId:!(t.isPrivate()||!a)&&i.id,typeClass:"js-snapshot-like",titleTooltip:ot},{ideaLikesButton:t.likeButtonTemplate})),{text:o,showAuthor:!i.meta.service_msg,isAuthor:user.id===i.user_id,isReport:i.meta.report_type,isModNotification:i.meta.mod_notification,isBanNotification:i.meta.ban_notification,newMeta:n,tempMeta:a,snapshotAttached:s}},get:function(t){return t.type&&this[t.type]?this[t.type](t):this.normal(t)}}},s.prototype.renderText=function(t){var o,s,n,a=this.utm?"?"+this.utm:"",r=new R.UrlizeBuffer(TradingView.clean(t.text),t.utm);return r=R.obsceneWords(r),t.meta.links.charts&&(o=t.meta.links.charts.occurences,s=t.meta.links.charts.data,o.forEach(function(t){var o=s[t.id],n=r.text.indexOf(t.match)>=0;n&&(r.text=r.text.replace(t.match,"<"+r.count+++">"),
r.values.push(e.render('{{#showLikesButton}}<div class="ch-item-preview-wrap">{{/showLikesButton}}<div class="ch-item-chart-link"><i class="icon icon-snapshot-small" title="{{publishedIdea}}"></i> <a href="{{href}}" target="_blank" data-id="{{chartId}}" data-symbol="{{symbol}}" data-title="{{title}}" data-url="{{href}}">{{publishedIdea}}</a></div><div class="ch-item-chart-preview"><a  href="{{href}}" target="_blank" data-id="{{chartId}}" data-symbol="{{symbol}}" data-title="{{title}}" data-url="{{href}}"><img src="{{imageUrl}}" alt="" class="idea-preview"/>{{#isVideo}}<div class="tv-notifications-widget-item__play-icon">'+i("IRk6")+'</div>{{/isVideo}}{{#videoCam}}<div class="tv-notifications-widget-item__video-cam">'+i("n5P/")+"</div>{{/videoCam}}</a></div>{{#showLikesButton}}{{> ideaLikesButton }}{{/showLikesButton}}{{#showLikesButton}}</div>{{/showLikesButton}}",{href:o.published_chart_url+a,publishedIdea:window.t("Published Idea"),title:o.name,symbol:o.symbol.split(":")[1],imageUrl:N.createPublishedChartImageUrl(o.image_url),showLikesButton:!this.isPrivate(),chartId:o.image_url,typeClass:"js-chart-like",titleTooltip:ot,isVideo:o.is_video,videoCam:o.video_cam},{ideaLikesButton:this.likeButtonTemplate})))},this)),r.text=V.parseQuotes(r.text),r.text=q(r.text),n=R.chainedUrlize(r,R.commonFunctors),n=E.parseNativeEmoji(n)},s.prototype._isMessageFromIgnoredUser=function(t){return t.user_id in this._model.ignoredUsers()},s.prototype.createMessage=function(t,o,s){var n,r,h,l,u,p,g,y,b,w,R,C,S,M,x;if(this._isMessageFromIgnoredUser(t)||a(t))return $();for(n=this.messageContext.get(t),r=t.meta.interval?" "+t.meta.interval:"",(h=document.createElement("div")).innerHTML=n.text,u=0;u<h.childNodes.length&&(h.childNodes[u].nodeType!==Node.TEXT_NODE||!(l=J(h.childNodes[u].textContent)));u+=1);if(p=$(e.render('<div class="ch-item ch-item-user-{{userID}} js-userlink-popup-anchor" id="ch-item-{{messageID}}"><a class="ch-item-userpic ch-item-userpic-{{userID}}" href="{{profileUrl}}" data-username="{{username}}" data-userlinkpopup-timeout="{{userlinkPopupTimeout}}" target="_blank"><img src="{{userPic}}" alt="Avatar" onerror="this.src=\'{{defaultAvatar}}\'"/></a><div class="ch-item-content">{{#showHeader}}<div class="ch-item-header">{{#showAuthor}}<span class="ch-item-author"><a href="{{profileUrl}}" target="_blank" class="ch-userlink selectable js-chat-suggest" data-username="{{username}}" data-userlinkpopup-timeout="{{userlinkPopupTimeout}}">{{username}}</a><span class="ch-userlink__badge-wrapper js-badge-wrapper"></span></span>{{/showAuthor}}<span class="ch-item-info">{{{symbolInterval}}}<span class="ch-item-time"><time></time></span></span>{{#showActions}}<div class="ch-item-actions js-actions"></div>{{/showActions}}</div>{{/showHeader}}<div class="ch-item-text selectable {{^showHeader}}ch-item-text-no-header{{/showHeader}} js-text"{{#autoDirection}}dir={{autoDirection}}{{/autoDirection}}>{{{text}}}</div></div></div>',{userID:t.user_id,messageID:t.id,username:t.username,userPic:t.user_pic,
userlinkPopupTimeout:this.USERLINK_POPUP_TIMEOUT,defaultAvatar:this.DEFAULT_AVATAR,showHeader:!("join"===t.type),showAuthor:n.showAuthor,symbolInterval:""!==t.symbol?'<span class="ch-item-symbol">'+t.symbol.substring(t.symbol.indexOf(":")+1)+r+",</span>":"",showActions:!n.isService,text:n.text,autoDirection:l,profileUrl:c({username:t.username,is_broker:t.is_broker},{query:this.utm})})),g=this,o.markAsUnread&&!n.isAuthor&&(this._putMessageInBatch(o.batch,t.id),p.addClass("js-unread-message"),this._scroll.subscribeToContentVisible(t.id,p,function(e){if(e||g._bridge.postMessage("private_message_read",{id:t.id}),g._checkMessageBatchQuantity(o.batch))return p.removeClass("js-unread-message"),void p.highlight(5);p.addClass("js-read-message"),p.removeClass("js-unread-message"),setTimeout(function(){p.removeClass("js-read-message")},2500)})),n.isService)return p.addClass("ch-message-service"),n.isWarning&&p.addClass("ch-message-type-warning"),p;if(0===(y=p.find(".js-text")).text().length&&1===y.children().length&&(y.children().hasClass("emoji")||y.children().hasClass("tv-emoji-wrapper"))&&y.addClass("ch-item-text-emoji"),this.canHandleLikes&&n.tempMeta&&(n.snapshotAttached&&(b=t.meta.temp.message_likes)&&this._snapshotMessagesLikesHandler.addIdea(p.find(".js-snapshot-like")[0],t.id,b.count,b.voted),n.newMeta&&t.meta.links.charts&&t.meta.temp.chart_likes&&(u=0,w=t.meta.temp.chart_likes,p.find(".js-chart-like").each(function(){var e=$(this).data("id");e===t.meta.links.charts.occurences[u++].id&&g._chartLikesHandler.addIdea(this,e,w[e].count,w[e].voted)}))),(R=p.find(".js-actions")).append($('<a class="ch-item-action" title="'+window.t("Quote this message")+'">')).children().last().append($(i("78iq")).attr({width:12,height:12})).on("click",function(e){e.stopPropagation(),g.insertQuote(p,t)}),n.isAuthor||R.append($('<a class="ch-item-action ch-item-action-report" title="'+window.t("Report this message")+'">')).children().last().append($(i("ZI66")).attr({width:12,height:12})).on("click",function(e){e.preventDefault(),g.showReportDialog(p,t)}),R.append($('<a class="ch-item-action js-settings" title="'+window.t("Message settings")+'">')).children().last().append($(i("JpHp")).attr({width:12,height:12})),R.on("contextmenu",function(t){t.preventDefault(),t.stopPropagation()}),this.bindMessageMenu(p,t),this.isEmbedded()||p.find(".js-chat-suggest").on("click",function(e){e.preventDefault(),e.stopPropagation(),window.user.chatSuggestHandler.onUserSelect(t.user_id,t.username),this.insertAtCursorPosition("@"+t.username.replace(/\s/g,"")+" ")}.bind(this)),this.isStandalone()||(C=p.find(".ch-item-snapshot-link a, .ch-item-snapshot-preview a"),K({$elem:C,type:"image",live:!1}),p.find(".ch-item-chart-link a, .ch-item-chart-preview a").click(function(){var t,e,i=$(this).data("url"),o=$(this).data("id"),s=$(this).data("symbol"),n=g._bridge.getChartWidgetCollection();return i?m({chartId:o,chartName:window.t("Published Idea"),publishedUrl:i,shortSymbol:s,chartWidgetCollection:n}):s?(t=$(this).data("title"),e=N.createPublishedChartUrl(o,s,t),m({
chartId:o,chartName:window.t("Published Idea"),publishedUrl:e,shortSymbol:s,chartWidgetCollection:n})):m({chartId:o,chartName:window.t("Published Idea"),chartWidgetCollection:n}),!1})),this.isStandalone()||this.isEmbedded()||p.on("contextmenu",function(e){d(e.target)||(e.preventDefault(),g._model.getBanStatus(t,function(i,o){t.is_banned=i&&o;var s=g.prepareMessageMenu(p,t).map(function(t){return t.separator?new f:new _({label:t.title,onExecute:t.action})});v.createMenu(s).then(function(t){t.show(e)})}))}),F.jQueryCompatibleAgoDateFormatter(p.find(".ch-item-time time"),this._parseMessageTime(t.time)),p.data("message",JSON.stringify(t)).data("alive",!0),this.isStandalone()&&p.data("ch-is-standalone",!0),is_authenticated&&(!g.isEmbedded()&&n.isAuthor?p.addClass("ch-is-author"):n.isReport?(p.addClass("ch-is-report"),o.forceFullMessage=!0):n.isModNotification?(p.addClass("ch-mod-notification"),o.forceFullMessage=!0,n.isBanNotification&&p.addClass("ch-ban-notification")):t.text&&p.text().indexOf("@"+user.username.replace(/\s/g,""))>-1&&(p.addClass("ch-is-reply").data("is_reply",!0),S=!0)),x=(M=this.getLastMessages(1,s))&&!M.hasClass("ch-message-moderated")&&M.data("message"))try{x=JSON.parse(x)}catch(t){x=null}return!o.forceFullMessage&&x&&t.username===x.username&&!x.type&&t.symbol===x.symbol&&t.interval===x.interval&&S===M.data("is_reply")&&new Date(t.time)-new Date(x.time)<this.MESSAGES_CONCATENATION_TIMEOUT?(M.find(".ch-item-symbol").replaceWith(p.find(".ch-item-symbol")),M.find(".ch-item-time time").replaceWith(p.find(".ch-item-time time")),p.find(".ch-item-text").data(p.data()).data("short",!0).addClass("js-message-concatenated").attr("id",p.attr("id"))):p},s.prototype.getMessagesData=function(t){var e=[r(t.data("message"))];return t.find(".ch-item-text[id]").each(function(t,i){var o=$(i).data("message");o&&e.push(r(o))}),e},s.prototype.insertQuote=function(t,e){var i=this._$inputEdit.val().trim();this._$inputEdit.focus(),this._$inputEdit.val(i+(i.length?"\n":"")+'[quote="'+e.username.replace(/\s/g,"")+'"]'+this.getFullMessage(t,e)+"[/quote]\n"),this._$inputEdit.trigger("autosize.resize")},s.prototype.getFullMessage=function(t,e,i){var o=[],s=i?V.removeBBCodes:V.removeQuotes;return o.push(s(e.text)),"snapshot"===e.meta.type&&o.push(e.meta.url),t.find(".js-message-concatenated").each(function(){var t=JSON.parse($(this).data("message"));o.push(s(t.text)),"snapshot"===t.meta.type&&o.push(t.meta.url)}),o.filter(function(t){return t}).join("\n")},s.prototype.bindMessageMenu=function(t,e){var i=this,o=t.find(".js-settings");o.on("click",function(s){s.stopPropagation(),o.hasClass("open")?o.trigger("hide-popup"):i.createMessageMenu(t,e,function(t){o.trigger("show-popup",[t,!0])})}),A(o,null,{event:"show-popup",hideEvent:"hide-popup",addClass:"ch-popup ch-item-settings-popup",careBottomBorder:!0,careRightBorder:!0})},s.prototype.showReportDialog=function(t,e){var i=this.getFullMessage(t,e,!0),o={};this.isPrivate()||(o.additionalText=window.t("Posted in {0}.").format(this._roomTitle)),
runOrSignIn(I.bind(null,e.username,"message",e.id.replace(/-/g,""),i,null,o),{source:"Chat report message",verifiedPhoneRequired:!0})},s.prototype.prepareMessageMenu=function(t,e){var i,o,s,n,a,r,h,d=[],c=this;return d.push({title:window.t("Quote this message"),action:function(){c.insertQuote(t,e)}}),d.push({title:window.t("Permanent link to this message"),action:function(){window.open("/chat/m/"+e.id.replace(/-/g,"")+"/")}}),user.id===e.user_id||this.isPrivate()||c.isStandalone()||d.push({title:window.t("Report this message"),action:this.showReportDialog.bind(this,t,e)}),(user.permissions.can_moderate_public_chats||user.id===e.user_id)&&d.push({title:window.t("Delete message"),action:function(){var e=c.getMessagesData(t);c._messagesIdsToBeDeletedBySelf=e,c._model.deleteMessage(e,null,function(){c._messagesIdsToBeDeletedBySelf=null})}}),d.push({separator:!0}),user.permissions.can_ban_people&&user.id!==e.user_id&&!e.is_moderator&&(i=!!e.is_banned,o={unban:window.t("Unban __username__",{username:e.username}),ban:window.t("Ban __username__",{username:e.username})},s={title:i?o.unban:o.ban,action:function(){i?M(e.user_id,e.username,function(){s.title=o.ban,i=!1}):S(c.getFullMessage(t,e,!0),e,{modal:!0},function(){s.title=o.unban,i=!0})}},d.push(s),t.find(".ch-userlink, ch-item-userpic").on("userbanchange",function(t,e){i=e,s.title=i?o.unban:o.ban})),window.user.id===e.user_id||e.is_moderator||(n=!!this._model.ignoredUsers()[e.user_id],a={ignore:window.t("Ignore __username__",{username:e.username}),unignore:window.t("Unignore __username__",{username:e.username})},r={title:n?a.unignore:a.ignore,action:function(){n?c._model.ignoreUser(e,!1,function(t){t.error?L({title:window.t("Error"),content:t.error}):(r.title=a.ignore,n=!1)}):P({type:"modal",content:window.t("Are you sure you want to ignore messages from __username__?",{username:e.username})}).then(function(t){t.actionLoader("yes").on("action:yes",function(t){t.actionLoader("yes","start"),c._model.ignoreUser(e,!0,function(e){t.actionLoader("yes","stop").close(),e.error?L({title:window.t("Error"),content:e.error}):(r.title=a.unignore,n=!0)})}).open()})}},d.push(r),t.find(".ch-userlink, ch-item-userpic").on("userignorechange",function(t,e){n=e,r.title=n?a.unignore:a.ignore})),c.isStandalone()||c.isPrivate()||user.id===e.user_id||d.push({title:window.t("Send private message to __username__",{username:e.username}),action:function(){runOrSignIn(T.bind(this,e.user_id,e.username),{source:"Chat send private message",verifiedPhoneRequired:!0,doNotCheckSuspicious:!0})}}),c.isPrivate()||(h=user.id===e.user_id?window.t("Show all my messages"):window.t("Show all messages from __username__",{username:e.username}),d.push({title:h,action:function(){var t=new Date,i=t.getMonth()+1,o=t.getDate(),s=t.getFullYear()+"-"+(i<10?"0":"")+i+"-"+(o<10?"0":"")+o;window.open("/chat/history/?room="+c._model.room()+"&date="+s+"&tzoffset="+t.getTimezoneOffset()+"&usernames="+e.username)}})),d[d.length-1].separator&&d.pop(),d},s.prototype.createMessageMenu=function(t,e,i){var o=this
;this._model.getBanStatus(e,function(s,n){e.type||(e.is_banned=s&&n,i(o.prepareMessageMenu(t,e)))})},s.prototype._messageUnread=function(t){return new Date(t)>new Date(this._lastVisited)},s.prototype.prependMessages=function(t,e){var i,o,s,n,r,h,d,c,l,u,p,m,g;if(t.length){if(o=(i=this.getFirstMessages(1))&&i.data("message"))try{s=(o=JSON.parse(o)).username}catch(t){}if(n=document.createDocumentFragment(),c=!1,l=!!this._lastVisited,(u=t.reverse()).forEach(function(t){var e,i,o,s=l&&this._messageUnread(t.time);s&&(e=this._updateUnreadMarker(et),n.appendChild(e.get(0)),c=!0,l=!1),(this._isMessageFromIgnoredUser(t)||a(t))&&this._invisibleMessagesNumber++,(i=this.createMessage(t,{markAsUnread:c,forceFullMessage:s,batch:et},n)).length&&(i.data("short")?(o=this.getLastMessages(1,n).find(".ch-item-text:last"),i.insertAfter(o)):(n.appendChild(i.get(0)),r=i))},this),this._messageUnread(u[0].time)||delete this._lastVisited,s&&r&&(h=r.data("message"))){try{d=(h=JSON.parse(h)).username}catch(t){}d&&d===s&&new Date(o.time)-new Date(h.time)<this.MESSAGES_CONCATENATION_TIMEOUT&&((p=i.find(".ch-item-text")).eq(0).attr("id",i.attr("id")),p.eq(0).data(i.data()),p.insertAfter(r.find(".ch-item-text:last")),i.remove())}m=Object.values(n.childNodes).map(function(t){return new Promise(function(e){var i,o,s=t.querySelector(".js-badge-wrapper");null===s&&e(t),(i=$(t).data("message"))&&0!==i.length||e(t),o=JSON.parse(i),Z(s,o,{size:Y.Small}).then(e(t))})}),g=this._$data.get(0),Promise.all(m).then(function(t){var i,o=document.createDocumentFragment();for(i=0;i<t.length;i++)o.appendChild(t[i]);g.insertBefore(o,g.firstChild),e()})}else e()},s.prototype._getNewUnreadMarker=function(){return this._$unreadMarker?$():this._updateUnreadMarker(it)},s.prototype._resetUnreadMarker=function(){this._$unreadMarker&&(this._$unreadMarker.remove(),delete this._$unreadMarker)},s.prototype._updateUnreadMarker=function(t){return this._resetUnreadMarker(),this._$unreadMarker=$('<div class="js-unread-marker ch-unread-marker">'),this._scroll.subscribeToContentVisible("__marker__",this._$unreadMarker,function(e){if(e||this._bridge.postMessage("private_message_read",{id:"__marker__"}),this._checkMessageBatchQuantity(t))this._$unreadMarker.remove();else{this._$unreadMarker.addClass("js-vanish");var i=this._$unreadMarker;setTimeout(function(){i.remove()},2500)}delete this._$unreadMarker}.bind(this)),this._$unreadMarker},s.prototype._parseMessageTime=function(t){return o.utc(t,"ddd MMM DD hh:mm:ss YYYY","en").toDate()},s.prototype.insertAtCursorPosition=function(t){var e=this._$inputEdit.val(),i=this._$inputEdit.prop("selectionStart");this._$inputEdit.val(e.slice(0,i)+t+e.slice(i)),this._$inputEdit.putCursorAtPosition(i+t.length).focus().trigger("autosize.resize")},s.prototype._stopSuggesting=function(){this._suggesting&&(this._suggesting=!1,this._usernameHintList.onInput("hide"))},s.prototype._trySuggest=function(t,e,i){var o,s,n,a,r;t.length<=0?this._stopSuggesting():0===(o=h(t,e)+1)||e<o||o>1&&!/\s/.test(t[o-2])?this._stopSuggesting():(s=e===o,
(n=t.substring(o))&&(e-=o,(a=/\s/.exec(n))&&a.index<e?n="":a&&(n=n.substring(0,a.index))),!n&&s&&(n="@"),r=!!n,this._suggesting?r?(n===this._previousSuggestCandidate?n="":this._previousSuggestCandidate=n,this._usernameHintList.onInput(i.which,n)):this._stopSuggesting():r&&!i.isDefaultPrevented()&&(this._suggesting=!0,this._usernameHintList.onInput(0,n)))},s.prototype._insertSuggestedUsername=function(t){var e,i=this._$inputEdit.val(),o=this._$inputEdit.prop("selectionStart"),s=h(i,o),n=/\s/.exec(i.substring(s)),a="@"+t,r=a.length+1;n&&"\n"!==n||(a+=" "),e="",n&&(e=i.slice(s+n.index)),this._$inputEdit.val(i.slice(0,s)+a+e).putCursorAtPosition(s+r).trigger("autosize.resize")},nt=400,s.prototype.prepareLayout=function(t){var e,o,n,a,r=this;this._$container=t,this._$widget=$('<div class="tv-chat">').appendTo(t),this._$scrollContainer=$('<div class="tv-chat-scroll-container">').appendTo(this._$widget),this._$scrollContainer.on("contextmenu",function(t){t.target.classList.contains("tv-chat-scroll-container")&&t.preventDefault()}),this._$data=$('<div class="ch-data no-messages">').appendTo(this._$scrollContainer),this._$data.on("click",".ch-item",function(t){d(t.target)||r.toggleHighlightUserMessages($(t.currentTarget))}).on("mouseenter",".ch-item",function(){var t=$(this),e=t.find(".ch-item-info"),i=t.find(".ch-item-header").width(),o=t.find(".ch-item-author").width()+e.width(),s=t.find(".js-actions").width();i-o<s&&e.addClass("js-hidden")}).on("mouseleave",".ch-item",function(){$(this).find(".ch-item-info").removeClass("js-hidden")}),this._$input=$(),this.isEmbedded()||(this._bridge&&this._bridge.$headerspace&&(this.isPrivate()||this.isStandalone()||(this._$mentionsButton=$('<a class="button apply-common-tooltip" title="'+window.t("Show only my sent and received messages")+'" data-role="button" data-name="mentions"></a>').append($(i("JTGx")).attr({width:17,height:17})).appendTo(this._bridge.$headerspace),this._$mentionsButton.on("click",function(t){return r.toggleMentionsOnly(),!1})),this._bridge.hideMaximize||(this._bridge.options||{}).hideMaximize||"function"!=typeof this._bridge.toggleMaximize||(this._$maximizeButton=$('<a class="button apply-common-tooltip" title="'+window.t("Maximize Chat")+'" data-role="button" data-name="maximize"></a>').append($(i("ZLE0")).attr({width:8,height:18})).appendTo(this._bridge.$headerspace),this._$maximizeButton.on("click",function(t){r._bridge.toggleMaximize(),t.preventDefault()}),this._bridge.hideDetach||this._$maximizeButton.addClass("button-half"),this._bridge.maximized&&(this._onMaximized=function(t){r._$maximizeButton.toggleClass("active",!!t),r.resizeHeader(),r.resize()},this._bridge.maximized.subscribe(this._onMaximized),this._bridge.maximized.value()&&this._$maximizeButton.addClass("active"))),this._bridge.hideDetach||(this._$detachButton=$('<a class="button apply-common-tooltip svg-detach" title="'+window.t("Detach Chat")+'" data-role="button" data-name="detach"></a>').append($(i("zZbU")).attr({width:10,height:10})).appendTo(this._bridge.$headerspace),
this._$detachButton.on("click touchend",function(t){t.preventDefault(),s.openBoundWindow({roomId:r.currentRoom(),isPrivate:function(){return r.isPrivate()}})}),this._$maximizeButton&&this._$detachButton.addClass("button-half button-nomarginleft")),this.isPrivate()&&(e=this._bridge.isAuthor?window.t("Add/Remove people to this chat"):window.t("See the members of this chat"),this._$addButton=$('<a class="button apply-common-tooltip" id="add-people" title="'+e+'" data-role="button" data-name="add-people">').append($(i("Lmvx")).attr({width:17,height:17})).append($('<span class="msg-window-members-count">').text(r._bridge.membersCount())).prependTo(this._bridge.$headerspace),this._$addButton.on("click",function(t){t.preventDefault(),r._bridge.addPeople()}))),this._$inputWrap=$('<div class="ch-input">').appendTo(this._$widget),this._$progressBarWrap=$('<div class="progress-bar-wrap">').appendTo(this._$inputWrap),this._$progressBar=$('<div class="progress-bar">').appendTo(this._$progressBarWrap),this._$input=$('<div class="wrap">').appendTo(this._$inputWrap),this._$inputDisabledMessage=$('<div class="ch-disabled-message">'+window.t("Please use English for chatting. Check local versions to see if your language is supported.")+".</div>").prependTo(this._$inputWrap),this._$inputSnapshotLink=$('<div class="ch-snapshot-link"><a><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Screenshot preview"></a><i class="icon icon-snapshot-small" title="Chart Snapshot"></i> <a target="_blank">'+window.t("Chart snapshot")+'</a><i class="icon icon-snapshot-delete" title="'+window.t("Delete")+'"></i> </div>').prependTo(this._$inputWrap),this._$inputSnapshotLink.find(".icon-snapshot-delete").on("click",this.attachSnapshot.bind(this)),o={fullBorder:!0,chatSuggestHandler:window.user.chatSuggestHandler,onMouseDownOutside:function(){r._suggesting=!1},onItemSelected:function(t){window.user.chatSuggestHandler.onUserSelect(t.id,t.username,t),r._insertSuggestedUsername(t.username),r._suggesting=!1}},this.isStandalone()?$.extend(o,{$container:this._$inputWrap,reverse:!0,maxItems:5,onShow:function(t){var e=D(r._$inputEdit.get(0),r._$inputEdit.prop("selectionEnd"));t.css("bottom",r._$inputEdit.outerHeight()-e.top+5)}}):(n=r._$widget.width()+2,$.extend(o,{$container:$(document.body),style:{marginTop:8,right:45+n-Math.min(269,n),width:n,maxWidth:269,position:"fixed","z-index":9999},onShow:function(t,e){var i,o;n=r._$widget.width()+2,t.width(r._$widget.width()+2),t.css("right",45+n-Math.min(269,n)+"px"),i=r._$widget.height()+r._bridge.$header.height()-r._$inputEditSizer.outerHeight()+D(r._$inputEdit.get(0),r._$inputEdit.prop("selectionEnd")).top+22,(o=$(window).height()-i<nt)&&(i=$(window).height()-i+18,e.reverse=!0),t.css(o?"top":"bottom",""),t.css(o?"bottom":"top",i)}})),this._usernameHintList=new u(o),this._usernameHintList.visible.subscribe(function(t){t&&(r._suggesting=t)}),this._usernameHintList.emptyMatch.subscribe(null,function(){r._suggesting=!1}),
this._$inputEditSizer=$('<div class="ch-textarea-sizer"></div>').appendTo(this._$input),a=this.isPrivate()?window.t("Type your message here"):window.t("Have something to say?"),this._$inputEdit=$('<textarea class="message-input" autocomplete="off" enterkeyhint="send"></textarea>').keydown(function(t){var e,i;r._suggesting?r._usernameHintList.inputOnKeyDown(t):13!==t.which||r._suggesting||(t.preventDefault(),t.ctrlKey||t.shiftKey?(e=r._$inputEdit.val(),i=r._$inputEdit.prop("selectionStart"),r._$inputEdit.val(e.slice(0,i)+"\n"+e.slice(i)).putCursorAtPosition(i+1).trigger("autosize.resize")):r.post())}),this._$inputEdit.mouseup(function(t){r._trySuggest(r._$inputEdit.val(),r._$inputEdit.prop("selectionStart"),t)}),this._$inputEdit.keyup(function(t){var e=r._$inputEdit.val(),i=r._$inputEdit.prop("selectionStart");r._trySuggest(e,i,t),r.checkInput()}).bind("paste",function(){setTimeout(function(){r.checkInput()},0)}).appendTo(this._$inputEditSizer).autosize({append:""}),this._$inputEdit.on("autosize.resized",function(){var t,e=r._$inputEdit.height();e!==r._header_height&&(t=r._$inputEdit.outerHeight(),r._header_height=e,r._$input.height(t),r.resizeHeader())}),this._$inputEdit.attr("placeholder",a),this._$snapshotButton=$('<span class="ch-snapshot-button" title="'+window.t("Attach chart snapshot")+'"></span>').append($(i("fitB")).attr({width:16,height:13})).on("click",this.attachSnapshot.bind(this)).on("contextmenu",function(t){t.preventDefault()}).appendTo(this._$inputEditSizer),this._$smilesButton=$('<span class="ch-smiles-button" title="'+window.t("Insert emoticon")+'"></span>').append($(i("5Ucj")).attr({width:15,height:14})).on("click",this.showSmilesPopup.bind(this)).on("contextmenu",function(t){t.preventDefault()}).appendTo(this._$inputEditSizer),this._bridge&&this._bridge.getChartWidget&&this._bridge.getChartWidget()||(this._$snapshotButton.hide(),this._$smilesButton.addClass("off-chart")),this._scroll=new k(this._$scrollContainer,this._$data,{vAlignBottom:!0,headerHeight:0}),this._onBridgeVisibleChange=function(t){if(t){if(setTimeout(function(){r._model&&r._model.setActive(t)},1e3),!r.isPrivate()){var e=r._model.room();r._model.setRoom(""),r.updateRoom(e)}}else r._model.setActive(t);t&&r.isPrivate()&&r._model.setMessagesRead(),t&&(r._$inputEdit&&r._$inputEdit.trigger("autosize.resize"),r.resizeHeader(),r._notInitialVisible||(r._scroll.scrollToEnd(),r._notInitialVisible=!0),r.inputEditFocus())},this._bridge.visible.subscribe(this._onBridgeVisibleChange),$(window).on("visibilitychange",function(t,e){e&&r.inputEditBlur()}),this._bridge.visible.value()&&(this._notInitialVisible=!0),this._scroll.scrolltostart.subscribe(this,function(){r._model.isHistoryLoading()||r._isHistoryEnded||r._init_history_loading||r._loadChatHistory()}),is_authenticated&&user&&user.is_moderator&&this.prepareModeratorLayout(),this.sound=new l.ChatSoundControl(this.isPrivate()?"privatemessages.sound":"chat.sound"),this.progressBar=new l.ChatProgressBar(this._$progressBar,200,90,5,[200,200,400]))},s.prototype.prepareModeratorLayout=function(){
this._$warningTemplates=$('<a class="ch-button ch-warning-templates-button" title="'+window.t("Moderators Warning Messages")+'"><i>'+i("SmzL")+"</i></a>").on("click",this.warningTemplatesPopup.bind(this)).insertBefore(this._$inputEditSizer),this._$widget.addClass("moderator-layout"),this._$inputEdit.on("autosize.resized",function(){this._$inputEdit&&this._$warningTemplates.height(this._$inputEdit.height()+2)}.bind(this)),A(this._$warningTemplates,null,{event:"show-popup",hideEvent:"hide-popup",addClass:"ch-popup ch-warning-templates-popup",careRightBorder:!0,viewportSpacing:2,reverse:!0,popupDrift:68})},s.prototype.warningTemplatesPopup=function(t){var e=x().map(function(t){return{title:t.name,action:this.initMessageTypeWarning.bind(this,t.text,t.id)}}.bind(this));e.push({title:window.t("Custom..."),action:this.initMessageTypeWarning.bind(this,"",null)}),e.push({separator:!0}),e.push({title:window.t("Cancel"),action:this.resetMessageType.bind(this)}),$(t.target).trigger("show-popup",[e]),t.stopPropagation()},s.prototype.initMessageTypeWarning=function(t,e){(t=(this._$inputEdit.val()?this._$inputEdit.val()+" ":"")+t)&&this._$inputEdit.val(t).trigger("autosize.resize").putCursorAtEnd(),this._$inputWrap.addClass("custom-message-warning"),setTimeout(function(){this._$warningTemplates.addClass("active")}.bind(this),0),this._messageType="warning",this._warningType=e},s.prototype.resetMessageType=function(t){this._$inputWrap[0].className=this._$inputWrap[0].className.replace(/\bcustom-message-.*?\b/g,""),this._$warningTemplates.removeClass("active"),delete this._messageType,delete this._warningType},s.prototype._showSettingsDialog=function(t,e){return $(t.delegateTarget).hasClass("open")?($(t.delegateTarget).trigger("hide-popup"),!1):(new l.ChatSettingsDialog(this._bridge,function(e,i){$(t.delegateTarget).trigger("show-popup",[e,i])},e||this._model.getRooms()),t.preventDefault(),!1)},s.prototype.editRoom=function(t){i("debi").prototype.showEditRoomDialog.call(this,t)},s.prototype.deleteRoom=function(t){var e=window.t("Are you sure you want to delete room '{0}' ?").format(t.title);P({type:"modal",content:e}).then(function(e){e.actionLoader("yes"),e.on("action:yes",function(e){e.actionLoader("yes","start"),this._model.deleteRoom(t.room_id,function(t){e.actionLoader("yes","stop").close(),t.error&&L({title:window.t("Error"),content:t.error})})}.bind(this)),e.open()}.bind(this))},s.prototype.saveInputText=function(){var t=this._$inputEdit.val().trim();t&&(window.user._chatInputs[this.currentRoom()]=t)},s.prototype.restoreInputText=function(){this.currentRoom()in window.user._chatInputs&&(this._$inputEdit.val(window.user._chatInputs[this.currentRoom()]),this._$inputEdit.trigger("autosize.resize"),delete window.user._chatInputs[this.currentRoom()])},s.prototype.selectChannel=function(t){if(!this._checkRoom(t))throw new Error("Chat room not found");if(this._roomTitle=this.getRoomTitle(t),this._bridge&&this._bridge.properties&&this._bridge.properties.setValue){var e=this._bridge.properties.value()||{};e.room=t,
this._bridge.properties.setValue(e)}this.updateRoom(t)},s.prototype._checkRoom=function(t){return!!(this._model.getRoomById(t)||t.match(/pm_*/)||t.match(/live_*/))},s.prototype.post=function(t){var e,i,o,s=this,n=s._postMeta||{text:""};if(this.checkInput(),!this._inputDisabled)return e=this.currentRoom(),i=this._model.getRoomById(e),s._sheduledSending=function(){var o,a,r=t||s._$inputEdit.val();if(!r&&!n.text)return!1;s._$inputEdit.val("").trigger("autosize.resize"),"snapshot"!==n.type&&r&&s.inputEditFocus(),o={},s._messageType&&(o.messageType=s._messageType,s._warningType&&(o.warningType=s._warningType),s.resetMessageType()),a=(new Date).getTime(),s.progressBar.start(a),s._model.sendMessageToRoom(e,r,n,o,function(t){var e=!(!t.error&&!t.warning),o=t.error||t.warning,h=t.title;e?O({title:t.error?h||window.t("Error"):h||window.t("Warning"),content:o,actions:[{name:"ok",type:"primary",text:window.t("Ok"),method:"close"}]}).then(function(t){t.open(),t.on("destroy",s.inputEditFocus.bind(s)),s.inputEditBlur(),s._$inputEdit.val(r).trigger("autosize.resize"),s.progressBar.finishOnError(a)}):(s.progressBar.finish(a),j(i,r,n))},function(){s.progressBar.finishOnError(a),L({title:window.t("Error"),content:window.t("There was an error posting your message.")}),s._$inputEdit.val(r).trigger("autosize.resize")}),s._postMeta=null,s._$snapshotButton.removeClass("active"),s._$inputSnapshotLink.hide(),s.resizeHeader()},o={source:"Chat post message",sourceMeta:this.getChartWidgetCollection()?"Chart":null,verifiedPhoneRequired:!0,doNotCheckSuspicious:!0,customPhoneCheck:function(t){var e,i,o;return!!s.currentRoom().startsWith("live_")&&(e=new Date(2018,6,18),i=4.5,!(new Date(user.date_joined)<=t)&&(o=!user.has_phone,new Date(user.date_joined)<=e?o:(!tt("check_chat_rep_all_locales")&&"en"!==window.language||!(user.max_user_language_reputation<i))&&o))}},runOrSignIn(function(){s._sheduledSending&&s._sheduledSending(),s._sheduledSending=null},o),!1},s.prototype.resize=function(t){this._scroll.resize(),this._$inputEdit&&this._$inputEdit.trigger("autosize.resize")},s.prototype.updateTitle=function(t){this._bridge&&this._bridge.setTitle&&this._bridge.setTitle(this._roomTitle)},s.prototype.checkInput=function(){var t,e=this._$inputEdit.val(),i=!1;"en"===window.language&&(i=!!(t=this._model.getRoomById(this.currentRoom()))&&!!t.pinned&&!H(e)),this._$inputEdit.toggleClass("disabled",i),this._$inputDisabledMessage.toggle(i),i!==this._inputDisabled&&this.resizeHeader(),this._inputDisabled=i},s.prototype.resizeHeader=function(){this._$scrollContainer.css("bottom",this._$inputWrap.outerHeight()),this._scroll.resize()},s.prototype.getChartWidgetCollection=function(){return this._bridge&&this._bridge.getChartWidgetCollection&&this._bridge.getChartWidgetCollection()},s.prototype.attachSnapshot=function(){var t,e,i=this,o=this.getChartWidgetCollection();if(o)return i._postMeta?(i._postMeta=null,i._$snapshotButton.removeClass("active"),i._$inputSnapshotLink.hide(),i.resizeHeader()):(e={previews:["thumb"],onInvalidSnapshotImage:t=function(){
i._$snapshotButton.removeClass("loading")}},i._$snapshotButton.addClass("loading"),y(o,function(t){var e,o=N.createSnapshotImageUrls(t);i._postMeta={text:window.t("Chart Snapshot"),url:o.url,preview_url:o.preview,type:"snapshot"},i._$snapshotButton.removeClass("loading").addClass("active"),(e=i._$inputSnapshotLink.show().find("a")).attr("href",o.url),K({$elem:e,type:"image",live:!1}),i._$inputSnapshotLink.find("img").attr("src",o.url).on("load",i.resizeHeader.bind(i)),i.inputEditFocus()},t,e)),!1},s.prototype.toggleSnaphotPreview=function(t){this._showSnapshotPreview=void 0!==t?t:!this._showSnapshotPreview,TVSettings.setValue("chat.show_snapshot_preview",this._showSnapshotPreview),this._$widget.toggleClass("show-snapshot-preview",this._showSnapshotPreview),this.resize()},s.prototype.toggleHighlightUserMessages=function(t){var e=t.attr("class").match(/ch-item-user-(\d+)/)[1],i=!t.hasClass("ch-highlight-user");$(".ch-item").removeClass("ch-highlight-user"),e&&i&&this._$data.find(".ch-item-user-"+e).addClass("ch-highlight-user")},s.prototype.destroy=function(){this._isHistoryEnded=!0,this.isPrivate()&&this.saveInputText(),this._sheduledSending&&(this._sheduledSending(),this._sheduledSending=null),this._model.messageReceived().unsubscribe(this,this._onMessageWrapper),this._model.messageDeleted().unsubscribe(this,this._onMessageDeleted),this._model.roomChanged().unsubscribe(this,this._onRoomChanged),this._model.destroy(),this._model=null,window.loginStateChange.unsubscribeAll(this),this._scroll.scrolltostart.unsubscribeAll(this),this._bridge.visible.unsubscribe(this._onBridgeVisibleChange),this._bridge.symbol&&this._onSymbolChanged&&this._bridge.symbol.unsubscribe(this._onSymbolChanged),this._bridge.interval&&this._onIntervalChanged&&this._bridge.interval.unsubscribe(this._onIntervalChanged),this._bridge.height&&this._onResize&&this._bridge.height.unsubscribe(this._onResize),this._bridge.width&&this._onResize&&this._bridge.width.unsubscribe(this._onResize),this._bridge.maximized&&this._onMaximized&&this._bridge.maximized.unsubscribe(this._onMaximized),this.destroyLikesHandlers(),F.jQueryCompatibleDestroy(this._$data),this.sound.destroy(),this._bridge&&this._bridge.$headerspace&&this._bridge.$headerspace.empty(),this._usernameHintList.destroy()},s.prototype.showLinkToChat=function(t){var e=window.location.protocol+"//"+window.location.host+"/chat/#"+t.room_id;X.showCustomDialog({width:300,title:window.t("Link to __room__ chat",{room:TradingView.clean(t.title)}),html:'<form><input type="text" value="'+e+'"/></form>'})},s.openBoundWindow=function(t){var e="";e=t.isPrivate()?"/chat/"+t.roomId+"/":"/chat/#"+t.roomId,w.open({url:e,parameters:{menubar:!1,location:!1,status:!1,directories:!1,width:470,height:600}}),U("GUI","Chat Detached")},s.prototype.toggleMentionsOnly=function(){this._mentionsOnly=!this._mentionsOnly,this._$data.toggleClass("mentions-only"),this._scroll.scrollToEnd(),this._$mentionsButton.toggleClass("active")},s.prototype.showSmilesPopup=function(t){
var e,i,o,s,n,a,r,h,d,c,l,u,p,m,g,_,f,v,y=this,b=$('<div class="ch-smiles-popup">').appendTo(document.body);E.each(function(t){if(t.showInPopUp){var e=$('<div class="emoji-container js-emoji" title="'+t.code+'">');e.data("code",t.code),e.append(E.getElement(t)),e.appendTo(b)}}),b.on("click",".js-emoji",function(t){var e=y._$inputEdit.val(),i=y._$inputEdit.prop("selectionStart"),o=i>0&&" "!==e.charAt(i-1)?" ":"",s=i<e.length&&" "!==e.charAt(i)?" ":"";y.insertAtCursorPosition(o+$(t.target).closest(".js-emoji").data("code")+s),b.remove()}),e=this._$smilesButton.offset(),i=this._$smilesButton.outerWidth(),o=this._$smilesButton.outerHeight(),s=e.top+o/2,n=e.left+i/2,a=10,r=15,h=b.outerHeight(),c="top",l=!0,u=n-(d=b.outerWidth())/2,p=$(document).width(),u+d+a>(m=$(window).width())&&(u=m-(d+a),p-n<a+10&&(l=!1,r=10)),g=s+r,_=$(window).height(),f=$(window).scrollTop(),v=$(window).scrollLeft(),g-f+h+r>_&&(g=s-h-r,c="bottom"),l&&$('<div class="ch-smiles-caret ch-smiles-caret-'+c+'">').css("left",n-u-v).prependTo(b),b.css({left:u+v,top:g}).on("mousedownoutside",function(){b.remove()})},s.prototype.inputEditFocus=function(){Modernizr.mobiletouch||this._noAutoFocus||this._$inputEdit&&this._$inputEdit.focus()},s.prototype.inputEditBlur=function(){this._$inputEdit&&this._$inputEdit.blur()},s.getLaunchInSeparateWindowAction=function(t,e){return{title:window.t("Launch Chat in a Separate Window"),action:function(){s.openBoundWindow({roomId:t,isPrivate:e})}}},s.prototype.destroyLikesHandlers=function(){this._chartLikesHandler&&this._chartLikesHandler.destroy(),this._snapshotMessagesLikesHandler&&this._snapshotMessagesLikesHandler.destroy()},s.prototype.updateLikesHandlers=function(){this.destroyLikesHandlers(),this._chartLikesHandler=l.ChatLikesHandler.getChartsHandler(),this._snapshotMessagesLikesHandler=l.ChatLikesHandler.getMessagesSnapshotsHandler()},t.exports=s}).call(this,i("nbsC"),i("ldgD"))},fitB:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 11.5" width="20" height="16"><path d="M7.5 4.8c-1.1 0-1.9.9-1.9 1.9s.9 1.9 1.9 1.9c1.1 0 1.9-.9 1.9-1.9s-.9-1.9-1.9-1.9zM13 1.9h-2.2c0-1-.9-1.9-2-1.9H6.1C5 0 4.2.9 4.2 1.9H1.9c-1 0-1.9.9-1.9 2v5.7c0 1.1.9 1.9 1.9 1.9H13c1.1 0 1.9-.9 1.9-1.9V3.9c.1-1.1-.8-2-1.9-2zm-5.5 8.3C5.6 10.2 4 8.6 4 6.7s1.5-3.4 3.4-3.4 3.4 1.5 3.4 3.4c.1 1.9-1.4 3.5-3.3 3.5z"/></svg>'},"gCS/":function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 973.125"><path d="M960 832L710.875 582.875C746.438 524.812 768 457.155 768 384 768 171.97 596 0 384 0 171.97 0 0 171.97 0 384c0 212 171.97 384 384 384 73.156 0 140.812-21.562 198.875-57L832 960c17.5 17.5 46.5 17.375 64 0l64-64c17.5-17.5 17.5-46.5 0-64zM384 640c-141.375 0-256-114.625-256-256s114.625-256 256-256 256 114.625 256 256-114.625 256-256 256z"/></svg>'},h6Z7:function(t,e,i){"use strict";(function(t){var o,s;Object.defineProperty(e,"__esModule",{value:!0}),e.showReportModal=function(e,i,n,a,r,h){var d=new s.ReportSendingAgent({username:e,entityType:i,entityURL:n,entityText:a,entityID:r},h)
;return new o.TVModal({title:d.getTitle(),width:600,destroyOnClose:!0,content:t.render('<div class="tv-text"><p>{{{ warningText }}}</p><textarea readonly rows="7" class="tv-control-textarea">{{ text }}</textarea></div>',{warningText:$.t("You can send report to moderators. The __entity__ from __user__ will be checked. If the __entity__ contains anything that violates our __rulesLink__, the __entity__ will be __action__ and its author will be penalized. Please note that if you send false report to moderators, we may apply similar measures to you. Thank you for your help!",{user:"<strong>"+e+"</strong>",rulesLink:'<a href="/house-rules/" target="_blank">'+$.t("House Rules")+"</a>",entity:d.getEntity(),action:d.getAction()}),text:d.getText()}),actions:[{name:"report",type:"danger",text:$.t("Report"),key:13},{name:"cancel",type:"default",text:$.t("Cancel"),method:"close"}]}).on("action:report",function(t){d.send(),t.close()}).open()},o=i("6aJD"),s=i("nmNo")}).call(this,i("nbsC"))},hWl2:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setTabIcon=function(t){$('link[rel="shortcut icon"]').attr("href",t)};e.TAB_ICON_URLS={UNREAD_MESSAGES:"/static/images/favicon/unread_messages/favicon.ico",DEFAULT:"/favicon.ico"}},"ju+4":function(t,e,i){!function(){function e(t,e,n){var a,r,h,d,c,l,u;if(!o)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");return(a=n&&n.debug||!1)&&(r=document.querySelector("#input-textarea-caret-position-mirror-div"))&&r.parentNode.removeChild(r),(h=document.createElement("div")).id="input-textarea-caret-position-mirror-div",document.body.appendChild(h),d=h.style,c=window.getComputedStyle?getComputedStyle(t):t.currentStyle,d.whiteSpace="pre-wrap","INPUT"!==t.nodeName&&(d.wordWrap="break-word"),d.position="absolute",a||(d.visibility="hidden"),i.forEach(function(t){d[t]=c[t]}),s?t.scrollHeight>parseInt(c.height)&&(d.overflowY="scroll"):d.overflow="hidden",h.textContent=t.value.substring(0,e),"INPUT"===t.nodeName&&(h.textContent=h.textContent.replace(/\s/g,"")),(l=document.createElement("span")).textContent=t.value.substring(e)||".",h.appendChild(l),u={top:l.offsetTop+parseInt(c.borderTopWidth),left:l.offsetLeft+parseInt(c.borderLeftWidth)},a?l.style.backgroundColor="#aaa":document.body.removeChild(h),u}var i=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],o="undefined"!=typeof window,s=o&&null!=window.mozInnerScreenX;void 0!==t.exports?t.exports=e:o&&(window.getCaretCoordinates=e)}()},lNJX:function(t,e,i){},mSWa:function(t,e,i){"use strict";(function(t,o,s){function n(e){this.options=e,this.maxItems=e.maxItems||10;var i=this.options.style||{}
;this.$list=$('<div class="tv-username-hint-list js-hidden">').css(i).appendTo(e.$container),this.options.fullBorder&&this.$list.addClass("tv-username-hint-list--full-border"),this._reverse=e.reverse,this._showInactiveUsers=e.showInactiveUsers||!1,this.visible=new t(!1),this.emptyMatch=new o,this.applyHandlers(),this.itemCount=0,this.listPosition=0}var a,r,h;i("1gG9"),a=i("JOqt").debounce,r=i("9tJu").getUserProfilePath,h=i("dTSQ").regExpEscape,n.prototype.applyHandlers=function(){var t=this,e=function(){t.hideList(),t.options.onMouseDownOutside&&t.options.onMouseDownOutside()};this.visible.subscribe(function(i){t.$list&&(i?t.$list.one("mousedownoutside",e):t.$list.off("mousedownoutside",e))}),t.$list.on("click","a.js-user",function(e){e.preventDefault(),t.selectUser($(this).data())}),t.$list.on("mousedown","a.js-user",function(t){t.preventDefault()}),t.$list.on("mouseenter","a.js-user",function(e){var i=$(this);t.$activeListItem.data("id")!==i.data("id")&&(t.$activeListItem.removeClass("i-active"),t.listPosition=i.data("_index"),t.$activeListItem=i,t.$activeListItem.addClass("i-active"))}),t.options.simpleMode?(t.$input=t.options.$input,t.$input.on("keydown",t.inputOnKeyDown.bind(t)).on("keyup",t.inputOnKeyUp.bind(t)),t.getInput=function(){return t.$input.val().trim()}):t.options.textareaMode?(t.$input=t.options.$input,t.$input.on("keydown",t.inputOnKeyDown.bind(t)).on("keyup",t.inputOnKeyUp.bind(t)).on("focus click",function(e){a(function(){t.$input.trigger("keyup")},10)}),t.getInput=t.getQueryFromTextarea):t.getInput=function(){return t._query||""},t.suggestLimit=t.options.suggestLimit||10,t.resultHandler=t.options.onItemSelected,this.options.chatSuggestHandler?t.chatSuggestHandler=this.options.chatSuggestHandler:t.suggestLastUsed=$.noop},n.prototype.inputOnKeyDown=function(t){if(this.visible.value()){switch(t.which||t){case 38:this.$activeListItem.removeClass("i-active"),this.listPosition>1?(this.listPosition--,this.$activeListItem=this.$activeListItem.prev(),this.$activeListItem.addClass("i-active")):this.markLastItemAsActive();break;case 40:this.$activeListItem.removeClass("i-active"),this.listPosition<this.itemCount?(this.listPosition++,this.$activeListItem=this.$activeListItem.next(),this.$activeListItem.addClass("i-active")):this.markFirstItemAsActive()}13!==t.which&&38!==t.which&&40!==t.which||t.preventDefault()}},n.prototype.inputOnKeyUp=function(t){switch(t.which||t){case 38:case 40:break;case 13:this.visible.value()&&(this.listPosition?this.selectUser(this.$activeListItem.data()):this.itemCount&&this.selectUser(this.firstUserData));break;case 27:this.hideList();break;default:this.getSuggestions(this.getInput())}},n.prototype.onInput=function(t,e){"hide"===t&&(t=27),[13,27,38,40].indexOf(t)<0&&(this._query=e),this.inputOnKeyUp(t)},n.prototype.showSuggestions=function(t,e){this._request&&this._request.abort();var i=this;this._request=$.get("/username_hint/",{s:t},e).always(function(){delete i._request})},n.prototype.getSuggestions=function(t){var e,i,o;if(t.length)if(this.chatSuggestHandler){
if("@"===t)return void this.suggestLastUsed();e=t.split("").map(h).join(".*"),i=new RegExp(e,"i"),o=this,this.chatSuggestHandler.getList(function(t){return i.test(t.username)},function(e){e.length>=o.suggestLimit?o.showList(e):o.showSuggestions(t,function(t){var i=e.map(function(t){return t.id});e=e.concat(t.filter(function(t){return i.indexOf(t.id)<0})),o.showList(e)})})}else this.showSuggestions(t,this.showList.bind(this))},n.prototype.suggestLastUsed=function(){this.chatSuggestHandler.getList(null,function(t){"@"===this._query&&this.showList(t)}.bind(this))},n.prototype.showList=function(t){var e,i=this;t=t.filter(function(t){return i.options._showInactiveUsers||!t.inactive}),this.itemCount=Math.min(t.length,this.maxItems),this.itemCount?(this.$list.empty(),this.firstUserData=t[0],e={},this.options.onShow&&(this.options.onShow(this.$list,e),e.reverse&&(this._reverse=!this._reverse)),t=t.slice(0,this.maxItems),this._reverse&&t.reverse(),t.forEach(function(t,e){var i=$(s.render('<a href="{{profileUrl}}" class="js-user tv-username-hint-list__user{{#online}} tv-username-hint-list__user--online{{/online}}"><img src="{{userpic}}"/><span>{{username}}</span></a>',{profileUrl:r(t),username:t.username,online:t.online,userpic:t.userpic}));i.data(t),i.data("_index",e+1),this.$list.append(i)},this),this.$list.removeClass("js-hidden"),this.visible.setValue(!0),this._reverse?this.markLastItemAsActive():this.markFirstItemAsActive(),e.reverse&&(this._reverse=!this._reverse)):(this.hideList(),this.emptyMatch.fire())},n.prototype.markFirstItemAsActive=function(){this.$activeListItem=this.$list.children().first(),this.$activeListItem.addClass("i-active"),this.listPosition=1},n.prototype.markLastItemAsActive=function(){this.$activeListItem=this.$list.children().last(),this.$activeListItem.addClass("i-active"),this.listPosition=this.itemCount},n.prototype.hideList=function(){this._request&&this._request.abort(),this.visible.value()&&(this.visible.setValue(!1),this.$activeListItem=null,this.listPosition=0,this.$list.addClass("js-hidden"))},n.prototype.selectUser=function(t){this.hideList(),this.resultHandler(t)},n.prototype.destroy=function(){this.$list.remove(),delete this.$list},n.prototype.getQueryFromTextarea=function(){var t=this.$input.val(),e=this.$input.prop("selectionStart"),i=t.slice(0,e).lastIndexOf("@",e),o=t.slice(i,e);return"@"===o&&(this._query=o),i<0||i>0&&t[i-1].match(/[\S]+/)||o.search(/\s/)>=0?(this.hideList(),""):o},e.UsernameHintList=n}).call(this,i("hY0g"),i("aIyQ"),i("nbsC"))},"n5P/":function(t,e){
t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="27" height="16"><g fill="none"><rect width="27" height="16" fill="#2196F3" rx="8"/><path stroke="#FFF" stroke-linejoin="round" d="M8.5 3.5h6a2 2 0 0 1 2 2v1l4-2v7l-4-2v1a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2z"/><path fill="#FFF" fill-rule="nonzero" d="M20 5.309l-3.276 1.638A.5.5 0 0 1 16 6.5v-1A1.5 1.5 0 0 0 14.5 4h-6A1.5 1.5 0 0 0 7 5.5v5A1.5 1.5 0 0 0 8.5 12h6a1.5 1.5 0 0 0 1.5-1.5v-1a.5.5 0 0 1 .724-.447L20 10.69V5.309zM17 10.5a2.5 2.5 0 0 1-2.5 2.5h-6A2.5 2.5 0 0 1 6 10.5v-5A2.5 2.5 0 0 1 8.5 3h6A2.5 2.5 0 0 1 17 5.5v.191l3.276-1.638A.5.5 0 0 1 21 4.5v7a.5.5 0 0 1-.724.447L17 10.31v.191z"/></g></svg>'},nmNo:function(t,e,i){"use strict";var o,s;i.r(e),i.d(e,"ReportSendingAgent",function(){return s}),i("YFKU"),i("HbRj"),o=i("Gvuy"),s=function(){function t(t,e){switch(void 0===e&&(e={}),this._fullURL=window.location.protocol+"//"+window.location.host,this._data=t,this._options=e,t.entityType){case"message":this._entityString=$.t("message"),this._actionString=$.t("removed"),this._fullURL+="/chat/m/"+t.entityURL+"/";break;case"comment":this._entityString=$.t("comment"),this._actionString=$.t("removed"),this._fullURL+=t.entityURL+"#tc"+t.entityID;break;case"idea":this._entityString=$.t("idea"),this._actionString=$.t("hidden"),this._fullURL+=t.entityURL;break;case"script":this._entityString=$.t("script"),this._actionString=$.t("hidden"),this._fullURL+=t.entityURL;break;case"stream":this._entityString=$.t("stream"),this._actionString=$.t("hidden"),this._fullURL+=t.entityURL}}return t.prototype.send=function(){var t,e={report_type:this._data.entityType,text:""};this._options.chartId&&(e.chart_id=this._options.chartId),t={is_report:!0,meta:JSON.stringify(e),text:this.getText()},$.post("/conversation-post/",t).done(function(t){t&&t.error&&Object(o.showErrorDialog)({title:"Error",content:t.error,btnType:"danger"})})},t.prototype.getTitle=function(){return $.t("Report {0} from {1} to moderators").format(this._entityString,"<strong>"+this._data.username+"</strong>")},t.prototype.getText=function(){var t=$.t("Reported {0} from @{1}, {2}").format(this._entityString,this._data.username,this._fullURL);return this._options.additionalText&&(t+="\n"+this._options.additionalText),this._data.entityText&&(t+="\n\n"+this._data.entityText),t},t.prototype.getEntity=function(){return this._entityString},t.prototype.getAction=function(){return this._actionString},t}()},oHcy:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 34 34" width="34px" height="34px"><path d="M21.197 2.06c-7.07 0-12.8 5.83-12.8 13.027 0 7.14 5.644 12.934 12.638 13.024v5.545l8.747-8.902A13.208 13.208 0 0 0 34 15.03C34 7.832 28.267 2 21.197 2zM10.463 27.674v-1.58l-1.275-.017c-3.642-.046-6.606-3.1-6.606-6.806 0-3.052 1.986-5.643 4.71-6.504.16-.984.417-1.935.764-2.844C3.518 10.52 0 14.45 0 19.246c0 4.7 3.433 8.64 7.88 9.33V34l6.377-6.49a14.307 14.307 0 0 1-2.146-1.533l-1.643 1.674z"/></svg>'},oNDq:function(t,e,i){"use strict";function o(t){return new Promise(function(e){
Promise.all([i.e("vendors_embed"),i.e("dialogs-core"),i.e(0),i.e(1),i.e(3),i.e(5),i.e(7),i.e(8),i.e(6),i.e(160),i.e("create-dialog")]).then(function(o){var n=i("YDhE").createDialog;e(n(Object(s.__assign)(Object(s.__assign)({},r),t)))}.bind(null,i)).catch(void 0)})}var s,n,a,r;i.r(e),i.d(e,"createConfirmDialog",function(){return o}),s=i("mrSG"),i("YFKU"),n={key:13,name:"yes",text:window.t("Yes"),type:"success"},a={method:"close",name:"no",text:window.t("No"),type:"default"},r={actions:[n,a],actionsWrapTemplate:'<div class="tv-dialog__section tv-dialog__section--actions tv-dialog__section--no-border">',content:window.t("Are you sure?"),contentWrapTemplate:'<div class="tv-dialog__section tv-dialog__section--no-border"><div class="tv-text"><p></p></div></div>',destroyOnClose:!0,title:window.t("Confirmation"),width:400,dataset:{"dialog-type":"confirm-dialog"}}},poeh:function(t,e,i){"use strict";t.exports.pushChartPage=function(t){Promise.all([i.e("dialogs-core"),i.e(0),i.e(1),i.e(7),i.e(6),i.e("history-manager")]).then(function(e){var o=i("L5wN"),s=new o.ChartPage(t);TradingView.historyManager.push(s)}.bind(null,i)).catch(i.oe)}},tWVy:function(t,e,i){"use strict";function o(){n.fire()}var s,n;i.d(e,"a",function(){return n}),i.d(e,"b",function(){return o}),s=i("aIyQ"),n=new(i.n(s).a)},tvXG:function(t,e,i){"use strict";var o,s,n;Object.defineProperty(e,"__esModule",{value:!0}),o=Object.assign||function(t){var e,i,o;for(e=1;e<arguments.length;e++)for(o in i=arguments[e])Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);return t},e.createPromptDialog=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.createDialog)(o({},n,t)).on("action:submit",function(t){return t.trigger("submit",[t,t.$el.find("input").val()])})},s=i("YDhE"),n={width:400,destroyOnClose:!0,title:$.t("Enter the value"),content:'<input class="tv-control-input" name="value">',actionsWrapTemplate:'<div class="tv-dialog__section tv-dialog__section--actions tv-dialog__section--no-border">',actions:[{name:"submit",type:"success",text:$.t("Ok"),key:13},{name:"cancel",type:"default",text:$.t("Cancel"),method:"close"}],dataset:{"dialog-type":"prompt-dialog"}}},u4eC:function(t,e){!function(e){"use strict";function i(t,e,i,n){var a=e&&e.prototype instanceof s?e:s,r=Object.create(a.prototype),h=new u(n||[]);return r._invoke=function(t,e,i){var s=_;return function(n,a){var r,h,c;if(s===v)throw new Error("Generator is already running");if(s===y){if("throw"===n)throw a;return m()}for(i.method=n,i.arg=a;;){if((r=i.delegate)&&(h=d(r,i))){if(h===b)continue;return h}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(s===_)throw s=y,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);if(s=v,"normal"===(c=o(t,e,i)).type){if(s=i.done?y:f,c.arg===b)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(s=y,i.method="throw",i.arg=c.arg)}}}(t,i,h),r}function o(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}function s(){}function n(){}function a(){}
function r(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function h(t){var e;this._invoke=function(i,s){function n(){return new Promise(function(e,n){!function e(i,s,n,a){var r,h,d=o(t[i],t,s);if("throw"!==d.type)return(h=(r=d.arg).value)&&"object"==typeof h&&M.call(h,"__await")?Promise.resolve(h.__await).then(function(t){e("next",t,n,a)},function(t){e("throw",t,n,a)}):Promise.resolve(h).then(function(t){r.value=t,n(r)},a);a(d.arg)}(i,s,e,n)})}return e=e?e.then(n,n):n()}}function d(t,e){var i,s,n=t.iterator[e.method];if(n===g){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=g,d(t,e),"throw"===e.method))return b;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return b}return"throw"===(i=o(n,t.iterator,e.arg)).type?(e.method="throw",e.arg=i.arg,e.delegate=null,b):(s=i.arg)?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=g),e.delegate=null,b):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,b)}function c(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function l(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function u(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(c,this),this.reset(!0)}function p(t){var e,i,o;if(t){if(e=t[T])return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return i=-1,(o=function e(){for(;++i<t.length;)if(M.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=g,e.done=!0,e}).next=o}return{next:m}}function m(){return{value:g,done:!0}}var g,_,f,v,y,b,w,$,R,C,S=Object.prototype,M=S.hasOwnProperty,x="function"==typeof Symbol?Symbol:{},T=x.iterator||"@@iterator",I=x.asyncIterator||"@@asyncIterator",k=x.toStringTag||"@@toStringTag",A="object"==typeof t,E=e.regeneratorRuntime;E?A&&(t.exports=E):((E=e.regeneratorRuntime=A?t.exports:{}).wrap=i,_="suspendedStart",f="suspendedYield",v="executing",y="completed",b={},(w={})[T]=function(){return this},(R=($=Object.getPrototypeOf)&&$($(p([]))))&&R!==S&&M.call(R,T)&&(w=R),C=a.prototype=s.prototype=Object.create(w),n.prototype=C.constructor=a,a.constructor=n,a[k]=n.displayName="GeneratorFunction",E.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))},E.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,a):(t.__proto__=a,k in t||(t[k]="GeneratorFunction")),t.prototype=Object.create(C),t},E.awrap=function(t){return{__await:t}},r(h.prototype),h.prototype[I]=function(){return this},E.AsyncIterator=h,E.async=function(t,e,o,s){var n=new h(i(t,e,o,s));return E.isGeneratorFunction(e)?n:n.next().then(function(t){return t.done?t.value:n.next()})},r(C),C[k]="Generator",C[T]=function(){return this},C.toString=function(){return"[object Generator]"},E.keys=function(t){var e,i=[];for(e in t)i.push(e);return i.reverse(),function e(){for(;i.length;){
var o=i.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},E.values=p,u.prototype={constructor:u,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(l),!t)for(var e in this)"t"===e.charAt(0)&&M.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=g)},stop:function(){var t;if(this.done=!0,"throw"===(t=this.tryEntries[0].completion).type)throw t.arg;return this.rval},dispatchException:function(t){function e(e,o){return n.type="throw",n.arg=t,i.next=e,o&&(i.method="next",i.arg=g),!!o}var i,o,s,n,a,r;if(this.done)throw t;for(i=this,o=this.tryEntries.length-1;o>=0;--o){if(s=this.tryEntries[o],n=s.completion,"root"===s.tryLoc)return e("end");if(s.tryLoc<=this.prev)if(a=M.call(s,"catchLoc"),r=M.call(s,"finallyLoc"),a&&r){if(this.prev<s.catchLoc)return e(s.catchLoc,!0);if(this.prev<s.finallyLoc)return e(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return e(s.catchLoc,!0)}else{if(!r)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return e(s.finallyLoc)}}},abrupt:function(t,e){var i,o,s,n;for(i=this.tryEntries.length-1;i>=0;--i)if((o=this.tryEntries[i]).tryLoc<=this.prev&&M.call(o,"finallyLoc")&&this.prev<o.finallyLoc){s=o;break}return s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null),(n=s?s.completion:{}).type=t,n.arg=e,s?(this.method="next",this.next=s.finallyLoc,b):this.complete(n)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){var e,i;for(e=this.tryEntries.length-1;e>=0;--e)if((i=this.tryEntries[e]).finallyLoc===t)return this.complete(i.completion,i.afterLoc),l(i),b},catch:function(t){var e,i,o,s;for(e=this.tryEntries.length-1;e>=0;--e)if((i=this.tryEntries[e]).tryLoc===t)return"throw"===(o=i.completion).type&&(s=o.arg,l(i)),s;throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:p(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=g),b}})}(function(){return this}()||Function("return this")())},uafl:function(t,e){
t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="evenodd"><path fill-rule="nonzero" d="M14 17a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0-1a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/><path d="M5.005 16A1.003 1.003 0 0 1 4 14.992v-1.984A.998.998 0 0 1 5 12h1.252a7.87 7.87 0 0 1 .853-2.06l-.919-.925c-.356-.397-.348-1 .03-1.379l1.42-1.42a1 1 0 0 1 1.416.007l.889.882A7.96 7.96 0 0 1 12 6.253V5c0-.514.46-1 1-1h2c.557 0 1 .44 1 1v1.253a7.96 7.96 0 0 1 2.06.852l.888-.882a1 1 0 0 1 1.416-.006l1.42 1.42a.999.999 0 0 1 .029 1.377s-.4.406-.918.926a7.87 7.87 0 0 1 .853 2.06H23c.557 0 1 .447 1 1.008v1.984A.998.998 0 0 1 23 16h-1.252a7.87 7.87 0 0 1-.853 2.06l.882.888a1 1 0 0 1 .006 1.416l-1.42 1.42a1 1 0 0 1-1.415-.007l-.889-.882a7.96 7.96 0 0 1-2.059.852v1.248c0 .56-.45 1.005-1.008 1.005h-1.984A1.004 1.004 0 0 1 12 22.995v-1.248a7.96 7.96 0 0 1-2.06-.852l-.888.882a1 1 0 0 1-1.416.006l-1.42-1.42a1 1 0 0 1 .007-1.415l.882-.888A7.87 7.87 0 0 1 6.252 16H5.005zm3.378-6.193l-.227.34A6.884 6.884 0 0 0 7.14 12.6l-.082.4H5.005C5.002 13 5 13.664 5 14.992c0 .005.686.008 2.058.008l.082.4c.18.883.52 1.71 1.016 2.453l.227.34-1.45 1.46c-.004.003.466.477 1.41 1.422l1.464-1.458.34.227a6.959 6.959 0 0 0 2.454 1.016l.399.083v2.052c0 .003.664.005 1.992.005.005 0 .008-.686.008-2.057l.399-.083a6.959 6.959 0 0 0 2.454-1.016l.34-.227 1.46 1.45c.003.004.477-.466 1.422-1.41l-1.458-1.464.227-.34A6.884 6.884 0 0 0 20.86 15.4l.082-.4h2.053c.003 0 .005-.664.005-1.992 0-.005-.686-.008-2.058-.008l-.082-.4a6.884 6.884 0 0 0-1.016-2.453l-.227-.34 1.376-1.384.081-.082-1.416-1.416-1.465 1.458-.34-.227a6.959 6.959 0 0 0-2.454-1.016L15 7.057V5c0-.003-.664-.003-1.992 0-.005 0-.008.686-.008 2.057l-.399.083a6.959 6.959 0 0 0-2.454 1.016l-.34.227-1.46-1.45c-.003-.004-.477.466-1.421 1.408l1.457 1.466z"/></g></svg>'},wGB7:function(t,e,i){},xict:function(t,e,i){"use strict";var o;i.r(e),o=i("P5fv"),jQuery.fn.putCursorAtEnd=function(){return this.each(function(){if($(this).focus(),this.setSelectionRange){var t=2*$(this).val().length;this.setSelectionRange(t,t)}else $(this).val($(this).val());this.scrollTop=999999})},jQuery.fn.putCursorAtPosition=function(t){return this.each(function(){$(this).focus(),this.setSelectionRange&&this.setSelectionRange(t,t)})}},yr01:function(t,e){
t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 670 745"><path d="M417.91 738.04c-118.64-22.82-190.57-47.072-218.92-73.807-22.734-21.44-24.27-32.633-24.27-176.81 0-88.1 1.86-140.31 5.373-150.86 11.138-33.44 36.66-57.735 133.93-127.5 67.296-48.267 90.59-69.93 140.55-130.72C509.177 11.903 521.965.078 539.24.046c16.013-.03 25.43 13.07 32.622 45.373 7.83 35.164-3.512 82.774-30.952 129.93-40.764 70.052-39.008 75.19 31.705 92.733 49.08 12.178 81.767 30 91.884 50.097 8.98 17.844 7.335 39.84-7.633 102.04-7.523 31.264-15.156 66.454-16.962 78.203-1.806 11.748-11.588 46.504-21.738 77.236s-18.454 58.25-18.454 61.152c0 8.677-33.212 71.96-44.153 84.13-22.217 24.715-68.287 30.435-137.65 17.093zm-345.68-25.9c-5.722-2.5-22.273-14.2-36.78-26.03-14.506-11.88-28.418-21.59-30.914-21.59-2.82 0-4.538-65.6-4.538-173.26 0-95.29 1.752-173.25 3.893-173.25 2.144 0 17.104-11.498 33.248-25.552 30.614-26.65 49.608-34.114 68.466-26.907 16.703 6.386 18.065 16.296 7.704 56.06-8.34 32-9.423 51.51-9.423 169.55 0 131.23.62 138.49 16.636 194.72 5.75 20.178-24.144 36.41-48.29 26.22z"/></svg>'},zDbI:function(t,e,i){"use strict";var o,s,n,a;i.r(e),i.d(e,"CHART_FONT_FAMILY",function(){return a}),o=i("qFKp"),s="'Trebuchet MS', Roboto, Ubuntu, sans-serif",n="system-ui, -apple-system",a=Object(o.isOnMobileAppPage)("old")?n:s},zRdu:function(t,e,i){"use strict";var o;i.d(e,"a",function(){return o}),function(t){t[t.Separator=0]="Separator",t[t.Action=1]="Action",t[t.ActionAsync=2]="ActionAsync"}(o||(o={}))},zZbU:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 586.09999 586.09996" width="586.1" height="586.1" enable-background="new 0 0 595.3 841.9"><path d="M0 586.1h117.2l351.7-351.7 117.2 117.3V0H234.4l117.3 117.2L0 468.9z"/></svg>'}}]);