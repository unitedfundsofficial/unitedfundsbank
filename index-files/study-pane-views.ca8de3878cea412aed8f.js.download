(window.webpackJsonp=window.webpackJsonp||[]).push([["study-pane-views"],{"0HiO":function(t,e,i){"use strict";function r(t,e,i,r,n,s){var l,d,h,c;return Object(a.equalPoints)(t,e)?[t,e]:(l=new a.Point(0,0),d=new a.Point(i,r),n&&(h=t.subtract(e),(c=Object(o.intersectRayAndBox)(t,t.add(h),Object(a.box)(l,d)))?t=c:e=new a.Point(i,e.y)),s&&(h=e.subtract(t),e=(c=Object(o.intersectRayAndBox)(e,e.add(h),Object(a.box)(l,d)))||new a.Point(i,e.y)),[t,e])}var n,a,o,s,l,d,h,c;i.r(e),i.d(e,"TrendChannelPaneView",function(){return c}),n=i("Eyy1"),a=i("aO4+"),o=i("hBTJ"),s=i("VdBB"),l=i("Zy3/"),d=i("8Uy/"),h=i("BCbF"),c=function(){function t(t,e,i){this._data=[],this._invalidated=!0,this._provider=t,this._model=e,this._data=[],this._hitTestResult=void 0!==i?new s.HitTestResult(s.HitTestResult.CUSTOM,i):new s.HitTestResult(s.HitTestResult.REGULAR)}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,r,n;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new l.CompositeRenderer,e=0,i=this._data;e<i.length;e++)r=i[e],(n=new h.PolygonRenderer(this._hitTestResult)).setData(r),t.append(n);return t},t.prototype._updateViewInternal=function(){var t,e,i,o,s,l,h,c=this;this._data=[],t=this._provider.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||0!==(i=this._provider.graphics().trendchannels()).size&&null!==(o=this._model.timeScale().visibleBarsStrictRange())&&null!==(s=this._provider.firstValue())&&(l=o.firstBar(),h=o.lastBar(),i.forEach(function(i,o){var u=c._provider.properties().graphics.trendchannels[o];i.forEach(function(i){var o,p,f,_,v,y,w,g,x,T,m,b,R=i.startIndex,S=i.endIndex;Math.max(R,S)<l&&!i.extendRight||Math.min(R,S)>h&&!i.extendLeft||(o=t.priceToCoordinate(Object(n.ensureDefined)(i.startHighPrice),s),p=t.priceToCoordinate(Object(n.ensureDefined)(i.startLowPrice),s),_=(f=t.priceToCoordinate(Object(n.ensureDefined)(i.endHighPrice),s))-(o-p),v=e.indexToCoordinate(R),y=e.indexToCoordinate(S),g=(w=r(new a.Point(v,o),new a.Point(y,f),e.width(),t.height(),i.extendLeft,i.extendRight))[0],x=w[1],m=(T=r(new a.Point(v,p),new a.Point(y,_),e.width(),t.height(),i.extendLeft,i.extendRight))[0],b=T[1],c._data.push({points:[g,m,b,x],color:u.color.value(),backcolor:u.color.value(),linewidth:void 0!==u.borderWidth?u.borderWidth.value():0,linestyle:d.LINESTYLE_SOLID,filled:!0,fillBackground:!0,transparency:i.transparency?Math.min(i.transparency+u.transparency.value(),100):u.transparency.value(),mouseTouchable:!0}))})}))},t}()},"1sos":function(t,e,i){"use strict";var r,n,a,o,s;i.r(e),i.d(e,"HorizLinePaneView",function(){return s}),r=i("Eyy1"),n=i("VdBB"),a=i("Zy3/"),o=i("l4sv"),s=function(){function t(t,e,i){this._data=[],this._invalidated=!0,this._provider=t,this._model=e,this._hitTestResult=void 0!==i?new n.HitTestResult(n.HitTestResult.CUSTOM,i):new n.HitTestResult(n.HitTestResult.REGULAR)}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,r,n;for(this._invalidated&&(this._updateViewInternal(),
this._invalidated=!1),t=new a.CompositeRenderer,e=0,i=this._data;e<i.length;e++)r=i[e],(n=new o.HorizontalLineRenderer).setData(r),n.setHitTest(this._hitTestResult),t.append(n);return t},t.prototype._updateViewInternal=function(){var t,e,i,n,a,o,s,l=this;this._data=[],t=this._provider.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||0!==(i=this._provider.graphics().horizlines()).size&&null!==(n=this._model.timeScale().visibleBarsStrictRange())&&null!==(a=this._provider.firstValue())&&(o=n.firstBar(),s=n.lastBar(),i.forEach(function(i,n){var d=l._provider.properties().graphics.horizlines[n];d.visible.value()&&i.forEach(function(i){var n=i.startIndex,h=i.endIndex;!i.extendRight&&Math.max(n,h)<o||!i.extendLeft&&Math.min(n,h)>s||l._data.push({y:t.priceToCoordinate(Object(r.ensureDefined)(i.level),a),left:i.extendLeft?void 0:e.indexToCoordinate(n),right:i.extendRight?void 0:e.indexToCoordinate(h),width:e.width(),height:t.height(),color:d.color.value(),linewidth:d.width.value(),linestyle:d.style.value()})})}))},t}()},"292E":function(t,e,i){"use strict";function r(t){if("up"===t)return 1;if("down"===t)return-1;throw new Error(t+" is not supported by TriangleTextMarkRenderer")}var n,a,o,s,l,d,h,c,u,p,f,_,v,y,w;i.r(e),n=i("mrSG"),a=i("Eyy1"),o=i("aO4+"),s=i("972a"),l=i("nInm"),d=i("Zy3/"),h=i("f6yo"),c=i("VdBB"),u=i("ikwP"),p=function(){function t(t,e){this._data=t,this._textCache=e}return t.prototype.draw=function(t,e){var i,n,a,o,s,l,d,h,c=this;this._data&&(i=r(this._data.direction),n=this._data.point.x,"left"===this._data.halign?n-=this._data.size:"right"===this._data.halign&&(n+=this._data.size),a=this._data.point.y,t.font=this._fontStyle(),o=t.measureText(this._data.text).width,this._textCache.textWidth=o,s=this._data.fontSize,l=Object(u.calcTextHorizontalShift)(t,o),d=.65*s,h=1*s,Object(u.drawScaled)(t,e.pixelRatio,function(){t.translate(n,a),t.beginPath(),t.moveTo(0,0),t.lineTo(d,h*i),t.lineTo(.5*o+d,h*i),t.lineTo(.5*o+d,(h+1.75*s)*i),t.lineTo(.5*-o-d,(h+1.75*s)*i),t.lineTo(.5*-o-d,h*i),t.lineTo(-d,h*i),t.lineTo(0,0),t.strokeStyle=c._data.borderColor,t.stroke(),t.fillStyle=c._data.color,t.fill(),t.fillStyle=c._data.fontColor,t.fillText(c._data.text,.5*-o+l,i<0?i*h-.5*s:h+1.25*s)}))},t.prototype.hitTest=function(t){var e,i,n,a,s,l,d,u,p=this._textCache.textWidth||0,f=this._data.fontSize,_=r(this._data.direction),v=.65*f,y=1*f,w=this._data.point.x;return"left"===this._data.halign?w-=this._data.size:"right"===this._data.halign&&(w+=this._data.size),i=w-.5*p-v,n=w+.5*p+v,(s=(e=this._data.point.y)+(y+1.75*f)*_)<(a=e+y*_)&&(l=a,a=s,s=l),Object(h.pointInBox)(t,Object(o.box)(new o.Point(i,a),new o.Point(n,s)))?new c.HitTestResult(c.HitTestResult.REGULAR):(d=[new o.Point(this._data.point.x,this._data.point.y),new o.Point(this._data.point.x+.65*f,this._data.point.y+f*_),new o.Point(this._data.point.x-.65*f,this._data.point.y+f*_)],u=(t.x-d[0].x)*(d[1].y-d[0].y)-(t.y-d[0].y)*(d[1].x-d[0].x),
((t.x-d[1].x)*(d[2].y-d[1].y)-(t.y-d[1].y)*(d[2].x-d[1].x))*u>0&&((t.x-d[2].x)*(d[0].y-d[2].y)-(t.y-d[2].y)*(d[0].x-d[2].x))*u>0?new c.HitTestResult(c.HitTestResult.REGULAR):null)},t.prototype._fontStyle=function(){return(this._data.bold?"bold ":"")+(this._data.italic?"italic ":"")+this._data.fontSize+"px "+this._data.font},t}(),f=function(){function t(t,e){this._data=t,this._textCache=e}return t.prototype.draw=function(t,e){var i,r=this,n=this._data.point.x,a=this._data.point.y;t.font=this._fontStyle(),i=t.measureText(this._data.text).width,this._textCache.textWidth=i,Object(u.drawScaled)(t,e.pixelRatio,function(){switch(t.translate(n,a),t.beginPath(),t.moveTo(0,0),t.textAlign=r._data.halign,r._data.valign){case"middle":t.textBaseline="middle";break;case"top":t.textBaseline="bottom";break;case"bottom":t.textBaseline="hanging"}t.fillStyle=r._data.fontColor,t.fillText(r._data.text,0,0)})},t.prototype.hitTest=function(t){var e,i,r=this._data.point.x,n=this._data.point.y,a=this._textCache.textWidth||0,s=this._data.fontSize;switch(this._data.halign){case"right":r-=a;break;case"center":r-=a/2}switch(this._data.valign){case"middle":n-=s/2;break;case"bottom":n-=s}return e=new o.Point(r,n),i=new o.Point(r+a,n+s),Object(h.pointInBox)(t,Object(o.box)(e,i))?new c.HitTestResult(c.HitTestResult.REGULAR):null},t.prototype._fontStyle=function(){return(this._data.bold?"bold ":"")+(this._data.italic?"italic ":"")+this._data.fontSize+"px "+this._data.font},t}(),_=i("tSCe"),v=i.n(_),y=i("Tmoa"),i.d(e,"TextMarkPaneView",function(){return w}),w=function(t){function e(e,i,r){var n=t.call(this)||this;return n._data=[],n._textCache=[],n._invalidated=!0,n._provider=e,n._model=i,n._data=[],n._textCache=[],n}return Object(n.__extends)(e,t),e.prototype.update=function(){this._invalidated=!0},e.prototype.renderer=function(){var t,e,i,r;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new d.CompositeRenderer,e=0;e<this._data.length;e++)switch(i=this._data[e],r=this._textCache[e],i.shape){case"triangle":t.append(new p(i,r));break;case"rectangle":t.append(new f(i,r))}return t},e.prototype._updateViewInternal=function(){var t,e,i,r,a,s,d,h=this;this._data=[],t=this._provider.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||0!==(i=this._provider.graphics().textmarks()).size&&null!==(r=this._model.timeScale().visibleBarsStrictRange())&&null!==(a=this._provider.firstValue())&&(s=r.firstBar(),d=r.lastBar(),i.forEach(function(i,r){var c=h._provider.properties().graphics.textmarks[r];c.visible.value()&&i.forEach(function(i){var r,u,p,f,_,v,w,g,x,T=i.time;if(!(T<s||d<T)&&null!==h._provider.series().bars().valueAt(T)){switch(T=i.time+(i.offset||0),r={text:i.text?i.text:"",bold:c.fontBold.value(),italic:c.fontItalic.value(),font:c.fontFamily.value(),fontColor:Object(y.generateColor)(c.fontColor.value(),c.transparency.value()),fontSize:c.fontSize.value()},u=c.location.value(),f=50,p=c.shape.value()){case l.a.Triangle:v=(_=h._calcCoordsForTriangleShape(u,T,f,i.price,a,t,e)).x,w=_.y,g=_.direction,
h._data.push(Object(n.__assign)({shape:p,color:Object(y.generateColor)(c.color.value(),c.transparency.value()),borderColor:"rgb(0, 0, 0)",direction:g,point:new o.Point(v,w),halign:c.halign.value(),size:.5*e.barSpacing()},r));break;case l.a.Rectangle:v=(x=h._calcCoordsForRectangleShape(u,T,i.price,a,t,e)).x,w=x.y,h._data.push(Object(n.__assign)({shape:p,point:new o.Point(v,w),halign:c.halign.value(),valign:void 0!==c.valign?c.valign.value():"middle"},r))}h._textCache.push({})}})}))},e.prototype._calcCoordsForTriangleShape=function(t,e,i,r,n,o,l){var d=Math.round(l.indexToCoordinate(e));switch(t){case s.MarkLocation.Top:return{x:d,y:o.height()-i,direction:"down"};case s.MarkLocation.Bottom:return{x:d,y:i,direction:"up"};case s.MarkLocation.AbsoluteDown:return{x:d,y:o.priceToCoordinate(Object(a.ensureDefined)(r),n),direction:"down"};case s.MarkLocation.AbsoluteUp:return{x:d,y:o.priceToCoordinate(Object(a.ensureDefined)(r),n),direction:"up"};case s.MarkLocation.AboveBar:return{x:d,y:this._locationToY(t,e),direction:"down"};case s.MarkLocation.BelowBar:default:return{x:d,y:this._locationToY(t,e),direction:"up"}}},e.prototype._calcCoordsForRectangleShape=function(t,e,i,r,n,o){var l=Math.round(o.indexToCoordinate(e));switch(t){case s.MarkLocation.AbsoluteDown:case s.MarkLocation.AbsoluteUp:case s.MarkLocation.Absolute:return{x:l,y:n.priceToCoordinate(Object(a.ensureDefined)(i),r)};case s.MarkLocation.AboveBar:case s.MarkLocation.BelowBar:return{x:l,y:this._locationToY(t,e)};case s.MarkLocation.Right:case s.MarkLocation.Left:return{x:o.width(),y:n.priceToCoordinate(Object(a.ensureDefined)(i),r)};default:return{x:l,y:this._locationToY(t,e)}}},e}(v.a)},"3zbQ":function(t,e,i){"use strict";var r,n,a,o,s,l,d,h,c;i.r(e),i.d(e,"LevelPaneView",function(){return c}),r=i("Eyy1"),n=i("aO4+"),a=i("VdBB"),o=i("VSsv"),s=i("Zy3/"),l=i("l4sv"),d=i("qgcf"),h=i("zDbI"),c=function(){function t(t,e,i){this._data=[],this._textData=[],this._invalidated=!0,this._provider=t,this._model=e}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,r,n,o,h,c;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new s.CompositeRenderer,e=0,i=this._data;e<i.length;e++)r=i[e],(n=new l.HorizontalLineRenderer).setData(r),t.append(n);for(o=0,h=this._textData;o<h.length;o++)c=h[o],t.append(new d.TextRenderer(c,new a.HitTestResult(a.HitTestResult.REGULAR)));return t},t.prototype._updateViewInternal=function(){this._calcHorzLinesData(),this._calcTextData()},t.prototype._calcTextData=function(){var t,e,i,a,s=this;this._textData=[],t=this._provider.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||0!==(i=this._provider.graphics().hlines()).size&&null!==(a=this._provider.firstValue())&&i.forEach(function(i,l){var d=s._provider.properties().graphics.hlines[l];d.enableText.value()&&d.showText.value()&&i.forEach(function(i){var l=t.priceToCoordinate(Object(r.ensureDefined)(i.level),a),c=d.textPos.value(),u=function(t,e){
if(t===o.a.TopLeft||t===o.a.MiddleLeft||t===o.a.BottomLeft)return["left",4];if(t===o.a.TopCenter||t===o.a.MiddleCenter||t===o.a.BottomCenter)return["center",e/2];if(t===o.a.TopRight||t===o.a.MiddleRight||t===o.a.BottomRight)return["right",e];throw new Error("Unsupported TextPos value")}(c,e.width()),p=u[0],f=u[1],_=function(t,e){if(t===o.a.TopLeft||t===o.a.TopCenter||t===o.a.TopRight)return["bottom",e-4];if(t===o.a.MiddleLeft||t===o.a.MiddleCenter||t===o.a.MiddleRight)return["middle",e-2];if(t===o.a.BottomLeft||t===o.a.BottomCenter||t===o.a.BottomRight)return["top",e];throw new Error("Unsupported TextPos value")}(c,l),v=_[0],y=_[1];s._textData.push({points:[new n.Point(f,y)],offsetX:0,offsetY:0,text:i.text||"",color:d.color.value(),font:h.CHART_FONT_FAMILY,fontsize:d.fontSize.value(),horzAlign:p,vertAlign:v})})})},t.prototype._calcHorzLinesData=function(){var t,e,i,n,a=this;this._data=[],t=this._provider.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||0!==(i=this._provider.graphics().hlines()).size&&null!==(n=this._provider.firstValue())&&i.forEach(function(i,o){var s=a._provider.properties().graphics.hlines[o];s.visible.value()&&i.forEach(function(i){var o=t.priceToCoordinate(Object(r.ensureDefined)(i.level),n);a._data.push({visible:!0,y:o,width:e.width(),height:t.height(),color:s.color.value(),linewidth:s.width.value(),linestyle:s.style.value()})})})},t}()},BJvp:function(t,e,i){"use strict";var r,n,a,o,s,l,d;i.r(e),i.d(e,"PolygonPaneView",function(){return d}),r=i("Eyy1"),n=i("aO4+"),a=i("VdBB"),o=i("Zy3/"),s=i("8Uy/"),l=i("BCbF"),d=function(){function t(t,e,i){this._data=[],this._invalidated=!0,this._provider=t,this._model=e,this._hitTestResult=void 0!==i?new a.HitTestResult(a.HitTestResult.CUSTOM,i):new a.HitTestResult(a.HitTestResult.REGULAR)}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,r,n;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new o.CompositeRenderer,e=0,i=this._data;e<i.length;e++)r=i[e],(n=new l.PolygonRenderer(this._hitTestResult)).setData(r),t.append(n);return t},t.prototype._updateViewInternal=function(){var t,e,i,a,o,l,d,h=this;this._data=[],t=this._provider.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||0!==(i=this._provider.graphics().polygons()).size&&null!==(a=this._model.timeScale().visibleBarsStrictRange())&&null!==(o=this._provider.firstValue())&&(l=a.firstBar(),d=a.lastBar(),i.forEach(function(i,a){var c=h._provider.properties().graphics.polygons[a];100!==c.transparency.value()&&i.forEach(function(i){var a,u,p,f,_,v=1/0,y=-1/0;for(a=0,u=i.points;a<u.length;a++)f=(p=u[a]).index+(p.offset||0),v=Math.min(v,f),y=Math.max(y,f);y<l||d<v||(_=i.points.map(function(i){var a=e.indexToCoordinate(i.index+(i.offset||0)),s=t.priceToCoordinate(Object(r.ensureDefined)(i.level),o);return new n.Point(a,s)}),h._data.push({points:_,color:c.color.value(),backcolor:c.color.value(),linewidth:void 0!==c.showBorder&&c.showBorder.value()?1:0,linestyle:s.LINESTYLE_SOLID,filled:!0,
fillBackground:!0,transparency:c.transparency.value(),mouseTouchable:c.mouseTouchable.value()}))})}))},t}()},Gj0v:function(t,e,i){"use strict";function r(t,e){return{min:Math.min(t,e),max:Math.max(t,e)}}function n(t){return t.max-t.min}function a(t,e,i,a,o){var l,d,h,c,u=a.location===p.b.Absolute,f=a.location===p.b.Relative,_=a.direction===p.a.LeftToRight,v=a.direction===p.a.RightToLeft,y=s(t,i);if(u&&_)l=y.min,d=1;else if(u&&v)l=y.max,d=-1;else if(f&&_)l=0,d=1;else{if(!f||!v)throw new Error("Unknown location/direction values: "+a.location+"/"+a.direction);l=i.width(),d=-1}return c=n(h=function(t,e,i){return r(e.priceToCoordinate(t.priceHigh,i),e.priceToCoordinate(t.priceLow,i))}(t,e,o))>=2?1:0,{xBasePoint:l,sign:d,xRange:y,yRange:r(h.min,h.max-c)}}function o(t,e,i){var r,a,o,s=e.location===p.b.Absolute,l=e.location===p.b.Relative,d=e.direction===p.a.LeftToRight,h=e.direction===p.a.RightToLeft;if(s&&d)r="left";else if(s&&h)r="right";else if(l&&d)r="left";else{if(!l||!h)throw new Error("Unknown location/direction values: "+e.location+"/"+e.direction);r="right"}return a=n(t.xRange),o=n(t.yRange),{fontSize:Math.min(Math.round(1.7*a/i.length),Math.round(.6*o)),textHAligh:r}}function s(t,e){return r(e.indexToCoordinate(t.firstBarTime,!0),e.indexToCoordinate(t.lastBarTime,!0))}var l,d,h,c,u,p,f,_,v,y,w,g;i.r(e),l=i("Eyy1"),d=i("aO4+"),h=i("eJTA"),c=i("nEwK"),u=i("VdBB"),p=i("KG+6"),f=i("Zy3/"),_=i("qgcf"),v=function(){function t(t){this._data=t}return t.prototype.hitTest=function(t){var e,i,r,n,a,o,s,l=this._data.histsBySession;for(e in l)if(l.hasOwnProperty(e)&&(r=(i=e.split(" ").map(parseFloat))[0],n=i[1],t.x>=r&&t.x<=n)){for(a=0,o=l[e];a<o.length;a++)if(s=o[a],(t.y>=s.y1&&t.y<=s.y2||t.y>=s.y2&&t.y<=s.y1)&&t.x>=s.x1&&t.x<=s.x2)return new u.HitTestResult(u.HitTestResult.REGULAR);return null}return null},t.prototype.draw=function(t,e){var i=this._data;t.save(),i.histsByColor.forEach(function(i,r){var n,a,o,s,l,d,h,c,u;for(t.fillStyle=r,t.beginPath(),n=0,a=i;n<a.length;n++)o=a[n],s=Math.round(o.x1*e.pixelRatio),l=Math.round(o.x2*e.pixelRatio),d=Math.round(o.y1*e.pixelRatio),h=Math.round(o.y2*e.pixelRatio),c=l-s,u=Math.max(h-d,1),t.rect(s,d,c,u);t.fill()}),t.restore()},t}(),y=i("Tmoa"),w=i("zDbI"),i.d(e,"HHistPaneView",function(){return g}),g=function(){function t(t,e,i){this._invalidated=!0,this._provider=t,this._model=e,this._rendererData={histsByColor:new Map,histsBySession:{}},this._textData=[],this._styles={},this._hhistRenderer=new v(this._rendererData)}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,r;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),(t=new f.CompositeRenderer).append(this._hhistRenderer),e=0,i=this._textData;e<i.length;e++)r=i[e],t.append(new _.TextRenderer(r,new u.HitTestResult(u.HitTestResult.REGULAR)));return t},t.prototype._resetRenderersData=function(){this._rendererData.histsByColor=new Map,this._rendererData.histsBySession={},this._textData=[]},t.prototype._prepareStyles=function(){
var t,e,i,r,n,a,o=Object.keys(Object(l.ensureDefined)(this._provider.graphicsInfo().hhists)),s=this._provider.properties().graphics.hhists;for(t=0,e=o;t<e.length;t++)i=e[t],r=Object(l.ensureDefined)(s.child(i)),n=Object(y.generateColor)(r.colors[0].value(),r.transparencies[0].value()),a=r.colors[1]?Object(y.generateColor)(r.colors[1].value(),r.transparencies[1].value()):n,this._styles[i]={colors:[n,a],visible:r.visible.value(),percentWidth:r.percentWidth.value(),location:r.location.value(),direction:r.direction.value(),showValues:r.showValues.value(),valuesColor:r.valuesColor.value()}},t.prototype._updateViewInternal=function(){var t,e,i,r,n,a,o=this;this._resetRenderersData(),t=this._provider.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||null!==this._provider.firstValue()&&0!==(i=this._provider.graphics().hhistsByTimePointIndex()).size&&null!==(r=this._model.timeScale().visibleBarsStrictRange())&&(n=r.firstBar(),a=r.lastBar(),this._prepareStyles(),Object(l.ensureDefined)(i).forEach(function(i,r){var s=1/0,l=-1/0;i.forEach(function(t){s=Math.min(s,t.firstBarTime),l=Math.max(l,t.lastBarTime)}),l<n||s>a||o._updateDataForRenderers(i,t,e)}))},t.prototype._updateDataForRenderers=function(t,e,i){var r,c,u,p,f,_,v,y,g,x,T,m,b,R,S,P,C,L,O,B,M,E,A=this,H=[],z=e.height(),D=this._rendererData.histsByColor,I=this._rendererData.histsBySession;if(!(t.size<=0)&&(r=null,t.forEach(function(t){r=r||t}),null!==r&&(c=r,u=0,t.forEach(function(t){var e=t.rate.reduce(function(t,e){return t+e});u=Math.max(u,e),t.priceLow<c.priceLow&&(c=t)}),p=s(r,i),f=n(p),_=Number.MAX_SAFE_INTEGER,v=[],t.forEach(function(t){var r,s,h,c,p,y,g,x,T,m,b,R,S,P,C,L,O,B,M,E,k,V,j=A._styles[t.styleId];if(j.visible){if(null==t.rate[t.rate.length-1]&&t.rate.splice(-1,1),j.showValues)for(r=0;r<t.rate.length;r++)H[r]=(H[r]||0)+t.rate[r];if(h=(s=a(t,e,i,j,Object(l.ensureNotNull)(A._provider.firstValue()))).xBasePoint,c=s.sign,!((p=s.yRange).min>z||p.max<0)){for(y=p.min,g=p.max,x=Math.max(j.percentWidth*f/100-t.rate.length,0),T=t.rate.reduce(function(t,e){return t+e}),m=(c>0?h:h-x)+" "+(c>0?h+x:h),b=c>0?{x1:h,x2:h+x*T/u,y1:y,y2:g}:{x1:h-x*T/u,x2:h,y1:y,y2:g},(R=I[m])?R.push(b):I[m]=[b],r=0;r<t.rate.length;r++)(S={x1:0,y1:0,x2:0,y2:0}).y1=y,S.y2=g,S.x1=0===r?h:h+c*(x*t.rate[r-1]/u),S.x2=S.x1+c*(x*t.rate[r]/u),Math.abs(S.x2-S.x1)<.5||(P=j.colors[r],void 0===(C=D.get(P))?D.set(P,[S]):C.push(S));j.showValues&&(B=(O=o(s,j,L=A._formatRate(t.rate,j.direction))).fontSize,M=O.textHAligh,_=Math.min(_,B),E=h+3*c,k=p.max-.5*n(p),V={text:L,color:j.valuesColor,font:w.CHART_FONT_FAMILY,horzAlign:M,vertAlign:"middle",points:[new d.Point(E,k)],offsetX:0,offsetY:0,forceTextAlign:!0},v.push(V))}}}),v.length>0&&(y=this._styles[c.styleId],x=(g=a(c,e,i,y,Object(l.ensureNotNull)(this._provider.firstValue()))).xBasePoint,T=g.sign,m=g.yRange,S=(R=o(g,y,b=this._formatRate(H,y.direction))).fontSize,P=R.textHAligh,_=Math.min(_,S),C=x+3*T,L=m.max+.5*n(m),O={text:b,color:Object(h.shiftColor)(y.valuesColor,1.5),font:w.CHART_FONT_FAMILY,horzAlign:P,vertAlign:"middle",
points:[new d.Point(C,L)],offsetX:0,offsetY:0,forceTextAlign:!0},v.push(O)),_>=7.5)))for(B=0,M=v;B<M.length;B++)(E=M[B]).fontsize=_,this._textData.push(E)},t.prototype._formatRate=function(t,e){e===p.a.RightToLeft&&(t=t.slice()).reverse();var i=new c.VolumeFormatter;return t.map(function(t){return i.format(t)}).join("x")},t}()},IMGS:function(t,e,i){"use strict";function r(t,e){n.call(this,t,e),this._calc=null,this._lines=[],this._pearsons=null,this._pearsonsLabelRenderer=new s,this._renderer=null}var n=i("aB9a").LineSourcePaneView,a=i("rvCT").LinearRegressionPaneView,o=i("NN6M").ParallelChannelRenderer,s=i("qgcf").TextRenderer,l=i("pJOz").TrendLineRenderer,d=i("vq8G").SelectionRenderer,h=i("VdBB").HitTestResult,c=i("Zy3/").CompositeRenderer,u=i("Tmoa");inherit(r,n),r.prototype.getTransparencyResetLines=function(){return this._lines.map(function(t){var e=$.extend({},t);return e.color=u.resetTransparency(e.color),e})},r.prototype.renderer=function(t,e){return this._invalidated&&this._updateImpl(),this._renderer},r.prototype._updateImpl=function(){var t,e,i,r,s,p,f,_,v;for(n.prototype._updateImpl.call(this),a.prototype._updateImpl.call(this),this._renderer=null,t=new c,e=[],i=[this._lines[1],this._lines[0],this._lines[2]],r=[],s=0;s<i.length;s++)i[s]&&r.push(i[s]);for(s=1;s<r.length;s++)(p={}).points=[i[s].floatPoints[0],i[s].floatPoints[1],i[s-1].floatPoints[0],i[s-1].floatPoints[1]],p.color=i[s].color,p.width=this._model.timeScale().width(),p.height=this._source.priceScale().height(),p.linewidth=i[s].linewidth,p.linestyle=i[s].linestyle,p.extendleft=!1,p.extendright=i[s].extendright,p.backcolor=p.color,p.transparency=this._source.properties().styles.transparency.value(),p.skipLines=!0,p.fillBackground=!0,(f=new o(new h(h.REGULAR))).setData(p),t.append(f);for(_=this.getTransparencyResetLines(),s=0;s<r.length;s++)(f=new l).setData(_[s]),f.setHitTest(new h(h.REGULAR)),t.append(f),0!==s&&(e=e.concat(this._lines[s].floatPoints));this._pearsons&&(this._pearsons.color=u.resetTransparency(this._pearsons.color),this._pearsonsLabelRenderer.setData(this._pearsons),t.append(this._pearsonsLabelRenderer)),this._lines&&this._lines.length>=1&&(t.append(new d({points:e,bgColor:this._model.backgroundColor().value(),visible:this.areAnchorsVisible()})),(v=this._lines[0].floatPoints)[0].data=0,v[1].data=1,t.append(this.createLineAnchor({points:v}))),this._renderer=t},e.RegressionTrendPaneView=r},IyRz:function(t,e,i){"use strict";var r,n,a,o,s;i.r(e),r=i("Zy3/"),n=i("ikwP"),a=i("Tmoa"),o=function(){function t(t){this._data=t}return t.prototype.hitTest=function(t){return null},t.prototype.draw=function(t,e){},t.prototype.drawBackground=function(t,e){var i=this._data,r=Object(a.generateColor)(this._data.color,this._data.transparency),o=e.pixelRatio,s=Math.round(i.x1*o),l=Math.round(i.x2*o),d=Math.round(i.y1*o),h=Math.round(i.y2*o);Object(n.fillRect)(t,s,d,l-s,h-d,r)},t}(),i.d(e,"BackgroundPaneView",function(){return s}),s=function(){function t(t,e,i){this._data=[],this._invalidated=!0,this._provider=t,this._model=e,this._data=[]}
return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,n;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new r.CompositeRenderer,e=0,i=this._data;e<i.length;e++)n=i[e],t.append(new o(n));return t},t.prototype._updateViewInternal=function(){var t,e,i,r,n,a,o=this;this._data=[],t=this._provider.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||0!==(i=this._provider.graphics().backgrounds()).size&&null!==(r=this._model.timeScale().visibleBarsStrictRange())&&(n=r.firstBar(),a=r.lastBar(),i.forEach(function(i,r){var s,l,d=o._provider.properties().graphics.backgrounds[r];d.visible.value()&&i.forEach(function(i){var r,h,c=i.start,u=i.stop;u<n||a<c||(r=e.indexToCoordinate(c,!0)-.5*e.barSpacing(),h=e.indexToCoordinate(u,!0)+.5*e.barSpacing(),l===c-1&&(r=s||r),s=h,l=u,r<0&&h<0||r>e.width()&&h>e.width()||o._data.push({x1:r,x2:h,y1:0,y2:t.height(),color:d.color.value(),transparency:d.transparency.value()}))})}))},t}()},K3ps:function(t,e,i){"use strict";var r,n,a,o,s,l,d,h,c,u,p,f,_,v,y,w,g,x,T,m,b,R,S,P,C,L,O,B,M;i.r(e),r=i("Zy3/"),n=i("PF2b"),a=i("Kmdw"),o=i("akof"),s=i("+q2u"),l=i("fxzW"),d=i("P+Pi"),h=i("IOzl"),c=i("mrSG"),u=i("jlDR"),p=i("VdBB"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(c.__extends)(e,t),e.prototype.hitTest=function(t){var e,i,r,n,a,o,s,l=t.x,d=t.y;for(e=0,i=this._items;e<i.length;e++)if(n=(r=i[e]).x,a=r.x+r.shapeWidth,o=r.y-r.shapeHeight+r.vertOffset,s=r.y+r.vertOffset,l>n&&l<a&&d>o&&d<s)return new p.HitTestResult(p.HitTestResult.REGULAR);return null},e.prototype._drawItemShape=function(t,e,i){var r,n,a=e.pixelRatio,o=this._lineWidth(e)%2?.5:0,s=this._getArrowSize(i),l=Math.round(i.x*a)+o,d=Math.round(i.y+i.vertOffset)+o,h=Math.round((i.x+s)*a)+o,c=Math.round((i.y+i.vertOffset-s)*a)+o,p=Math.round((i.y+i.vertOffset-2*s)*a)+o;t.moveTo(h,c),t.lineTo(l,d),t.lineTo(h,p),r=Math.round((i.y+i.vertOffset-i.shapeHeight)*a)+o,n=Math.round(i.x*a+i.shapeWidth)+o,this._drawCorner(t,h,r,u.a.leftUp,a),this._drawCorner(t,n,r,u.a.rightUp,a),this._drawCorner(t,n,c,u.a.rightDown,a),t.lineTo(h,c)},e.prototype._getArrowSize=function(t){return t.stepX/Math.sqrt(2)},e.prototype._getHorizontalTextOffset=function(t){return t.shapeWidth/2+this._getArrowSize(t)/2},e.prototype._getVerticalTextOffset=function(t){return-t.shapeHeight/2-this._getArrowSize(t)/2},e}(u.b),_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(c.__extends)(e,t),e.prototype.hitTest=function(t){var e,i,r,n,a,o,s,l=t.x,d=t.y;for(e=0,i=this._items;e<i.length;e++)if(n=(r=i[e]).x,a=r.x+r.shapeWidth,o=r.y+r.vertOffset,s=r.y+r.shapeHeight+r.vertOffset,l>n&&l<a&&d>o&&d<s)return new p.HitTestResult(p.HitTestResult.REGULAR);return null},e.prototype._drawItemShape=function(t,e,i){
var r=e.pixelRatio,n=this._lineWidth(e)%2?.5:0,a=this._getArrowSize(i),o=Math.round(i.x*r)+n,s=Math.round((i.y+i.vertOffset)*r)+n,l=Math.round((i.x+a)*r)+n,d=Math.round((i.y+i.vertOffset+2*a)*r)+n,h=Math.round((i.y+i.vertOffset+a)*r)+n,c=Math.round((i.x+i.shapeWidth)*r)+n,p=Math.round((i.y+i.vertOffset+i.shapeHeight)*r)+n;t.moveTo(l,d),t.lineTo(o,s),t.lineTo(l,h),this._drawCorner(t,c,h,u.a.rightUp,r),this._drawCorner(t,c,p,u.a.rightDown,r),this._drawCorner(t,l,p,u.a.leftDown,r),t.lineTo(l,d)},e.prototype._getArrowSize=function(t){return t.stepX/Math.sqrt(2)},e.prototype._getHorizontalTextOffset=function(t){return t.shapeWidth/2+this._getArrowSize(t)/2},e.prototype._getVerticalTextOffset=function(t){return t.shapeHeight/2+this._getArrowSize(t)/2},e}(u.b),v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(c.__extends)(e,t),e.prototype.hitTest=function(t){var e,i,r,n,a,o,s,l=t.x,d=t.y;for(e=0,i=this._items;e<i.length;e++)if(n=(r=i[e]).x-r.shapeWidth,a=r.x,o=r.y-r.shapeHeight+r.vertOffset,s=r.y+r.vertOffset,l>n&&l<a&&d>o&&d<s)return new p.HitTestResult(p.HitTestResult.REGULAR);return null},e.prototype._drawItemShape=function(t,e,i){var r=e.pixelRatio,n=this._lineWidth(e)%2?.5:0,a=this._getArrowSize(i),o=Math.round(i.x*r)+n,s=Math.round((i.y+i.vertOffset)*r)+n,l=Math.round((i.x-a)*r)+n,d=Math.round((i.y+i.vertOffset-2*a)*r)+n,h=Math.round((i.y+i.vertOffset-a)*r)+n,c=Math.round((i.x-i.shapeWidth)*r)+n,p=Math.round((i.y+i.vertOffset-i.shapeHeight)*r)+n;t.moveTo(l,d),t.lineTo(o,s),t.lineTo(l,h),this._drawCorner(t,c,h,u.a.leftDown,r),this._drawCorner(t,c,p,u.a.leftUp,r),this._drawCorner(t,l,p,u.a.rightUp,r),t.lineTo(l,d)},e.prototype._getArrowSize=function(t){return t.stepX/Math.sqrt(2)},e.prototype._getVerticalTextOffset=function(t){return-t.shapeHeight/2-this._getArrowSize(t)/2},e.prototype._getHorizontalTextOffset=function(t){return-t.shapeWidth/2-this._getArrowSize(t)/2},e}(u.b),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(c.__extends)(e,t),e.prototype.hitTest=function(t){var e,i,r,n,a,o,s,l=t.x,d=t.y;for(e=0,i=this._items;e<i.length;e++)if(n=(r=i[e]).x-r.shapeWidth,a=r.x,o=r.y+r.vertOffset,s=r.y+r.shapeHeight+r.vertOffset,l>n&&l<a&&d>o&&d<s)return new p.HitTestResult(p.HitTestResult.REGULAR);return null},e.prototype._drawItemShape=function(t,e,i){var r=e.pixelRatio,n=this._lineWidth(e)%2?.5:0,a=this._getArrowSize(i),o=Math.round(i.x*r)+n,s=Math.round((i.y+i.vertOffset)*r)+n,l=Math.round((i.x-a)*r)+n,d=Math.round((i.y+i.vertOffset+a)*r)+n,h=Math.round((i.y+i.vertOffset+2*a)*r)+n,c=Math.round((i.x-i.shapeWidth)*r)+n,p=Math.round((i.y+i.vertOffset+i.shapeHeight)*r)+n;t.moveTo(l,d),t.lineTo(o,s),t.lineTo(l,h),this._drawCorner(t,l,p,u.a.rightDown,r),this._drawCorner(t,c,p,u.a.leftDown,r),this._drawCorner(t,c,d,u.a.leftUp,r),t.lineTo(l,d)},e.prototype._getArrowSize=function(t){return t.stepX/Math.sqrt(2)},e.prototype._getHorizontalTextOffset=function(t){return-t.shapeWidth/2-this._getArrowSize(t)/2},e.prototype._getVerticalTextOffset=function(t){
return t.shapeHeight/2+this._getArrowSize(t)/2},e}(u.b),w=i("6ptY"),g=i("V0al"),x=i("2WC2"),T=i("gBDZ"),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(c.__extends)(e,t),e.prototype.setData=function(t,e){var i,r,n;for(this._setBaseData(t,e),i=0,r=this._items;i<r.length;i++)0===(n=r[i]).vertOffset&&(n.textVertOffset=0)},e.prototype._drawItemText=function(t,e,i){var r,n,a,o,s,l=this._getTextCache(i);null!==l&&(n=i.x,a=i.y+i.textVertOffset,o=(null===(r=i.style)||void 0===r?void 0:r.textColor)||this._textColor,s=i.vertOffset,l.paintTo(t,e,o,n,a,T.a.Center,s>0?T.c.Top:T.c.Bottom))},e}(x.a),b=i("vaiT"),R=i("23IT"),S=i("tS10"),P=i("Eyy1"),i.d(e,"DwgLabelPaneView",function(){return M}),(C={})[b.b.Left]="left",C[b.b.Center]="center",C[b.b.Right]="right",L=C,function(t){t.NORMAL_SIZE=50,t.AUTO_SIZE_MULT=1,t.SHAPE_HEIGHT_MULT=.5,t.SHAPE_WIDTH_MULT=.6,t.FONT_SIZE_MULT=.24}(O||(O={})),B=5e3,M=function(){function t(t,e,i){this._rendererTypeByStyle=new Map([[b.a.Arrowdown,a.PaneRendererArrowDown],[b.a.Arrowup,a.PaneRendererArrowUp],[b.a.Circle,o.PaneRendererCircleShape],[b.a.Cross,s.PaneRendererCrossShape],[b.a.Diamond,l.PaneRendererDiamond],[b.a.Flag,d.PaneRendererFlagShape],[b.a.LabelDown,h.PaneRendererLabelDown],[b.a.LabelUp,h.PaneRendererLabelUp],[b.a.LabelLeft,h.PaneRendererLabelLeft],[b.a.LabelRight,h.PaneRendererLabelRight],[b.a.LabelCenter,h.PaneRendererLabelCenter],[b.a.LabelLeftUp,_],[b.a.LabelLeftDown,f],[b.a.LabelRightUp,y],[b.a.LabelRightDown,v],[b.a.Square,w.PaneRendererSquare],[b.a.Triangleup,n.PaneRendererTriangleApexUp],[b.a.Triangledown,n.PaneRendererTriangleApexDown],[b.a.Xcross,g.PaneRendererXCross],[b.a.None,m]]),this._invalidated=!0,this._graphicsProvider=t,this._model=e,this._renderer=new r.CompositeRenderer,this._textCache=new S.a(B)}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){return this._invalidated&&(this._invalidated=!1,this._updateViewInternal(this._model.timeScale().barSpacing())),this._renderer},t.prototype._updateViewInternal=function(t){var e,i,r,n,a,o,s,l,d,h,c=this;this._renderer.clear(),e=this._graphicsProvider.priceScale(),i=this._model.timeScale(),!e||e.isEmpty()||i.isEmpty()||(r=this._graphicsProvider.graphics().dwglabels(),n=i.visibleBarsStrictRange(),a=this._graphicsProvider.firstValue(),0!==r.size&&null!==n&&null!==a&&(o=n.firstBar(),s=n.lastBar(),l=Math.round(t*O.AUTO_SIZE_MULT),d=null,h=[],r.forEach(function(t,i){c._graphicsProvider.properties().graphics.dwglabels[i].visible.value()&&t.forEach(function(t){var i,r,n,u,p,f,_,v,y,w,g,x,T,m,b,R=t.x;R<o||s<R||void 0!==(i=c._graphicsProvider.metaInfo().defaults.palettes)&&void 0!==i.palette_common&&(r=i.palette_common,n=null===t.colorIndex?null:r.colors[t.colorIndex],u=null===t.textColorIndex?null:r.colors[t.textColorIndex],void 0!==n&&void 0!==u&&(p=null===n?void 0:n.color,f=null===u?void 0:u.color,void 0===p&&void 0===f||(_=t.size,v=t.style,y=c._calculateLabelHeight(O.NORMAL_SIZE,_,l),w=c._getInvertedYloc(t.yloc,e.isInverted()),g=void 0===f?"":t.text,
x=L[t.textAlign],m={x:(T=c._getLocationData({index:R,price:t.y,yloc:w,size:y,style:v,firstValue:a,hideShape:void 0===p})).x0,y:T.y0,width:T.shapeWidth,height:T.shapeHeight,vertOffset:T.vertOffset,text:g,fontSize:T.fontSize,style:{color:p,borderColor:p,textColor:f},textAlign:x},T.style!==d?(b={items:[],style:T.style},h.push(b),d=T.style):b=h[h.length-1],b.items.push(m))))})}),h.forEach(function(e){var i=Object(P.ensureDefined)(c._rendererTypeByStyle.get(e.style)),r={items:e.items,barSpacing:t},n=new i(r,{textCache:c._textCache,skipRenderingOptimizations:!0});c._renderer.append(n)})))},t.prototype._getLocationData=function(t){var e,i,r,n,a=O,o=t.size*a.FONT_SIZE_MULT,s=this._model.timeScale(),l=this._graphicsProvider.priceScale(),d=s.indexToCoordinate(t.index,!0),h=NaN;return t.yloc===b.c.Price?h=l.priceToCoordinate(t.price,t.firstValue):(e=t.yloc===b.c.AboveBar?2:3,null!==(i=this._graphicsProvider.series().bars().valueAt(t.index))&&null!=(r=i[e])&&(h=l.priceToCoordinate(r,t.firstValue))),{x0:d,y0:h,shapeWidth:t.size*a.SHAPE_WIDTH_MULT,shapeHeight:n=t.size*a.SHAPE_HEIGHT_MULT,vertOffset:-1.5*n*this._getYLocSign(t.yloc),fontSize:o,style:t.hideShape?b.a.None:t.style}},t.prototype._getYLocSign=function(t){return t===b.c.Price?0:t===b.c.AboveBar?1:-1},t.prototype._getInvertedYloc=function(t,e){if(e){if(t===b.c.AboveBar)return b.c.BelowBar;if(t===b.c.BelowBar)return b.c.AboveBar}return t},t.prototype._calculateLabelHeight=function(t,e,i){var r=i;switch(e){case R.PlotSymbolSize.Tiny:r=.6*t;break;case R.PlotSymbolSize.Small:r=.8*t;break;case R.PlotSymbolSize.Normal:r=t;break;case R.PlotSymbolSize.Large:r=1.5*t;break;case R.PlotSymbolSize.Huge:r=2*t}return r},t}()},Kt0C:function(t,e,i){"use strict";var r,n,a,o,s,l,d;i.r(e),i.d(e,"LinePaneView",function(){return d}),r=i("Eyy1"),n=i("aO4+"),a=i("VdBB"),o=i("Zy3/"),s=i("a7Ha"),l=i("pJOz"),d=function(){function t(t,e,i){this._data=[],this._invalidated=!0,this._provider=t,this._model=e,this._hitTestResult=void 0!==i?new a.HitTestResult(a.HitTestResult.CUSTOM,i):new a.HitTestResult(a.HitTestResult.REGULAR)}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,r,n;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new o.CompositeRenderer,e=0,i=this._data;e<i.length;e++)r=i[e],(n=new l.TrendLineRenderer).setData(r),n.setHitTest(this._hitTestResult),t.append(n);return t},t.prototype._updateViewInternal=function(){var t,e,i,a,o,l,d,h=this;this._data=[],t=this._provider.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||0!==(i=this._provider.graphics().lines()).size&&null!==(a=this._model.timeScale().visibleBarsStrictRange())&&null!==(o=this._provider.firstValue())&&(l=a.firstBar(),d=a.lastBar(),i.forEach(function(i,a){var c=h._provider.properties().graphics.lines[a];c.visible.value()&&i.forEach(function(i){var a,u,p,f,_,v,y=i.startIndex+(i.startOffset||0),w=i.endIndex+(i.endOffset||0);Math.max(y,w)<l||Math.min(y,w)>d||(a=e.indexToCoordinate(y),u=e.indexToCoordinate(w),
p=t.priceToCoordinate(Object(r.ensureDefined)(i.startPrice),o),f=t.priceToCoordinate(Object(r.ensureDefined)(i.endPrice),o),_=new n.Point(a,p),v=new n.Point(u,f),h._data.push({points:[_,v],extendleft:!1,extendright:!1,leftend:s.LineEnd.Normal,rightend:s.LineEnd.Normal,width:e.width(),height:t.height(),color:c.color.value(),linewidth:c.width.value(),linestyle:c.style.value()}))})}))},t}()},PztT:function(t,e,i){"use strict";function r(t){return t*this.width}function n(t,e,i){var r=function(t,e,i){var r=e.subtract(t);return i.subtract(t).dotProduct(r)/r.dotProduct(r)}(t.extP1,t.extP2,e),n=t.extP1.add(t.extP2.subtract(t.extP1).scaled(r));r<0&&i.left?t.extP1=n:r>1&&i.right&&(t.extP2=n)}var a,o,s,l,d,h,c,u,p,f,_,v,y;i.r(e),a=i("mrSG"),o=i("aO4+"),s=i("tSCe"),l=i.n(s),d=i("2tp3"),h=i("GEp6"),c=i("VdBB"),u=i("jFln"),p=i("Zp/P"),f=i("ikwP"),_=function(){function t(t){this._locs=t}return t.prototype.draw=function(t,e){var i=this;t.lineCap="butt",Object(f.drawScaled)(t,e.pixelRatio,function(){i._locs.forEach(function(e){var n=e.style,a=n.type.dashPattern.map(r,n);t.strokeStyle=n.color,t.lineWidth=n.width,Object(u.setLineDash)(t,a),t.beginPath(),i._drawShape(t,e),t.stroke()})})},t.prototype.hitTest=function(t){var e,i,r,n;for(e=0,i=this._locs;e<i.length;e++)if(n=(r=i[e]).style.width/2,Object(h.distanceToSegment)(r.extP1,r.extP2,t).distance<=n)return new c.HitTestResult(c.HitTestResult.REGULAR);return null},t.prototype._drawShape=function(t,e){t.moveTo(e.extP1.x,e.extP1.y),t.lineTo(e.extP2.x,e.extP2.y);var i=e.style.width;e.style.type.drawLeftArrow&&this._drawArrow(t,e.p2,e.p1,i),e.style.type.drawRightArrow&&this._drawArrow(t,e.p1,e.p2,i)},t.prototype._drawArrow=function(t,e,i,r){var n,a,o;if(!(i.subtract(e).length()<1))for(n=0,a=Object(p.getArrowPoints)(e,i,r,!0);n<a.length;n++)o=a[n],t.moveTo(o[0].x,o[0].y),t.lineTo(o[1].x,o[1].y)},t}(),v=i("hBTJ"),i.d(e,"DwgLinePaneView",function(){return y}),y=function(t){function e(e,i,r){var n=t.call(this)||this;return n._invalidated=!0,n._graphicsProvider=e,n._model=i,n._renderer=null,n}return Object(a.__extends)(e,t),e.prototype.update=function(){this._invalidated=!0},e.prototype.renderer=function(){return this._invalidated&&(this._renderer=null,this._invalidated=!1,this._updateRenderer()),this._renderer},e.prototype._updateRenderer=function(){var t,e,i,r,n,a,s,l=this,h=this._graphicsProvider.priceScale(),c=this._model.timeScale();!h||h.isEmpty()||c.isEmpty()||0!==(t=this._graphicsProvider.graphics().dwglines()).size&&null!==this._model.timeScale().visibleBarsStrictRange()&&void 0!==(e=this._graphicsProvider.metaInfo().defaults.palettes)&&void 0!==e.palette_common&&(i=e.palette_common,null!==(r=this._graphicsProvider.firstValue())&&(n=c.width(),a=h.height(),s=[],t.forEach(function(t,e){l._graphicsProvider.properties().graphics.dwglines[e].visible.value()&&t.forEach(function(t){var e,u,p,f,_,v,y;null!==t.colorIndex&&void 0!==(e=i.colors[t.colorIndex])&&(u=c.indexToCoordinate(t.x1,!0),p=h.priceToCoordinate(t.y1,r),f=c.indexToCoordinate(t.x2,!0),_=h.priceToCoordinate(t.y2,r),v={
width:t.width>0?t.width:1,color:e.color,type:Object(d.c)(t.style)},null!==(y=l._getLocationData(new o.Point(u,p),new o.Point(f,_),t.extend,n,a,v))&&s.push(y))})}),this._renderer=new _(s)))},e.prototype._getLocationData=function(t,e,i,r,a,s){var l,h,c=function(t){return{left:t===d.a.Both||t===d.a.Left,right:t===d.a.Both||t===d.a.Right}}(i),u={p1:t,p2:e,extP1:t,extP2:e,style:s};return c.left&&!c.right&&(u.extP1=e,u.extP2=t,c.left=!1,c.right=!0),function(t,e,i){var r,a;for(r=0,a=e;r<a.length;r++)n(t,a[r],i)}(u,l=[new o.Point(0,0),new o.Point(0,a),new o.Point(r,a),new o.Point(r,0)],c),h=function(t,e,i){var r=.5*i,n=e.subtract(t),a=n.normalized().transposed().scaled(r),o=t.add(a),s=e.add(a),l=t.subtract(a),d=e.subtract(a);return[o,s,d,l]}(u.extP1,u.extP2,s.width),null===Object(v.intersectPolygons)(l,h)?null:u},e}(l.a)},cPgM:function(t,e,i){"use strict";var r,n;i.r(e),i.d(e,"ScaledPaneRenderer",function(){return r}),i.d(e,"ScaledPaneRendererWrapper",function(){return n}),r=function(){function t(){}return t.prototype.draw=function(t,e){t.save(),t.scale(e.pixelRatio,e.pixelRatio),t.translate(.5,.5),this._drawImpl(t),t.restore()},t.prototype.drawBackground=function(t,e){t.save(),t.scale(e.pixelRatio,e.pixelRatio),t.translate(.5,.5),this._drawBackgroundImpl(t),t.restore()},t.prototype._drawBackgroundImpl=function(t){},t}(),n=function(){function t(t){this._base=t}return t.prototype.hitTest=function(t){return this._base.hitTest(t)},t.prototype.draw=function(t,e){t.save(),t.scale(e.pixelRatio,e.pixelRatio),t.translate(.5,.5),this._base.draw(t,{pixelRatio:1}),t.restore()},t.prototype.drawBackground=function(t,e){t.save(),t.scale(e.pixelRatio,e.pixelRatio),t.translate(.5,.5),this._base.drawBackground&&this._base.drawBackground(t,{pixelRatio:1}),t.restore()},t}()},psYU:function(t,e,i){"use strict";var r,n,a,o,s,l;i.r(e),i.d(e,"VertLinePaneView",function(){return l}),r=i("Eyy1"),n=i("VdBB"),a=i("972a"),o=i("Zy3/"),s=i("z+cS"),l=function(){function t(t,e,i){this._data=[],this._invalidated=!0,this._provider=t,this._model=e,this._hitTestResult=void 0!==i?new n.HitTestResult(n.HitTestResult.CUSTOM,i):new n.HitTestResult(n.HitTestResult.REGULAR)}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,r,n;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new o.CompositeRenderer,e=0,i=this._data;e<i.length;e++)r=i[e],(n=new s.VerticalLineRenderer).setData(r),n.setHitTest(this._hitTestResult),t.append(n);return t},t.prototype._updateViewInternal=function(){var t,e,i,n,o,s,l,d,h=this;this._data=[],t=this._provider.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._provider.graphicsInfo().vertlines,0!==(n=this._provider.graphics().vertlines()).size&&void 0!==i&&null!==(o=this._model.timeScale().visibleBarsStrictRange())&&null!==(s=this._provider.firstValue())&&(l=o.firstBar(),d=o.lastBar(),n.forEach(function(n,o){var c,u=h._provider.properties().graphics.vertlines[o];if(u.visible.value()){switch(c=0,Object(r.ensureDefined)(i[o]).halign){
case a.HAlign.Left:c=-e.barSpacing()/2;break;case a.HAlign.Right:c=e.barSpacing()/2}n.forEach(function(i){var n=i.index;n<l||d<n||h._data.push({x:e.indexToCoordinate(n)+c,top:i.extendTop?void 0:t.priceToCoordinate(Object(r.ensureDefined)(i.endPrice),s),bottom:i.extendBottom?void 0:t.priceToCoordinate(Object(r.ensureDefined)(i.startPrice),s),width:e.width(),height:t.height(),color:u.color.value(),linewidth:u.width.value(),linestyle:u.style.value()})})}})))},t}()},qVqd:function(t,e,i){"use strict";var r,n,a,o,s,l,d,h,c,u,p,f,_,v,y,w,g;i.r(e),r=i("mrSG"),n=i("Eyy1"),a=i("aO4+"),o=i("972a"),s=i("Zy3/"),l=i("f6yo"),d=i("VdBB"),h=i("ikwP"),c=function(){function t(t){this._data=t}return t.prototype.draw=function(t,e){var i=this,r="down"===this._data.direction?1:"up"===this._data.direction?-1:0,n=this._data.point.x,a=this._data.point.y;Object(h.drawScaled)(t,e.pixelRatio,function(){t.fillStyle=i._data.color,t.beginPath(),t.arc(n+1,a+2*i._data.size*r,i._data.size,0,2*Math.PI),t.closePath(),t.fill(),t.stroke()})},t.prototype.hitTest=function(t){var e="down"===this._data.direction?1:"up"===this._data.direction?-1:0,i=new a.Point(this._data.point.x+.5,this._data.point.y+.5+2*this._data.size*e);return Object(l.pointInCircle)(t,i,this._data.size)?new d.HitTestResult(d.HitTestResult.REGULAR):null},t}(),u=function(){function t(t){this._data=t}return t.prototype.draw=function(t,e){var i="down"===this._data.direction?1:"up"===this._data.direction?-1:0,r=this._data.size,n=new a.Point(this._data.point.x-r/2,this._data.point.y-r/2+i*r),o=new a.Point(this._data.point.x+r/2,this._data.point.y+r/2+i*r),s=o.subtract(n),l=e.pixelRatio,d=Math.max(1,Math.floor(l)),h=d/2,c=d%2?.5:0,u=Math.round(n.x*l)+c,p=Math.round((n.x+s.x)*l)+c,f=Math.round(n.y*l)+c,_=Math.round((n.y+s.y)*l)+c;t.beginPath(),t.fillStyle=this._data.color,t.rect(u+h,f+h,p-u-d,_-f-d),t.fill(),t.lineWidth=d,t.beginPath(),t.rect(u,f,p-u,_-f),t.stroke()},t.prototype.hitTest=function(t){var e="down"===this._data.direction?1:"up"===this._data.direction?-1:0,i=this._data.size,r=new a.Point(this._data.point.x-i/2,this._data.point.y-i/2+e*i),n=new a.Point(this._data.point.x+i/2,this._data.point.y+i/2+e*i);return Object(l.pointInBox)(t,Object(a.box)(r,n))?new d.HitTestResult(d.HitTestResult.REGULAR):null},t}(),p=function(){function t(t,e){this._data=t,this._arrowDirection=e}return t.prototype.draw=function(t,e){var i,r,n,a,o,s=this._arrowDirection,l=this._data.size,d=this._data.color,c=this._data.point.x+1,u=this._data.point.y,p=1.1*l;switch(s){case"up":u-=p;break;case"down":u+=p}i=l/6,r=l/4,n=l/3,a=l/2,o=.6666666*l,Object(h.drawScaled)(t,e.pixelRatio,function(){switch(t.fillStyle=d,t.beginPath(),s){case"up":t.moveTo(c,u),t.lineTo(c-a,u+o),t.lineTo(c-r,u+o),t.lineTo(c,u+n),t.lineTo(c+r,u+o),t.lineTo(c+a,u+o),t.lineTo(c,u);break;case"down":t.moveTo(c,u+l),t.lineTo(c-a,u+n),t.lineTo(c-r,u+n),t.lineTo(c,u+o),t.lineTo(c+r,u+n),t.lineTo(c+a,u+n),t.lineTo(c,u+l);break;case"right":t.moveTo(c+i,u),t.lineTo(c-i,u-r),t.lineTo(c-i,u+r),t.lineTo(c+i,u);break;case"left":t.moveTo(c-i,u),
t.lineTo(c+i,u-r),t.lineTo(c+i,u+r),t.lineTo(c-i,u)}t.closePath(),t.fill(),t.stroke()})},t.prototype.hitTest=function(t){var e=this._hitTriangle(),i=e[0],r=e[1],n=e[2];return Object(l.pointInTriangle)(t,i,r,n)?new d.HitTestResult(d.HitTestResult.REGULAR):null},t.prototype._hitTriangle=function(){var t,e,i,r,n,o=this._data.point.x,s=this._data.point.y,l=this._arrowDirection,d=this._data.size,h=1.1*d;switch(l){case"up":s-=h;break;case"down":s+=h}switch(t=d/6,e=d/4,i=d/3,r=d/2,n=.6666666*d,l){case"up":return[new a.Point(o,s),new a.Point(o+r,s+n),new a.Point(o-r,s+n)];case"down":return[new a.Point(o,s+d),new a.Point(o+r,s+i),new a.Point(o-r,s+i)];case"right":return[new a.Point(o+t,s),new a.Point(o-t,s-e),new a.Point(o-t,s+e)];case"left":return[new a.Point(o-t,s),new a.Point(o+t,s-e),new a.Point(o+t,s+e)]}},t}(),f=i("tSCe"),_=i.n(f),v=i("Tmoa"),y=i("uOxu"),i.d(e,"ShapeMarkPaneView",function(){return g}),w=Object(y.getLogger)("Chart.ShapeMarkPaneView"),g=function(t){function e(e,i,r){var n=t.call(this)||this;return n._data=[],n._invalidated=!0,n._provider=e,n._model=i,n._data=[],n}return Object(r.__extends)(e,t),e.prototype.update=function(){this._invalidated=!0},e.prototype.renderer=function(){var t,e,i,r;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new s.CompositeRenderer,e=0,i=this._data;e<i.length;e++)switch((r=i[e]).shape){case"circle":t.append(new c(r));break;case"square":t.append(new u(r));break;case"arrowUp":t.append(new p(r,"up"));break;case"arrowDown":t.append(new p(r,"down"));break;case"arrowRight":t.append(new p(r,"right"));break;case"arrowLeft":t.append(new p(r,"left"))}return t},e.prototype._updateViewInternal=function(){var t,e,i,r,n,o,s,l=this;this._data=[],t=this._provider.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||0!==(i=this._provider.graphics().shapemarks()).size&&null!==(r=this._model.timeScale().visibleBarsStrictRange())&&null!==(n=this._provider.firstValue())&&(o=r.firstBar(),s=r.lastBar(),i.forEach(function(i,r){var d=l._provider.properties().graphics.shapemarks[r];d.visible.value()&&i.forEach(function(i){var r,h,c,u,p,f,_,y,w,g=i.time;if(!(g<o||s<g)&&null!==l._provider.series().bars().valueAt(g))switch(r="left"===d.halign.value()?-(e.barSpacing()/2+1):"right"===d.halign.value()?e.barSpacing()/2+1:0,h=d.location.value(),c=d.shape.value(),u=parseInt(d.size.value()),p=Object(v.generateColor)(d.color.value(),d.transparency.value()),_=(f=l._calcCoordsForShape(h,g,u,i.price,n,t,e)).x,y=f.y,w=f.direction,c){case"circle":case"square":l._data.push({shape:c,color:p,direction:w,point:new a.Point(_+r,y),size:u});break;case"arrowUp":case"arrowDown":case"arrowRight":case"arrowLeft":l._data.push({shape:c,color:p,point:new a.Point(_+r,y),size:u})}})}))},e.prototype._calcCoordsForShape=function(t,e,i,r,a,s,l){var d=Math.round(l.indexToCoordinate(e));switch(t){case o.MarkLocation.Absolute:return{x:d,y:s.priceToCoordinate(Object(n.ensureDefined)(r),a),direction:""};case o.MarkLocation.AbsoluteDown:return{x:d,y:s.priceToCoordinate(Object(n.ensureDefined)(r),a),
direction:"down"};case o.MarkLocation.AbsoluteUp:return{x:d,y:s.priceToCoordinate(Object(n.ensureDefined)(r),a),direction:"up"};case o.MarkLocation.AboveBar:return{x:d,y:this._locationToY(t,e,Math.floor(2*i/l.barSpacing())+1),direction:"up"};case o.MarkLocation.BelowBar:return{x:d,y:this._locationToY(t,e,Math.floor(2*i/l.barSpacing())+1),direction:"down"};default:return w.logWarn("Bad location value: "+t),{x:d,y:this._locationToY(o.MarkLocation.AbsoluteUp,e),direction:"up"}}},e}(_.a)},rvCT:function(t,e,i){"use strict";var r,n,a,o,s,l,d,h,c,u,p,f;i.r(e),i.d(e,"LinearRegressionPaneView",function(){return f}),r=i("mrSG"),n=i("Eyy1"),a=i("aO4+"),o=i("VdBB"),s=i("Tmoa"),l=i("Zy3/"),d=i("NN6M"),h=i("pJOz"),c=i("qgcf"),u=i("a7Ha"),p=i("zDbI"),f=function(){function t(t,e){this._invalidated=!0,this._lines=[],this._pearsonsTextRenderer=new c.TextRenderer,this._pearsons=null,this._model=t,this._source=e}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,a,c,u,p,f,_,v,y,w;for(this._invalidated&&(this._updateImpl(),this._invalidated=!1),t=new l.CompositeRenderer,i=[],a=0,c=e=[this._lines[1],this._lines[0],this._lines[2]];a<c.length;a++)(u=c[a])&&i.push(u);for(p=1;p<i.length;p++)f={points:[e[p].floatPoints[0],e[p].floatPoints[1],e[p-1].floatPoints[0],e[p-1].floatPoints[1]],color:e[p].color,width:this._model.timeScale().width(),height:Object(n.ensureNotNull)(this._source.priceScale()).height(),linewidth:e[p].linewidth,linestyle:e[p].linestyle,extendleft:!1,extendright:e[p].extendright,backcolor:e[p].color,transparency:this._source.properties().styles.transparency.value(),skipLines:!0,fillBackground:!0,showMidline:!1},(_=new d.ParallelChannelRenderer(new o.HitTestResult(o.HitTestResult.REGULAR),new o.HitTestResult(o.HitTestResult.REGULAR))).setData(f),t.append(_);for(v=0,y=function(t){return t.map(function(t){var e=Object(r.__assign)({},t);return e.color=Object(s.resetTransparency)(e.color),e})}(this._lines);v<y.length;v++)w=y[v],(_=new h.TrendLineRenderer).setData(w),_.setHitTest(new o.HitTestResult(o.HitTestResult.REGULAR)),t.append(_);return this._pearsons&&(this._pearsons.color=Object(s.resetTransparency)(this._pearsons.color),this._pearsonsTextRenderer.setData(this._pearsons),t.append(this._pearsonsTextRenderer)),t},t.prototype._updateImpl=function(){var t,e,i,r,o,s,l,d,h,c,f,_,v,y,w,g,x,T,m,b,R,S,P,C,L;if(this._lines=[],this._pearsons=null,this._source.properties().visible.value()&&(t=this._model.timeScale(),e=this._source.priceScale(),i=this._model.mainSeries().firstBar(),e&&!e.isEmpty()&&!t.isEmpty()&&i&&(r=this._source.startIndex(),o=this._source.endIndex(),null!==r&&null!==o))){for(s=[this._source.baseLine(),this._source.downLine(),this._source.upLine()],l=Math.round(t.indexToCoordinate(r)),d=Math.round(t.indexToCoordinate(o)),c=[(h=this._source.properties()).styles.baseLine,h.styles.downLine,h.styles.upLine],f=i[TradingView.CLOSE_PLOT],_=0;_<s.length;_++)c[_].visible.value()&&(v=Object(n.ensureNotNull)(s[_]).startPrice,y=Object(n.ensureNotNull)(s[_]).endPrice,
void 0!==v&&void 0!==y&&(w=e.priceToCoordinate(v,f),g=e.priceToCoordinate(y,f),x=new a.Point(l,w),T=new a.Point(d,g),m=c[_].color.value(),b=c[_].linewidth.value(),R=c[_].linestyle.value(),S={floatPoints:[x,T],width:this._model.timeScale().width(),height:Object(n.ensureNotNull)(this._source.priceScale()).height(),color:m,linewidth:b,linestyle:R,extendleft:!1,extendright:h.styles.extendLines.value(),leftend:u.LineEnd.Normal,rightend:u.LineEnd.Normal},this._lines.push(S)));P=Object(n.ensureNotNull)(this._source.downLine()),h.styles.showPearsons.value()&&void 0!==P.startPrice&&(C=e.priceToCoordinate(P.startPrice,f),L=new a.Point(l,C),this._pearsons={points:[L],text:""+this._source.pearsons(),color:h.styles.downLine.color.value(),vertAlign:"top",horzAlign:"center",font:p.CHART_FONT_FAMILY,offsetX:0,offsetY:4,fontsize:12})}},t}()},tSCe:function(t,e,i){"use strict";function r(){}var n=i("Hr11"),a=n.min,o=n.max,s=i("972a").MarkLocation;r.prototype._locationToY=function(t,e,i){var r,n,l,d,h,c,u;switch(i||(i=0),r=[],n=this._provider.priceScale(),t){case s.AboveBar:l=TradingView.HIGH_PLOT;break;case s.BelowBar:l=TradingView.LOW_PLOT}for(d=this._provider.firstValue(),i>=1&&(i-=1),h=-i;h<=i;h++)null!==(c=this._provider.series().bars().valueAt(e+h))&&(u=c[l],r.push(n.priceToCoordinate(u,d)));switch(t){case s.AboveBar:return a(r)-15;case s.BelowBar:return o(r)+15}},t.exports=r}}]);