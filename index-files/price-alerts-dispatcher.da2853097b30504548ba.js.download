(window.webpackJsonp=window.webpackJsonp||[]).push([["price-alerts-dispatcher","screener-alerts"],{"+slJ":function(e,t,r){"use strict";function n(e){return i().then(function(t){return t.hasUserAccessToDataSource(e)})}function o(e){return i().then(function(t){return t.filterAccessibleDataSources(e)})}r.d(t,"b",function(){return n}),r.d(t,"a",function(){return o});var i=function(){return Promise.all([r.e(123),r.e(19),r.e(23),r.e(28),r.e(30),r.e(62),r.e(63),r.e(60),r.e(55),r.e(67),r.e(79),r.e(76),r.e(80),r.e(83),r.e(88),r.e(100),r.e(116),r.e(133),r.e("alert-utils-has-user-access-to-data-source")]).then(r.bind(null,"SlIP"))}},"15Qe":function(e,t,r){"use strict";function n(e){var t=e.shortSymbol(),r="fired:price:"+e.id;return{id:r,fired:new Date(e.get("fireTime")),type:i.AlertNotificationType.Fired,desktopNotificationTitle:window.t("Alert on __title__",{title:t}),description:e.get("description"),title:t,alertId:Number(e.get("alertId")),alertCategory:s.AlertCategory.Price,eventId:e.get("id"),notifyWith:{email:!!e.get("sendEmail"),popup:!!e.get("showPopup"),sms:!!e.get("sendSms"),sound:!!e.get("playSound")},soundParams:{duration:e.get("soundDuration")||0,name:e.get("soundFile")||a.DEFAULT_SOUNDS.alert}}}function o(e){var t,r;return"fire_control"===e.reason?(t=6e4,r=new Date(Math.round(Date.now()/t)*t),{id:"fire_control:price:"+e.alertId+":"+r.getTime()/1e3,fired:r,type:i.AlertNotificationType.FireControl,desktopNotificationTitle:e.shortSymbol+window.t("The alert is triggered too often"),description:e.description,title:e.shortSymbol,alertId:e.alertId,alertCategory:s.AlertCategory.Price,notifyWith:{popup:!0}}):null}var i,s,a;r.r(t),r.d(t,"getNotificationFromPriceEvent",function(){return n}),r.d(t,"getNotificationFromAlertStopped",function(){return o}),r("YFKU"),i=r("JZcM"),s=r("IWHC"),a=r("hp/T")},"1UCy":function(e,t,r){"use strict";var n;r.r(t),r.d(t,"AlertEditorAbortReason",function(){return n}),function(e){e[e.AlertIsInvalid=0]="AlertIsInvalid",e[e.AlertsDispatcherNotFound=1]="AlertsDispatcherNotFound",e[e.AlertsMaintenance=2]="AlertsMaintenance",e[e.ChartModelNotFound=3]="ChartModelNotFound",e[e.MainSeriesIsATR=4]="MainSeriesIsATR",e[e.MainSeriesIsOffline=5]="MainSeriesIsOffline",e[e.MainSeriesIsInReplay=6]="MainSeriesIsInReplay",e[e.SourceIsDangerous=7]="SourceIsDangerous",e[e.SymbolIsInvalid=8]="SymbolIsInvalid",e[e.SymbolInfoTimeout=9]="SymbolInfoTimeout",e[e.UnsupportedResolution=10]="UnsupportedResolution",e[e.IsAlreadyPresent=11]="IsAlreadyPresent"}(n||(n={}))},"2O5g":function(e,t,r){"use strict";function n(e){var t=Object(i.getAlertDialogType)(e),n=e.dataSourceHub?e.dataSourceHub.mainSeries():null,c=e.onAborted||function(){},d=Object(i.shouldAbortAlertEditor)(n,t);if(null!==d)return u.logError("Aborted: "+a.AlertEditorAbortReason[d]),Object(i.showAbortExplainingDialog)(d,t),void c(d);Promise.all([Promise.all([r.e(36),r.e(19),r.e(55),r.e(114),r.e(144),r.e("alert-editor-impl")]).then(r.t.bind(null,"Hlqb",7)),Object(s.getPriceAlertsDispatcher)(),function(e){
return(e.series?Object(l.b)(e.series):Promise.resolve(!0)).then(function(t){var r=Object(o.__assign)({},e);return t||(delete r.series,delete r.value),r})}(e)]).then(function(e){var t=e[0],r=e[1],n=e[2];new t.AlertEditor(r,n)})}var o,i,s,a,l,c,u;r.r(t),r.d(t,"invokeAlertEditor",function(){return n}),o=r("mrSG"),i=r("PlME"),s=r("JUY+"),a=r("1UCy"),l=r("+slJ"),c=r("uOxu"),u=Object(c.getLogger)("Alerts.Price.InvokeAlertEditor")},"2qdo":function(e,t,r){"use strict";function n(){return Promise.all([r.e("vendors_embed"),r.e("dialogs-core"),r.e(0),r.e(1),r.e(3),r.e(7),r.e(220),r.e(6),r.e(13),r.e(19),r.e("alert-notifier")]).then(r.bind(null,"Z59a")).then(function(e){return e.createAlertNotifier()})}r.r(t),r.d(t,"createAlertNotifier",function(){return n})},"3DsO":function(e,t,r){"use strict";function n(){Object(o.createGoProDialog)({feature:"alertsNoExpiration"}).then(function(e){e.open()})}r.r(t),r.d(t,"showGoProInfExpDialog",function(){return n});var o=r("s4+V")},"3Tqy":function(e,t,r){"use strict";(function(t,n){function o(){var e=this;this._loading={},this._alertVersioning=new S,this._lastGenIds={},this._notifierPromise=null,this._onPushStreamMessage=new m.default,this._onPushStreamStatusChanged=function(t){t===y.ConnectionStatus.Open&&e._onPushStreamMessage.fire({source:"host",data:{m:"pushstream_ready"}})},this.alerts=new(t.Collection.extend({model:x})),this.events=new(t.Collection.extend({comparator:function(e,t){var r=e.get("fireTime"),n=t.get("fireTime");return r&&n?n-r:r?n?void 0:1:-1},model:b})),this._attachHandlers()}function i(e){e.forEach(function(e){return e.set("selected",!1)})}function s(e,t){e.forEach(function(e){e!==t&&e.set("selected",!1)})}function a(e){var t=new Date;e.get("expired")<t&&(t.setMonth(t.getMonth()+1),e.set("expired",t))}var l,c=Object.assign||function(e){var t,r,n;for(t=1;t<arguments.length;t++)for(n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e},u=r("brCa"),d=r("0dm4"),f=r("15Qe"),p=r("JZcM"),_=r("IWHC"),h=r("jA5l"),v=r("aIyQ"),m=(l=v)&&l.__esModule?l:{default:l},y=r("PfBM"),g=r("2O5g").invokeAlertEditor,A=r("1UCy").AlertEditorAbortReason,b=r("sg6D"),S=r("Evi4").AlertVersioning,x=r("4pku").Alert,I=r("nmnj"),w=r("dfhE"),E=r("TxTq"),P=r("PC8g").trackEvent,D=r("+GxX").isFeatureEnabled,O=r("NP3r").enabled,T=r("bKsZ").ProductFeatures,C=r("oNDq").createConfirmDialog,N=r("uOxu").getLogger("Alerts.Price.Dispatcher"),R=r("hWRP").sendRequest,M=r("2qdo").createAlertNotifier,F=r("4BMm").server2clientParams,q=r("4BMm").client2serverParams,j=r("xlbu").telemetry,k=r("Zdjc").showGoProAlertsTrueSmsDialog,U=r("gdgp").showGoProMaxAlertsDialog,W=r("3DsO").showGoProInfExpDialog,B=r("zL88").showWarningAlertsMaxTotalCountExceeded,L="cancelled: new alert already generating",J=r("flg1").showAlertsMaintenanceDialog,V=r("8woN");o.checkProPermissions=function(e){return e.get("sendTrueSms")&&!O(T.ALERTS_TRUE_SMS)?(k(),!1):e.get("noExpiration")&&!O(T.ALERTS_NO_EXPIRATION)?(W(),!1):"string"!=typeof e.get("webhookUrl")||O(T.ALERTS_WEBHOOK)?!!(0,
d.canPlaceAlertOnResolution)(e.get("resolution"))||((0,d.showUnsupportedResolutionDialog)(),!1):((0,h.showGoProAlertsWebhookDialog)(),!1)},o.getAnalyticsHeaders=function(e,t){return{"X-Analytics-Price-Alert-Condition":String(e),"X-Analytics-Price-Alert-Action-Source":String(t)}},o.prototype._onLoginStateChange=function(e){is_authenticated?(e||setTimeout(this.showOfflineEvents.bind(this),1),this._refreshPushStream()):(this.alerts.reset(),this.events.reset())},o.prototype._attachHandlers=function(){function e(e){var r,n,o=t.chartWidget(),i=o?o.model():null;i&&(r=i.hoveredSource(),e.set("hovered",r&&r.hasAlert&&r.hasAlert.value()&&r.alertId()===e.id),n=i.selection().sources().some(function(t){return t.hasAlert.value()&&t.alertId()===e.id}),e.set("selected",n))}var t=this;loginStateChange.subscribe(this,this._onLoginStateChange.bind(this)),this._onLoginStateChange(),t.alerts.on("add",function(r){e(r),r.isDrawing()&&function(e){var r,n,o=t.chartWidget()&&t.chartWidget().model();o&&(r=e.get("extra").drawing(),(n=o.dataSourceForId(r.id))&&!n.hasAlert.value()&&n.canHasAlert()&&n.setAlert(e.id))}(r)}).on("change:selected",function(e,r,n){if(r){var o=t.alerts;i(t.events),s(o,e)}}).on("change:id",e).on("change:hovered",function(e,r,n){var o=t.alerts;r&&o.forEach(function(t){t===e&&t.set("hovered",!0)})}).on("destroy",function(e){e.isNew()||t.events.where({alertId:e.id}).forEach(function(e){e.destroy()})}),t.events.on("change:selected",function(e,r,n){var o=t.events.models;r&&(i(t.alerts),s(o,e))})},o.prototype.showOfflineEvents=function(){var e,t,r;user&&!n.isEmpty(user.alerts_offline_data)&&(e=this,t=user.alerts_offline_data.fired,r=user.alerts_offline_data.stopped,this._getAlertNotifier().then(function(o){t&&Object.keys(t).forEach(function(r){var i,s,a;r=parseInt(r),i=t[r].event,n.isEmpty(i)||(i.alertId||(i.alertId=r),i.hasOwnProperty("eventId")||(i.eventId=i.id),i=new b(F(i)),(s=(0,f.getNotificationFromPriceEvent)(i)).count=t[r].events_count,o.addNotification(s,!0),e.events.add(i),i.trigger("fired",i),void 0!==(a=e.alerts.get(i.alertId))&&a.trigger("fired"))}),r&&Object.keys(r).forEach(function(e){var t,n;e=parseInt(e),t=r[e],n=(0,f.getNotificationFromAlertStopped)({alertId:e,description:t.description,reason:"fire_control",shortSymbol:V.shortName(t.symbol)}),o.addNotification(n,!0)}),delete user.alerts_offline_data}))},o.prototype._refreshPushStream=function(){E.off("alert"),E.offStatus(this._onPushStreamStatusChanged),is_authenticated&&(E.on("alert",this._onMessage.bind(this)),E.onPrivateStatus(this._onPushStreamStatusChanged))},o.prototype._onMessage=function(e){var t,r,n,o,i,s=this,a={};if(e)switch(N.logNormal(e),t=JSON.parse(e),this._onPushStreamMessage.fire({source:"alert",data:t}),r=t.m,a=F(t.p),r){case"alert_running":s._alertVersioning.cancelPossibleExtraUpdate(a.id),s._alertVersioning.migrate(a).then(function(e){(n=s.alerts.get(e.id))?void 0!==n.previous("id")?n.set(e):(s.alerts.remove(n),s.alerts.add(e,{at:0})):s.alerts.add(e,{at:0})});break;case"alert_stopped":(n=s.alerts.get(a.id))&&(i={active:!1,
stopReason:a.stopReason,error:a.error},n.set(i)),"fire_control"===a.stopReason&&s._getAlertNotifier().then(function(e){s.requestAlert(a.id,{success:function(t){var r=(0,f.getNotificationFromAlertStopped)({alertId:t.id,description:t.get("description"),reason:a.stopReason,shortSymbol:t.shortSymbol()});r&&e.addNotification(r)}})});break;case"alert_deleted":s._alertVersioning.cancelPossibleExtraUpdate(a.id),(n=s.alerts.get(a.id))&&n.destroy();break;case"event":a.hasOwnProperty("eventId")||(a.eventId=a.id),this._getAlertNotifier().then(function(e){var t,r;o=new b(a),s.events.add(o),t=(0,f.getNotificationFromPriceEvent)(o),e.addNotification(t),o.trigger("fired",o),void 0!==(r=s.alerts.get(a.alertId))&&r.trigger("fired"),this.sendRequest({method:"clear_shown_events",preventMaintenanceDialog:!0,params:{alerts_ids:[a.alertId]}})}.bind(this))}},o.prototype.cloneAlert=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.isDrawing())return"function"==typeof r.error&&r.error("Cannot clone alert with drawing"),void("function"==typeof r.complete&&r.complete());a(t=e.getLocalClone()),function(e,t){function r(){e.set("highlighted",!0),o=setTimeout(n,t)}function n(){e.unset("highlighted"),clearTimeout(o),o=void 0,e.off("change:id",r),e.off("destroy",n)}var o=void 0;e.once("change:id",r),e.once("destroy",n)}(t,1e3),this.alerts.add(t),this.createAlert(t,r)},o.prototype.createLocalAlert=function(e,t){var r,n=this;return t&&function(e){var t,r,n,o;if(!e)throw new Error("Can't create alert. 'params' is required");for(r=[],n=(t=["symbol","resolution","expired","autoDeactivation","sendEmail","sendSms","sendTrueSms","showPopup","playSound","description","script"]).length-1;n>=0;n--)(o=t[n])in e||r.push(o);r.length&&N.logError("[Alerts] Can't create alert. "+r.join(" ,")+(1===r.length?" is":" are")+" required")}(e),r=new x(e),n.alerts.add(r),r},o.prototype.createAlert=function(e,t){function r(e,r){"function"==typeof t.complete&&t.complete(),"function"==typeof t.error&&t.error(e,r)}var n,i,s=this;if(t=t||{},e instanceof x){if(o.checkProPermissions(e))return n=Date.now(),i=e.prepareToSend(),s._generateScriptWithCancellation(e).then(function(r){return i.script=r,s.sendRequest({headers:o.getAnalyticsHeaders(e.get("extra").conditionId(),t.actionSource),method:"create_alert",params:i,success:function(r){(r=F(r||{})).active=!0,e.set(r),s._gaTrackEvent("create",e),"function"==typeof t.success&&t.success(e)},complete:function(){var r=Date.now()-n;j.sendReport("alerts","full_time_frame",{value:r}),"function"==typeof t.complete&&t.complete(e)},error:t.error})}).catch(function(e){if(e===L)return N.logNormal("Alert generation is cancelled because next alert generation is started"),L;"function"==typeof t.error&&t.error("Can't generate source code: "+e),"function"==typeof t.complete&&t.complete()});r("cannot create alert with current pro plan",!0)}else r("'alert' should be instance of Alert")},o.prototype.stopAlert=function(e,t){var r,n,o,i=this;t=t||{},e instanceof x?o=(n=e).get("id"):(o=e,n=i.alerts.get(o)),
o?(t.showConfirm&&(r=$.t("Do you really want to stop Alert '{0}' ?").format(n?n.title():o)),i.sendRequest({method:"stop_alert",params:{id:o},success:function(){i._gaTrackEvent("stop"),n&&n.set("active",!1),"function"==typeof t.success&&t.success()},error:t.error,complete:t.complete,confirmation:r})):N.logError("Alert id is required to stop alert")},o.prototype.stopAllAlerts=function(e){var t,r,n=this;t={cross_int:!0},(e=e||{}).symbol&&(t.symbol=e.symbol),e.resolution&&(t.resolution=e.resolution),e.showConfirm&&(r=e.symbol||e.resolution?$.t("Do you really want to stop filtered Alerts?"):$.t("Do you really want to stop all Alerts?")),n.sendRequest({method:"stop_all",params:t,success:function(){n._gaTrackEvent("stop_all"),n.alerts.each(function(e){t.symbol&&t.symbol!==e.get("symbol")||t.resolution&&t.resolution!==e.get("resolution")||e.set("active",!1)}),"function"==typeof e.success&&e.success()},confirmation:r,error:e.error,complete:e.complete})},o.prototype.deleteAlert=function(e,t){var r,n,o,i=this;if(t=t||{},e instanceof x?o=(n=e).get("id"):(o=e,n=i.alerts.get(o)),n&&n.isNew())return n.destroy(),void("function"==typeof t.complete&&t.complete());o?(t.showConfirm&&(r=$.t("Do you really want to delete Alert '{0}' ?").format(n?n.title():o)),i.sendRequest({method:"delete_alert",params:{id:o},success:function(){i._gaTrackEvent("delete"),"function"==typeof t.success&&t.success(),n&&n.destroy()},error:t.error,cancel:t.cancel,complete:t.complete,confirmation:r})):N.logError("Alert id is required to delete alert")},o.prototype.deleteAllAlerts=function(e){var t,r,n=this;t={crossInterval:!0},(e=e||{}).symbol&&(t.symbol=e.symbol),e.resolution&&(t.resolution=e.resolution),"boolean"==typeof e.active&&(t.active=e.active),e.showConfirm&&(r=!1!==t.active||t.symbol||t.resolution?t.symbol||t.resolution||t.active?$.t("Do you really want to delete filtered Alerts?"):$.t("Do you really want to delete all Alerts?"):$.t("Do you really want to delete all inactive Alerts?")),n.sendRequest({method:"delete_all",params:t,success:function(){var r,o={};for(n._gaTrackEvent("delete_all"),t.symbol&&(o.symbol=t.symbol),t.resolution&&(o.resolution=t.resolution),"boolean"==typeof t.active&&(o.active=t.active),r=n.alerts.findWhere(o);r;)r.destroy(),r=n.alerts.findWhere(o);"function"==typeof e.success&&e.success()},error:e.error,complete:e.complete,confirmation:r})},o.prototype.restartAlert=function(e,t){var r,n,i,s,l=this;if(t=t||{},e instanceof x?r=e:(n=e,r=l.alerts.get(n)),r)return a(r),o.checkProPermissions(r)?(i=Date.now(),s=r.prepareToSend(),l._generateScriptWithCancellation(r).then(function(e){return s.script=e,l.sendRequest({headers:o.getAnalyticsHeaders(r.get("extra").conditionId(),t.actionSource),method:"restart_alert",params:s,success:function(){l._gaTrackEvent("restart",r),r.set("active",!0),"function"==typeof t.success&&t.success(r)},complete:function(){var e=Date.now()-i;j.sendReport("alerts","full_time_frame",{value:e}),"function"==typeof t.complete&&t.complete(r)},error:t.error})}).catch(function(e){
if(e===L)return N.logNormal("Alert generation is cancelled because next alert generation is started"),L;"function"==typeof t.error&&t.error("Can't generate alert source code for alert #"+n)})):("function"==typeof t.complete&&t.complete(),void("function"==typeof t.error&&t.error("cannot restart alert with current pro plan",!0)));l.requestAlert(n,{success:function(e){e?l.restartAlert(e,t):("function"==typeof t.error&&t.error("Can't find alert "+n),"function"==typeof t.complete&&t.complete())}})},o.prototype._generateScriptWithCancellation=function(e){var t,r,n=this;return null==n._lastGenIds[e.cid]&&(n._lastGenIds[e.cid]=0),n._lastGenIds[e.cid]++,t=n._lastGenIds[e.cid],r=function(){return n._lastGenIds[e.cid]!==t},new Promise(function(t,r){var n=e.get("extra"),o="";if(n.isValid()||(o="Can't generate alert on invalid AlertExtra"),o)return N.logError(o),void r(o);I.generateAlert(JSON.stringify(n.toGenAlertJSON(e.get("description")))).then(function(e,r){t(r)},r)}).then(function(t){return r()?Promise.reject(L):(e.set("script",t),t)})},o.prototype.restartAllAlerts=function(e){var t,r,n=this;t={crossInterval:!0},(e=e||{}).symbol&&(t.symbol=e.symbol),e.resolution&&(t.resolution=e.resolution),"boolean"==typeof e.active&&(t.active=e.active),e.showConfirm&&(r=e.symbol||e.resolution?$.t("Do you really want to restart filtered alerts?"):$.t("Do you really want to restart all inactive alerts?")),n.alerts.every(o.checkProPermissions)&&n.sendRequest({method:"restart_all",params:t,success:function(){n._gaTrackEvent("restart_all"),n.alerts.each(function(e){t.symbol&&t.symbol!==e.get("symbol")||t.resolution&&t.resolution!==e.get("resolution")||e.set("active",!0)}),"function"==typeof e.success&&e.success()},error:e.error,complete:e.complete,confirmation:r})},o.prototype.requestAlert=function(e,t){function r(e){var r=i.alerts.get(o)||null;return(r||e)&&("function"==typeof t.success&&t.success(r),"function"==typeof t.complete&&t.complete()),!!r}function n(){i.sendRequest({method:"get_alert",preventMaintenanceDialog:!0,params:{id:o},success:function(e){var r,n=e.alert;n=F(n),i._alertVersioning.migrate(n).then(function(e){r=new x(e),i.alerts.add(r),"function"==typeof t.success&&t.success(r)}).catch(function(e){"function"==typeof t.error&&t.error(e)})},complete:t.complete,error:function(r){"function"==typeof t.error?t.error(r):N.logError("Error in getting alert "+e+(r?": "+r:""))}})}var o,i=this;t=t||{},o=parseInt(e),!0===t.fromCache?r(!0):!1===t.fromCache?n():r()||n()},o.prototype.getAlertSync=function(e){return this.alerts.get(e)||null},o.prototype.requestList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(t){"function"==typeof e.error&&e.error(t)},r=this,n=e.sort||{by:"id",asc:!1},o={symbol:e.symbol,resolution:e.resolution,limit:e.limit||100,offset:e.offset||0,sortBy:n.by,sortDirection:n.asc?"asc":"desc",active:e.active,includeCrossInterval:void 0===e.includeCrossInterval||e.includeCrossInterval};r.sendRequest({method:"list_alerts_2",preventMaintenanceDialog:!0,params:o,success:function(n){var o,i
;if(!n.alerts||!Array.isArray(n.alerts))return o="Not valid params in alert list response",N.logError(o),void t(o);i=n.alerts.map(F).map(function(e){return r._alertVersioning.migrate(e)}),Promise.all(i).then(function(t){var n=t.map(function(e){return new x(e)});r.alerts.set(n,{remove:!1}),"function"==typeof e.success&&e.success(n)}).catch(t)},error:e.error,complete:e.complete})},o.prototype.requestFullList=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=function(e){"function"==typeof t.error&&t.error(e)},n=function(e){"function"==typeof t.success&&t.success(e)},o=function(){"function"==typeof t.complete&&t.complete()};if(this._fullListWasRequested)return n(this.alerts.models),void o();this.sendRequest({method:"list_alerts",preventMaintenanceDialog:!0,params:{limit:2e3},success:function(t){var o,i;if(!t.alerts||!Array.isArray(t.alerts))return o="Not valid params in alert list response",N.logError(o),void r(o);i=t.alerts.map(F).map(function(t){return e._alertVersioning.migrate(t)}),Promise.all(i).then(function(t){var r=t.map(function(e){return new x(e)});e.alerts.set(r),e._fullListWasRequested=!0,n(r)}).catch(r)},error:t.error,complete:o})},o.prototype.requestEventList=function(e){var t,r,n=this;t=function(t){var r=t.events;r&&$.isArray(r)?(r=$.map(r,function(e){var t;return e.hasOwnProperty("eventId")||(e.eventId=e.id),e=F(e),t=new b(e),n.events.add(t),t}),"function"==typeof e.success&&e.success(r)):console.warn("[Alerts] Not valid params in event list response")},r={sym:(e=e||{}).symbol,res:e.resolution&&e.resolution.toString?e.resolution.toString():void 0,limit:e.limit,before:e.before,inc_cross_int:void 0===e.includeCrossInterval||e.includeCrossInterval},e.aid&&(r.aid=e.aid),this.sendRequest({method:"list_events",preventMaintenanceDialog:!0,params:r,success:t,error:e.error,complete:e.complete})},o.prototype.deleteAllEvents=function(e){var t=this;e=e||{},t.sendRequest({method:"delete_events",success:function(){for(var r=t.events.first();r;)r.destroy(),r=t.events.first();"function"==typeof e.success&&e.success()},error:e.error,complete:e.complete})},o.prototype.sendRequest=function(e){function t(){return R({method:a,params:l,noCache:e.noCache,headers:e.headers}).then(r).catch(n)}function r(t){if("function"==typeof e.success){var r=F(t);e.success(r)}return o(),r}function n(t){var r=!1;return"max_alerts_count_exceeded"===t?(U(),r=!0):"max_total_alerts_count_exceeded"===t?(B(),r=!0):"pro_plan_expired"===t?(W(),r=!0):"maintenance"===t&&(e.preventMaintenanceDialog||(setTimeout(J,0),r=!0)),"function"==typeof e.error?e.error(t,r):"maintenance"===t?N.logNormal("Alerts maintenance"):t&&N.logError("Reason: "+t),o(),t}function o(){"function"==typeof e.complete&&e.complete()}function i(){"function"==typeof e.cancel&&e.cancel()}var s,a=e.method,l=q(e.params);return function(e,t){var r;["create_alert","restart_alert"].includes(e)&&"strategy"===((r=t.extra&&JSON.parse(t.extra))&&r.condition).id&&(t.alert_type="strategy")}(a,l),D("alerts-maintenance")?(n("maintenance"),o(),
Promise.reject("maintenance")):e.confirmation?(s=!0,new Promise(function(r,n){C({content:e.confirmation,title:$.t("Alert"),type:"modal"}).then(function(e){e.actionLoader("yes"),e.on("action:yes",function(e){e.actionLoader("yes","start");var n=t();n.then(function(t){return e.actionLoader("yes","stop"),e.close(),t}).catch(function(t){return e.actionLoader("yes","stop"),t}),r(n),s=!1}),e.on("action:no",function(){i(),o(),s=!1}),e.on("afterClose",function(){s&&i()}),e.open()})})):t()},o.prototype.setChartWidgetCollection=function(e){this._chartWidgetCollection=e},o.prototype.chartWidget=function(){var e=null;return this._chartWidgetCollection&&(e=this._chartWidgetCollection.activeChartWidget.value()||null),e},o.prototype._gaTrackEvent=function(e,t){var r;P("alert",e),"create"===e&&t instanceof x&&(r=t.get("extra"),P("alert","create__style",function(e){var t=e&&e.getMainSeries(),r=t&&t.getStyle&&t.getStyle();return r&&w.STYLE_SHORT_NAMES.hasOwnProperty(r)?w.STYLE_SHORT_NAMES[r]:"unknown"}(r)),P("alert","create__condition",function(e){var t=e.conditionId();return e.prepareAlertConditions()[t]&&(t="pine_condition"),t||"unknown"}(r)),P("alert","create__frequency",t.get("frequency")||"unknown"),t.isPrice()?P("alert","create__on","price"):t.isDrawing()?P("alert","create__on","drawing"):t.isMoving()?P("alert","create__on","moving"):r.band()||r.upperBand()||r.lowerBand()?P("alert","create__on","study"):P("alert","create__on","unknown"))},o.prototype.openCreateDialog=function(e){g(c({type:"create_alert"},e))},o.prototype.openEditDialog=function(e,t){var r,n,o,i=this;o=function(e){return t.onAborted&&t.onAborted(e)},!(t=t||{}).dataSourceHub&&i.chartWidget()&&(t.dataSourceHub=i.chartWidget().model().model()),e instanceof x?r=e:(n=e,r=i.alerts.get(n)),r?(t=$.extend(t,{alert:r,type:"edit_alert"}),g(t)):n?i.requestAlert(n,{success:function(e){i.openEditDialog(e,t)},error:function(e){"not_exists"===e&&(0,u.showNoticeDialog)({type:"modal",title:window.t("Alert"),content:window.t("Alert does not exist.")}),"function"==typeof t.error&&t.error(e),o(A.AlertIsInvalid)}}):(console.error("[Alerts] alert id is required to edit alert"),o(A.AlertIsInvalid))},o.prototype.subscribeToPushStream=function(e){this._onPushStreamMessage.subscribe(null,e)},o.prototype.unsubscribeFromPushStream=function(e){e?this._onPushStreamMessage.unsubscribe(null,e):this._onPushStreamMessage.unsubscribeAll(null)},o.prototype._getAlertNotifier=function(){if(null===this._notifierPromise){var e=this;this._notifierPromise=M().then(function(t){return t.onEditAlert.subscribe(null,function(t,r,n){r===_.AlertCategory.Price&&e.openEditDialog(t,c({},n,{actionSource:"alert_notifier_edit"}))}),t.onRestartAlert.subscribe(null,function(t,r,n){r===_.AlertCategory.Price&&e.restartAlert(t,c({},n,{actionSource:"alert_notifier_restart"}))}),t.onNotificationsViewed.subscribe(null,function(t){var r,n;for(r=0;r<t.length;r++)(n=t[r]).alertCategory===_.AlertCategory.Price&&n.type===p.AlertNotificationType.FiredPrice&&e.events.get(t.eventId)&&event.trigger("popupClosed",event)}),t})}
return this._notifierPromise},e.exports.AlertsDispatcher=o}).call(this,r("q1z7"),r("F/us"))},"4BMm":function(e,t){function r(e,t){var r={};return e?(Object.keys(e).forEach(function(n){var o=t(n),i=e[n];r[o]=i}),r):e}var n={active:"active",aid:"alertId",alerts:"alerts",bar_time:"barTime",create_t:"createTime",cross_int:"crossInterval",deact:"autoDeactivation",desc:"description",email:"sendEmail",error:"error",events:"events",exp:"expired",fire_time:"fireTime",inc_cross_int:"includeCrossInterval",inf_exp:"noExpiration",internal_sym:"symbolInternal",popup:"showPopup",reason:"reason",res:"resolution",script_deps:"scriptDeps",script:"script",sms:"sendSms",true_sms:"sendTrueSms",snd:"playSound",push:"sendPush",snd_duration:"soundDuration",snd_file:"soundFile",sort_by:"sortBy",sort_dir:"sortDirection",start_t:"startTime",stop_t:"stopTime",stop:"stopReason",sym:"symbol",web_hook:"webhookUrl",inst_id:"instanceId"},o=function(){var e={};return Object.keys(n).forEach(function(t){var r=n[t];e[r]=t}),e}();t.server2clientParams=function(e){return r(e,function(e){return n[e]||e})},t.client2serverParams=function(e){return r(e,function(e){return o[e]||e})}},Evi4:function(e,t,r){"use strict";function n(){this._extraUpdateScheduler=new y}var o=r("C2JW").AlertExtra,i=r("0YCj"),s=r("K4L1"),a=r("cBZt").extractStudyId,l=r("TcSq").extractPineId,c=r("xD5v").prepareCallStudyArgs,u=r("0waE"),d=r("uOxu").getLogger("Alerts.Versioning"),f=r("nmnj"),p=r("nXyu"),_=r("YJLw"),h=r("dn9U"),v=r("n5al"),m=r("PjMa").DataSourceDangerReason,y=r("uXxt").AlertExtraUpdateScheduler,g=r("+GxX").isFeatureEnabled;n.version_10_tv_6611_1a_refactoring=10,n.version_11_tv_6611_1b_refactoring=11,n.version_12_tv_6888_fix_plot_index=12,n.version_13_tv_4164_source_code_protection=13,n.version_14_tv_4164_source_code_protection_fix=14,n.version_15_tv_8068_fix_main_series_resolution=15,n.version_16_jv_298_remove_callstudy=16,n.version_17_jv_646_fix_mixed_inputs=17,n.version_18_tv_10636_price_format=18,n.version_19_tv_11267_fix_frequency_options=19,n.version_20_tv_14463_extract_dividends_adjustment_from_symbol_string=20,n.version_21_tv_14886_add_alert_dangerous_source_check=21,n.prototype.migrate=function(e,t){var r,n,i;return t=Object.assign({sendExtraUpdate:g("alerts-send-extra-update")},t),e&&e.extra?(r=JSON.parse(e.extra))&&!Object.keys(r).length&&r.constructor===Object?(delete e.extra,Promise.resolve(e)):(n=Promise.resolve(e),(i=null==r.version||r.version<o.VERSION)&&(n=this._patchAlert(r,e)),n=n.then(function(e){var r=JSON.parse(e.extra);return r.version<o.VERSION?d.logError("Alert version is less than current"):r.version>o.VERSION?d.logNormal("Alert version is greater than current"):i&&t.sendExtraUpdate&&this._extraUpdateScheduler.scheduleUpdate({id:e.id,instanceId:e.instanceId,extra:e.extra}),e}.bind(this))):Promise.resolve(e)},n.prototype._patchAlert=function(e,t){var r,o,i=this;return e.version||(e.version=1),(r=e.version)<n.version_10_tv_6611_1a_refactoring&&(e.condition.mainSeries=this._patchBand_to10(e.condition.mainSeries,t.symbol),
e.condition.options.band&&(e.condition.options.band=this._patchBand_to10(e.condition.options.band,t.symbol)),e.condition.options.upperBand&&(e.condition.options.upperBand=this._patchBand_to10(e.condition.options.upperBand,t.symbol)),e.condition.options.lowerBand&&(e.condition.options.lowerBand=this._patchBand_to10(e.condition.options.lowerBand,t.symbol)),e.version=n.version_10_tv_6611_1a_refactoring),r<n.version_11_tv_6611_1b_refactoring&&(e=this._patchExtra_to11(e)),r<n.version_12_tv_6888_fix_plot_index&&(e=this._patchExtra_to12(e)),r<n.version_13_tv_4164_source_code_protection&&(e=this._patchExtra_to13(e,t)),r<n.version_14_tv_4164_source_code_protection_fix&&(e=this._patchExtra_to14(e,t)),r<n.version_15_tv_8068_fix_main_series_resolution&&(e=this._patchExtra_to15(e,t)),t.extra=JSON.stringify(e),o=Promise.resolve(t),r<n.version_16_jv_298_remove_callstudy&&(o=o.then(function(e){return i._patchAlert_to16(e)})),r<n.version_17_jv_646_fix_mixed_inputs&&(o=o.then(function(e){var t=JSON.parse(e.extra),r=i._patchExtra_to17(t);return e.extra=JSON.stringify(r),e})),r<n.version_18_tv_10636_price_format&&(o=o.then(function(e){var t=JSON.parse(e.extra),r=i._patchExtra_to18(t);return e.extra=JSON.stringify(r),e})),r<n.version_19_tv_11267_fix_frequency_options&&(o=o.then(function(e){return i._patchAlert_to19(e)})),r<n.version_20_tv_14463_extract_dividends_adjustment_from_symbol_string&&(o=o.then(function(e){var t=JSON.parse(e.extra),r=i._patchExtra_to20(t);return e.extra=JSON.stringify(r),e})),r<n.version_21_tv_14886_add_alert_dangerous_source_check&&(o=o.then(function(e){var t=JSON.parse(e.extra),r=i._patchExtra_to21(t);return e.extra=JSON.stringify(r),e})),o},n.prototype.cancelPossibleExtraUpdate=function(e){this._extraUpdateScheduler.cancelUpdate(e)},n.prototype._patchBand_to10=function(e,t){return e=this._patchBand_to10_callStudyArgs(e),e=this._patchBand_to10_stateForAlert(e,t)},n.prototype._patchBand_to10_callStudyArgs=function(e){var t=e&&"Study"===e.type,r=t&&(e.alertsData||{}).callStudyArgs,n=t&&e.metaInfo&&e.state&&e.state.inputs;return t&&!r&&n?(e.alertsData||(e.alertsData={}),e.alertsData.callStudyArgs=c(e.state.inputs,e.metaInfo),e):e},n.prototype._patchBand_to10_stateForAlert=function(e,t){var r,n,o;return e?(n=!e.state,"MainSeries"!==(r=e.type)||n?"Study"!==r&&!/^study_\w+/.test(r)||n?e:(o=e.metaInfo.plots.map(function(t){var r={id:t.id,type:t.type,offset:e.data.completePlotOffsets[t.id]};return e.metaInfo.styles&&void 0!==e.metaInfo.styles[t.id]&&(r.title=e.metaInfo.styles[t.id].title||""),t.target&&e.metaInfo.ohlcPlots&&e.metaInfo.ohlcPlots[t.target]&&(r.ohlcTitle=e.metaInfo.ohlcPlots[t.target].title),r}),{id:e.id,uniqueId:e.uniqueId,type:e.type,title:"",shortDescription:e.state.shortDescription||"Study",fullId:e.metaInfo.fullId,isTVScript:!!e.metaInfo.isTVScript,plots:o,inputs:e.state.inputs,alerts:e.metaInfo.alerts,callStudyArgs:e.alertsData.callStudyArgs,plotIndex:e.plotIndex,plotOffset:e.plotOffset}):{id:e.id,uniqueId:e.uniqueId,type:e.type,proSymbol:e.state.symbol||t,actualSymbol:t,interval:e.state.interval,
style:e.state.style,styleInputs:function(){var t,r={0:"bar",1:"candle",2:"line",3:"area",4:"renko",5:"kagi",6:"pnf",7:"pb",8:"ha",9:"hollowCandle"},n=r[e.state.style];if(n&&(t=e.state[n+"Style"]))return t.inputs}(),extendedHours:e.state.extendedHours,boxSize:e.boxSize,reversalAmount:e.reversalAmount}):e},n.prototype._patchExtra_to11=function(e){var t=function(e,t,r){r.id=r.id||u.randomHashN(6),e.condition[t]={id:r.id,plotIndex:r.plotIndex},e.statesForAlert[r.id]=r},r={version:n.version_11_tv_6611_1b_refactoring,condition:{id:e.condition.id,fireInfo:{frequency:e.frequency||"once"},movPeriod:e.condition.options.period,movValue:e.condition.options.value},statesForAlert:{}};return t(r,"alertSeries",e.condition.mainSeries),["band","upperBand","lowerBand"].filter(function(t){return!!e.condition.options[t]}).forEach(function(n){t(r,n,e.condition.options[n])}),r},n.prototype._patchExtra_to12=function(e){return["alertSeries","band","upperBand","lowerBand"].filter(function(t){return!!e.condition[t]&&void 0!==e.condition[t].plotIndex}).map(function(t){var r=e.condition[t];return{state:e.statesForAlert[r.id],plotIndex:r.plotIndex}}).filter(function(e){return!!e.state.plots}).forEach(function(e){var t=e.state.plots[e.plotIndex];null==t||"object"!=typeof t&&"function"!=typeof t||void 0===t.pinePlotIndex&&(t.pinePlotIndex=e.plotIndex)}),e.version=n.version_12_tv_6888_fix_plot_index,e},n.prototype._patchExtra_to13=function(e,t){var r,o,s,a=e;for(o in e.condition.mainSeries||("MainSeries"===e.statesForAlert[e.condition.alertSeries.id].type?a.condition.mainSeries=a.condition.alertSeries:(r=u.randomHashN(6),a.condition.mainSeries={id:r},a.statesForAlert[r]={id:r}),a.statesForAlert[a.condition.mainSeries.id].symbolString=t.symbol),e.statesForAlert)(s=e.statesForAlert[o]).fullId&&(s.scriptIdPart=i.parseIdString(s.fullId).shortId.split("$")[1]);return a.version=n.version_13_tv_4164_source_code_protection,a},n.prototype._patchExtra_to14=function(e,t){var r=e;return e.condition.mainSeries||("MainSeries"===e.statesForAlert[e.condition.alertSeries.id].type?r.condition.mainSeries=r.condition.alertSeries:(r.condition.mainSeries={id:u.randomHashN(6)},r.statesForAlert[r.condition.mainSeries.id]={})),null==r.statesForAlert[r.condition.mainSeries.id].symbolString&&(r.statesForAlert[r.condition.mainSeries.id].symbolString=t.symbol),r.version=n.version_14_tv_4164_source_code_protection_fix,r},n.prototype._patchExtra_to15=function(e,t){var r=e;return null==r.statesForAlert[r.condition.mainSeries.id].interval&&(r.statesForAlert[r.condition.mainSeries.id].interval=t.resolution),r.version=n.version_15_tv_8068_fix_main_series_resolution,r},n.prototype._patchAlert_to16=function(e){function t(e){return e.replace(/tv-scripting-1\!?$/,"tv-scripting-88")}function r(r){return(o=r,s=i.cutDollarHash(o.fullId),l=n._recoverFullInputs(o.fullId,o.pineId,o.pineVersion,o.inputs).then(function(e){return{id:p.idForAlert(a(o.fullId),e),study:t(s),inputs:e}}),c=new Promise(function(e,r){var i=JSON.parse(o.callStudyDependencies||"[]"),s=i.map(function(e){
return n._recoverFullInputs(null,e.scriptIdPart,e.scriptVersion,e.inputs).then(function(r){return{id:e.id,study:t(e.study),inputs:r}})});Promise.all(s).then(function(t){e(t)},r)}),l.then(function(e){return c.then(function(t){return[e].concat(t)})})).then(function(t){r.studyDependencies=t;var n=t[0];r.id=n.id,r.uniqueId=r.id,e.scriptDeps=e.scriptDeps.concat(t)});var o,s,l,c}var o,s,l,c,u=JSON.parse(e.extra);for(s in e.scriptDeps=[],o=[],u.statesForAlert)u.statesForAlert.hasOwnProperty(s)&&("MainSeries"===(l=u.statesForAlert[s]).type?(l.id=_(l.symbolString+l.interval).toString(),l.uniqueId=l.id):/^LineTool.*/i.test(l.type)?l.id=l.uniqueId:("Study"===l.type||/^study_\w+/.test(l.type))&&(c=r(l),o.push(c)));return Promise.all(o).then(function(){return function(e){var t={},r={};Object.keys(e.statesForAlert).forEach(function(n){var o=e.statesForAlert[n].id;t[n]=o,r[o]=e.statesForAlert[n]}),Object.keys(e.condition).filter(function(r){return null!=e.condition[r].id&&null!=t[e.condition[r].id]}).forEach(function(r){e.condition[r].id=t[e.condition[r].id]}),e.statesForAlert=r}(u),u.version=n.version_16_jv_298_remove_callstudy,e.extra=JSON.stringify(u),e})},n.prototype.patchAlert_to16_forTestsOnly=n.prototype._patchAlert_to16,n.prototype._patchExtra_to17=function(e){var t,r,o,i,a;for(t in e.statesForAlert)if(e.statesForAlert.hasOwnProperty(t)&&(null!=(o=(r=e.statesForAlert[t]).inputs)&&(r.inputs=s.splitInputs(o).obj),null!=r.studyDependencies))for(i=0;i<r.studyDependencies.length;i++)(a=r.studyDependencies[i]).inputs=s.splitInputs(a.inputs).obj;return e.version=n.version_17_jv_646_fix_mixed_inputs,e},n.prototype.patchExtra_to17_forTestsOnly=n.prototype._patchExtra_to17,n._recoverFullInputs=function(e,t,r,n){if(t=t||e&&l(e)||n.pineId,r=r||n.pineVersion||"-1",null==t)return Promise.resolve(n);var o=f.translateScriptAsync2(t,r);return new Promise(function(e,t){o.then(e,t)}).catch(function(e){if("-1"===r&&t.startsWith("USER")){var o=function(e){var t={};return Object.keys(e).forEach(function(r){var n,o=e[r];r.startsWith("in_")?(n=["open","high","low","close","hl2","hlc3","ohlc4"].indexOf(o)>0||/.*\$\d+/.test(o)?"source":"string"==typeof o?"string":"boolean"==typeof o?"bool":"float",t[r]={f:!0,v:o,t:n}):t[r]=o}),t}(n);return d.logNormal("A very rare case: alert on legacy script that was never resaved. Trying to guess input types \n\t"+JSON.stringify(n)+" -> "+JSON.stringify(o)),o}return d.logError("Alert migration failed, inputs cannot be migrated: "+JSON.stringify(e)),Promise.reject(e)}).then(function(e){return TVScript.patchInputs(e.inputs,n)})},n.prototype._patchExtra_to18=function(e){var t,r,o,i,s,a,l,c={},u=h.getData(e.condition.id);return u&&"comparison"===u.type&&(u.isChannel?(r=e.statesForAlert[e.condition.upperBand.id],o=e.statesForAlert[e.condition.lowerBand.id],"Value"===r.type?t=r.value:"Value"===o.type&&(t=o.value)):"Value"===(i=e.statesForAlert[e.condition.band.id]).type&&(t=i.value)),t&&-1!==(t=t.toString().replace(/^-/,"")).indexOf(".")&&(s=t.replace(/^\d+\./,"").length,a=Math.pow(10,s),c.priceScale=a),
l=e.condition.alertSeries.id,e.statesForAlert[l].formatter={type:"price",state:c},e.version=n.version_18_tv_10636_price_format,e},n.prototype._patchAlert_to19=function(e){function t(e){return-1!==d.indexOf(e)}var r=JSON.parse(e.extra),o=e.autoDeactivation,i=r.condition.fireInfo.frequency,s=r.statesForAlert[r.condition.mainSeries.id],a=["band","lowerBand","upperBand"].map(function(e){var t=r.condition[e];return t&&r.statesForAlert[t.id]}).filter(function(e){return!!e}),l=a.filter(function(e){return"LineToolVertLine"===e.type}).length>0,c=v.hasProjection(s.style),u=e.crossInterval,d=[];return l?d.push("once"):(u||c||(d.push("once"),d.push("60"),d.push("on_bar_close")),c?d.push("on_bar_close"):d.push("on_first_fire")),"once_per_bar"===i&&(i="on_first_fire"),"once"!==i||t("once")||(o=!0,i=d[0]),"once"!==i&&o&&(i=d[0]),"once"!==i&&l&&(o=!0,i="once"),"on_bar_close"===i&&!t("on_bar_close")&&t("on_first_fire")&&(i="on_first_fire"),e.autoDeactivation=o,r.condition.fireInfo.frequency=i,r.version=n.version_19_tv_11267_fix_frequency_options,e.extra=JSON.stringify(r),e},n.prototype._patchExtra_to20=function(e){var t,r,o=e.condition.mainSeries,i=e.statesForAlert,s=o&&i&&i[o.id];return s&&(t=s.symbolString)&&0===t.indexOf("=")&&(r=t.slice(1),"dividends"===(r=JSON.parse(r)).adjustment?s.dividendsAdjustment=!0:"splits"===r.adjustment&&(s.dividendsAdjustment=!1)),e.version=n.version_20_tv_14463_extract_dividends_adjustment_from_symbol_string,e},n.prototype.patchExtra_to20_forTestsOnly=n.prototype._patchExtra_to20,n.prototype._patchExtra_to21=function(e){var t,r,o=e.statesForAlert;for(t in o)o.hasOwnProperty(t)&&(r=o[t]).isSpread&&(r.dangerReason=m.Spread);return e.version=n.version_21_tv_14886_add_alert_dangerous_source_check,e},e.exports={AlertVersioning:n}},JZcM:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"AlertNotificationType",function(){return n}),function(e){e.Fired="fired",e.FireControl="fire_control"}(n||(n={}))},PlME:function(e,t,r){"use strict";function n(e){return e.alert?e.type||"edit_alert":"create_alert"}function o(e,t){return Object(u.isFeatureEnabled)("alerts-maintenance")?l.AlertEditorAbortReason.AlertsMaintenance:null!==e&&function(e){return e.status()===c.STATUS_OFFLINE}(e)?l.AlertEditorAbortReason.MainSeriesIsOffline:null!==e&&function(e){return e.status()===c.STATUS_INVALID_SYMBOL}(e)?l.AlertEditorAbortReason.SymbolIsInvalid:"create_alert"===t&&null!==e&&function(e){var t;return"ATR"===(null===(t=e.stateForAlert().styleInputs)||void 0===t?void 0:t.style)}(e)?l.AlertEditorAbortReason.MainSeriesIsATR:"create_alert"===t&&null!==e&&function(e){return e.isInReplay()}(e)?l.AlertEditorAbortReason.MainSeriesIsInReplay:null}function i(e,t){if(!d.has(e)){d.add(e);var r=function(e,t){var r=s.t("Oops!"),n=s.t("Alert editor could not be initialized");return new Map([[l.AlertEditorAbortReason.AlertsMaintenance,{title:s.t("Alerts maintenance"),content:s.t("We are doing some brief daily maintenance. Alerts will be back really soon, thanks for your patience!")}],[l.AlertEditorAbortReason.MainSeriesIsOffline,{title:r,
content:("create_alert"===t?s.t("Cannot create an alert while offline"):s.t("Cannot edit an alert while offline"))+". "+s.t("Please check your internet connection")+"."}],[l.AlertEditorAbortReason.SymbolIsInvalid,{title:r,content:"create_alert"===t?s.t("Can't create alert on invalid symbol"):s.t("Can't edit alert on invalid symbol")}],[l.AlertEditorAbortReason.MainSeriesIsATR,{title:s.t("Alert cannot be set on an ATR-based chart"),content:s.t("Your alert won't trigger the way you expect it to! Inputs for ATR-based charts are recalculated each time you open a chart and are generally dependent on time. Please use the traditional chart type to set an alert with a static box size.")}],[l.AlertEditorAbortReason.MainSeriesIsInReplay,{title:r,content:s.t("Alert creating is not available in replay mode.")}]]).get(e)||{title:r,content:n}}(e,t);Object(a.createNoticeDialog)(r).then(function(t){t.on("beforeClose",function(){return d.delete(e)}),t.open()})}}var s,a,l,c,u,d;r.r(t),r.d(t,"getAlertDialogType",function(){return n}),r.d(t,"shouldAbortAlertEditor",function(){return o}),r.d(t,"showAbortExplainingDialog",function(){return i}),s=r("YFKU"),a=r("brCa"),l=r("1UCy"),c=r("dfhE"),u=r("+GxX"),d=new Set},Zdjc:function(e,t,r){"use strict";function n(){return Object(i.createGoProDialog)({feature:"alertsTrueSms",goOnMarkets:!1,isTrialAvailable:!0,upgradeMessage:window.t("Upgrade now"),visitPaymentPage:{product_name:"pro_premium",billing_cycle:"y",options:{newWindow:!0}}})}function o(){n().then(function(e){e.open()})}var i;r.r(t),r.d(t,"createGoProAlertsTrueSmsDialog",function(){return n}),r.d(t,"showGoProAlertsTrueSmsDialog",function(){return o}),r("YFKU"),i=r("s4+V")},flg1:function(e,t,r){"use strict";function n(){Object(i.showAbortExplainingDialog)(o.AlertEditorAbortReason.AlertsMaintenance)}var o,i;r.r(t),r.d(t,"showAlertsMaintenanceDialog",function(){return n}),o=r("1UCy"),i=r("PlME")},gdgp:function(e,t,r){"use strict";function n(){Object(o.createGoProDialog)({feature:"alerts"}).then(function(e){e.open()})}r.r(t),r.d(t,"showGoProMaxAlertsDialog",function(){return n});var o=r("s4+V")},jA5l:function(e,t,r){"use strict";function n(){Object(o.createGoProDialog)({feature:"alertsWebhook"}).then(function(e){e.open()})}r.r(t),r.d(t,"showGoProAlertsWebhookDialog",function(){return n});var o=r("s4+V")},oNDq:function(e,t,r){"use strict";function n(e){return new Promise(function(t){Promise.all([r.e("vendors_embed"),r.e("dialogs-core"),r.e(0),r.e(1),r.e(3),r.e(5),r.e(7),r.e(8),r.e(6),r.e(160),r.e("create-dialog")]).then(function(n){var i=r("YDhE").createDialog;t(i(Object(o.__assign)(Object(o.__assign)({},a),e)))}.bind(null,r)).catch(void 0)})}var o,i,s,a;r.r(t),r.d(t,"createConfirmDialog",function(){return n}),o=r("mrSG"),r("YFKU"),i={key:13,name:"yes",text:window.t("Yes"),type:"success"},s={method:"close",name:"no",text:window.t("No"),type:"default"},a={actions:[i,s],actionsWrapTemplate:'<div class="tv-dialog__section tv-dialog__section--actions tv-dialog__section--no-border">',content:window.t("Are you sure?"),
contentWrapTemplate:'<div class="tv-dialog__section tv-dialog__section--no-border"><div class="tv-text"><p></p></div></div>',destroyOnClose:!0,title:window.t("Confirmation"),width:400,dataset:{"dialog-type":"confirm-dialog"}}},sg6D:function(e,t,r){"use strict";var n=r("/ELx"),o=n.extend({_prepareToSet_fireTime:function(e){return new Date(1e3*e)},_prepareToSet_barTime:function(e){return new Date(1e3*e)},_prepareToSet_alertId:function(e){return parseInt(e)},fireTimeReadable:function(){return this._formatDate(this.get("fireTime"))},fireTimeUnix:function(){return Math.round(this.get("fireTime").getTime()/1e3)}});e.exports=o},uXxt:function(e,t,r){"use strict";var n,o,i,s,a,l,c,u,d;r.r(t),r.d(t,"AlertExtraUpdateScheduler",function(){return d}),n=r("mrSG"),o=r("hWRP"),i=r("4BMm"),s=r("uOxu"),a=Object(s.getLogger)("Alerts.ExtraUpdateScheduler"),l=1e3,c=function(e){return setTimeout(e,l)},u=clearTimeout,d=function(){function e(){this._queue=new Map,this._taskHandle=null}return e.prototype.scheduleUpdate=function(e){this._queue.set(e.id,e),this._maybeScheduleTask()},e.prototype.cancelUpdate=function(e){this._queue.delete(e),null!==this._taskHandle&&0===this._queue.size&&(u(this._taskHandle),this._taskHandle=null)},e.prototype._maybeScheduleTask=function(){var e=this;null===this._taskHandle&&0!==this._queue.size&&(this._taskHandle=c(function(){return Object(n.__awaiter)(e,void 0,void 0,function(){var e;return Object(n.__generator)(this,function(t){switch(t.label){case 0:return(e=this._queue.values().next().value)?(this._queue.delete(e.id),[4,function(e){return a.logDebug("Sending extra update request for alert "+e.id),Object(o.sendRequest)({method:"update_extra",params:Object(i.client2serverParams)(e)}).then(function(){return a.logDebug("Extra has been updated successfully for alert "+e.id)},function(t){return a.logWarn("Could not update extra for alert "+e.id+": "+t)})}(e)]):[3,2];case 1:t.sent(),t.label=2;case 2:return this._taskHandle=null,this._maybeScheduleTask(),[2]}})})}))},e}()},zL88:function(e,t,r){"use strict";function n(){Promise.all([r.e(4),r.e(9),r.e(27),r.e(32),r.e(37),r.e(129),r.e(106),r.e("show-warning-alerts-max-total-count-exceeded")]).then(r.bind(null,"MR9f")).then(function(e){return e.showWarningAlertsMaxTotalCountExceededImpl()})}r.r(t),r.d(t,"showWarningAlertsMaxTotalCountExceeded",function(){return n})}}]);